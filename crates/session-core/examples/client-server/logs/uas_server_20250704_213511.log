    Finished `release` profile [optimized] target(s) in 0.13s
     Running `/Users/jonathan/Documents/Work/Rudeless_Ventures/rvoip/target/release/uas_server --port 5062 --log-level info --auto-shutdown 60`
[2m2025-07-05T04:36:00.113986Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m Starting UAS Server on port 5062
[2m2025-07-05T04:36:00.114257Z[0m [32m INFO[0m [2mrvoip_dialog_core::api::unified[0m[2m:[0m Creating UnifiedDialogApi with automatic transport setup in "Hybrid" mode
[2m2025-07-05T04:36:00.114803Z[0m [32m INFO[0m [2mrvoip_sip_transport::transport::udp[0m[2m:[0m SIP UDP transport bound to 0.0.0.0:5062
[2m2025-07-05T04:36:00.114977Z[0m [32m INFO[0m [2mrvoip_transaction_core::transport[0m[2m:[0m Added UDP transport bound to 0.0.0.0:5062
[2m2025-07-05T04:36:00.115137Z[0m [32m INFO[0m [2mrvoip_dialog_core::api::unified[0m[2m:[0m Creating UnifiedDialogApi with global events in "Hybrid" mode
[2m2025-07-05T04:36:00.115182Z[0m [32m INFO[0m [2mrvoip_dialog_core::manager::unified[0m[2m:[0m Creating UnifiedDialogManager with global events in "Hybrid" mode at 0.0.0.0:5062
[2m2025-07-05T04:36:00.115206Z[0m [32m INFO[0m [2mrvoip_dialog_core::manager::core[0m[2m:[0m Creating new DialogManager with global transaction events and local address 0.0.0.0:5062
[2m2025-07-05T04:36:00.115391Z[0m [32m INFO[0m [2mrvoip_dialog_core::manager::core[0m[2m:[0m 🔄 Starting global transaction event processor for dialog-core
[2m2025-07-05T04:36:00.115651Z[0m [32m INFO[0m [2mrvoip_session_core::manager::events[0m[2m:[0m Session event processor started
🔗 SETUP: Setting up session coordination with dialog-core
✅ SETUP: Session coordination setup complete
[2m2025-07-05T04:36:00.115761Z[0m [32m INFO[0m [2mrvoip_session_core::coordinator::coordinator[0m[2m:[0m SessionCoordinator initialized on port 5062
[2m2025-07-05T04:36:00.115799Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m UAS Server ready and listening on port 5062
[2m2025-07-05T04:36:00.115822Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m 📊 RTP/RTCP statistics monitoring is enabled (updates every 3 seconds during calls)
[2m2025-07-05T04:36:00.115833Z[0m [32m INFO[0m [2mrvoip_session_core::coordinator::event_handler[0m[2m:[0m Starting main coordinator event loop
🎬 SPAWN: Starting session coordination event loop
📡 EVENT LOOP: Session coordination event loop started
[2m2025-07-05T04:36:03.761644Z[0m [32m INFO[0m [2mrvoip_transaction_core::manager[0m[2m:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-505b0fb500314deea3c76e726f46f325:INVITE:server) [3mmethod[0m[2m=[0mINVITE
Transaction loop starting for Key(z9hG4bK-505b0fb500314deea3c76e726f46f325:INVITE:server)
Initial state: Proceeding
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-505b0fb500314deea3c76e726f46f325:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
[2m2025-07-05T04:36:03.762288Z[0m [32m INFO[0m [2mrvoip_dialog_core::manager::dialog_operations[0m[2m:[0m Created early dialog c890628b-f99f-4e80-99a1-13fe9fcc5c4b from INVITE request
🔍 INVITE HANDLER: Created early dialog c890628b-f99f-4e80-99a1-13fe9fcc5c4b
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-505b0fb500314deea3c76e726f46f325:INVITE:server) with dialog c890628b-f99f-4e80-99a1-13fe9fcc5c4b
Already in requested state, no transition needed: Proceeding
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog c890628b-f99f-4e80-99a1-13fe9fcc5c4b
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog c890628b-f99f-4e80-99a1-13fe9fcc5c4b
[2m2025-07-05T04:36:03.762588Z[0m [32m INFO[0m [2mrvoip_dialog_core::protocol::invite_handler[0m[2m:[0m Initial INVITE processed, created dialog c890628b-f99f-4e80-99a1-13fe9fcc5c4b
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(c890628b-f99f-4e80-99a1-13fe9fcc5c4b), transaction_id: z9hG4bK-505b0fb500314deea3c76e726f46f325:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("uas"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [From(From(Address { display_name: Some("User"), uri: Uri { scheme: Sip, user: Some("uac"), password: None, host: Address(127.0.0.1), port: None, parameters: [], headers: {}, raw_uri: None }, params: [Tag("56c30068")] })), To(To(Address { display_name: Some("User"), uri: Uri { scheme: Sip, user: Some("uas"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("call-b55ad814-8e71-43fe-b66d-741b62bfdd1d")), CSeq(CSeq { seq: 1, method: Invite }), MaxForwards(MaxForwards(70)), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(229)), Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(0.0.0.0), sent_by_port: Some(5061), params: [Branch("z9hG4bK-505b0fb500314deea3c76e726f46f325")] }]))], body: b"v=0\r\no=rvoip 1751690163 1751690163 IN IP4 0.0.0.0\r\ns=RVOIP Session\r\nc=IN IP4 0.0.0.0\r\nt=0 0\r\nm=audio 26212 RTP/AVP 0 8 9 96\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=rtpmap:9 G722/8000\r\na=rtpmap:96 opus/48000/2\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-07-05T04:36:03.762818Z[0m [32m INFO[0m [2mrvoip_session_core::dialog::coordinator[0m[2m:[0m handle_incoming_call called for dialog c890628b-f99f-4e80-99a1-13fe9fcc5c4b
[2m2025-07-05T04:36:03.762855Z[0m [32m INFO[0m [2mrvoip_session_core::dialog::coordinator[0m[2m:[0m Incoming call from dialog c890628b-f99f-4e80-99a1-13fe9fcc5c4b: sip:uac@127.0.0.1 -> sip:uas@127.0.0.1:5062
[2m2025-07-05T04:36:03.762886Z[0m [32m INFO[0m [2mrvoip_session_core::dialog::coordinator[0m[2m:[0m Created session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba for incoming call dialog c890628b-f99f-4e80-99a1-13fe9fcc5c4b
[2m2025-07-05T04:36:03.762910Z[0m [32m INFO[0m [2mrvoip_session_core::dialog::coordinator[0m[2m:[0m Calling handler.on_incoming_call for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba
[2m2025-07-05T04:36:03.762939Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m Incoming call from sip:uac@127.0.0.1 to sip:uas@127.0.0.1:5062
[2m2025-07-05T04:36:03.762956Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m Incoming call has SDP offer, preparing answer...
[2m2025-07-05T04:36:03.763002Z[0m [32m INFO[0m [2mrvoip_media_core::relay::controller[0m[2m:[0m Starting media session for dialog: media-sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba
[2m2025-07-05T04:36:03.763065Z[0m [32m INFO[0m [2mrvoip_rtp_core::transport::allocator[0m[2m:[0m Created global port allocator with range 16384-32767
🎯 COORDINATOR: Handling event: SessionCreated { session_id: SessionId("sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba"), from: "sip:uac@127.0.0.1", to: "sip:uas@127.0.0.1:5062", call_state: Initiating }
[2m2025-07-05T04:36:03.763559Z[0m [32m INFO[0m [2mrvoip_session_core::coordinator::event_handler[0m[2m:[0m Session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba created with state Initiating
Received command: Timer("100") for transaction Key(z9hG4bK-505b0fb500314deea3c76e726f46f325:INVITE:server)
[2m2025-07-05T04:36:03.963375Z[0m [32m INFO[0m [2mrvoip_sip_transport::transport::udp[0m[2m:[0m Sending response message to 127.0.0.1:5061
[2m2025-07-05T04:36:04.265170Z[0m [32m INFO[0m [2mrvoip_rtp_core::transport::udp[0m[2m:[0m Started UDP transport receiver tasks
[2m2025-07-05T04:36:04.265358Z[0m [32m INFO[0m [2mrvoip_rtp_core::session[0m[2m:[0m Started RTP session with SSRC=3287bfa9
[2m2025-07-05T04:36:04.265472Z[0m [32m INFO[0m [2mrvoip_media_core::relay::controller[0m[2m:[0m ✅ Created media session with REAL RTP session: media-sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba (port: 27902)
[2m2025-07-05T04:36:04.265568Z[0m [32m INFO[0m [2mrvoip_session_core::media::manager[0m[2m:[0m ✅ Created media session: media-sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba for SIP session: sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba with real MediaSessionController + zero-copy enabled
[2m2025-07-05T04:36:04.265651Z[0m [32m INFO[0m [2mrvoip_session_core::media::manager[0m[2m:[0m ✅ Generated SDP offer for session: sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba with port: 27902 and codecs: ["PCMU", "PCMA"]
[2m2025-07-05T04:36:04.265699Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m Generated SDP answer with dynamic port allocation
[2m2025-07-05T04:36:04.265774Z[0m [32m INFO[0m [2mrvoip_media_core::relay::controller[0m[2m:[0m ✅ Updated RTP session remote address for dialog media-sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba: 0.0.0.0:26212
[2m2025-07-05T04:36:04.265811Z[0m [32m INFO[0m [2mrvoip_session_core::media::manager[0m[2m:[0m ✅ Updated media session for SIP session: sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba with remote: 0.0.0.0:26212 and codecs: ["PCMU"]
[2m2025-07-05T04:36:04.265843Z[0m [32m INFO[0m [2mrvoip_session_core::dialog::coordinator[0m[2m:[0m Handler decision for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba: Accept(Some("v=0\r\no=rvoip 1751690164 1751690164 IN IP4 0.0.0.0\r\ns=RVOIP Session\r\nc=IN IP4 0.0.0.0\r\nt=0 0\r\nm=audio 27902 RTP/AVP 0 8 9 96\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=rtpmap:9 G722/8000\r\na=rtpmap:96 opus/48000/2\r\na=sendrecv\r\n"))
[2m2025-07-05T04:36:04.265914Z[0m [32m INFO[0m [2mrvoip_dialog_core::api::common[0m[2m:[0m Answering call c890628b-f99f-4e80-99a1-13fe9fcc5c4b
[2m2025-07-05T04:36:04.266132Z[0m [32m INFO[0m [2mrvoip_sip_transport::transport::udp[0m[2m:[0m Sending response message to 127.0.0.1:5061
[2m2025-07-05T04:36:04.266366Z[0m [32m INFO[0m [2mrvoip_dialog_core::api::common[0m[2m:[0m Dialog c890628b-f99f-4e80-99a1-13fe9fcc5c4b local tag set to match response: tag-d5fcbf4677a54fd18d2c7f87de81f7d0
[2m2025-07-05T04:36:04.266417Z[0m [32m INFO[0m [2mrvoip_dialog_core::api::common[0m[2m:[0m Dialog c890628b-f99f-4e80-99a1-13fe9fcc5c4b transitioned to Confirmed state
[2m2025-07-05T04:36:04.266452Z[0m [32m INFO[0m [2mrvoip_dialog_core::api::common[0m[2m:[0m Updated dialog lookup for confirmed dialog c890628b-f99f-4e80-99a1-13fe9fcc5c4b
[2m2025-07-05T04:36:04.266485Z[0m [32m INFO[0m [2mrvoip_dialog_core::api::common[0m[2m:[0m Successfully answered call c890628b-f99f-4e80-99a1-13fe9fcc5c4b
[2m2025-07-05T04:36:04.266518Z[0m [32m INFO[0m [2mrvoip_session_core::dialog::coordinator[0m[2m:[0m Answered incoming call for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba with SDP: true
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(c890628b-f99f-4e80-99a1-13fe9fcc5c4b), session_answer: "v=0\r\no=rvoip 1751690164 1751690164 IN IP4 0.0.0.0\r\ns=RVOIP Session\r\nc=IN IP4 0.0.0.0\r\nt=0 0\r\nm=audio 27902 RTP/AVP 0 8 9 96\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=rtpmap:9 G722/8000\r\na=rtpmap:96 opus/48000/2\r\na=sendrecv\r\n" }
[2m2025-07-05T04:36:04.266606Z[0m [32m INFO[0m [2mrvoip_session_core::dialog::coordinator[0m[2m:[0m Call answered for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba: c890628b-f99f-4e80-99a1-13fe9fcc5c4b (awaiting ACK per RFC 3261)
[2m2025-07-05T04:36:04.266644Z[0m [32m INFO[0m [2mrvoip_session_core::dialog::coordinator[0m[2m:[0m 📞 Call answered for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba - keeping in Initiating state until media ready
[2m2025-07-05T04:36:04.266666Z[0m [32m INFO[0m [2mrvoip_session_core::dialog::coordinator[0m[2m:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
🎯 COORDINATOR: Handling event: SdpEvent { session_id: SessionId("sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba"), event_type: "remote_sdp_answer", sdp: "v=0\r\no=rvoip 1751690164 1751690164 IN IP4 0.0.0.0\r\ns=RVOIP Session\r\nc=IN IP4 0.0.0.0\r\nt=0 0\r\nm=audio 27902 RTP/AVP 0 8 9 96\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=rtpmap:9 G722/8000\r\na=rtpmap:96 opus/48000/2\r\na=sendrecv\r\n" }
Received command: CancelTimer100 for transaction Key(z9hG4bK-505b0fb500314deea3c76e726f46f325:INVITE:server)
[2m2025-07-05T04:36:04.266794Z[0m [32m INFO[0m [2mrvoip_session_core::coordinator::event_handler[0m[2m:[0m Negotiating SDP as UAC for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba
[2m2025-07-05T04:36:04.266846Z[0m [32m INFO[0m [2mrvoip_session_core::sdp::negotiator[0m[2m:[0m Negotiating SDP as UAC for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba
[2m2025-07-05T04:36:04.266885Z[0m [32m INFO[0m [2mrvoip_session_core::sdp::negotiator[0m[2m:[0m Applying negotiated config: codec=PCMU, remote=0.0.0.0:27902
[2m2025-07-05T04:36:04.266914Z[0m [32m INFO[0m [2mrvoip_media_core::relay::controller[0m[2m:[0m ✅ Updated RTP session remote address for dialog media-sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba: 0.0.0.0:27902
[2m2025-07-05T04:36:04.266946Z[0m [32m INFO[0m [2mrvoip_session_core::coordinator::event_handler[0m[2m:[0m SDP negotiation successful: codec=PCMU, local=0.0.0.0:27902, remote=0.0.0.0:27902
[2m2025-07-05T04:36:04.266989Z[0m [32m INFO[0m [2mrvoip_session_core::media::manager[0m[2m:[0m ✅ Updated media session for SIP session: sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba with remote: 0.0.0.0:27902 and codecs: ["PCMU"]
[2m2025-07-05T04:36:04.267013Z[0m [32m INFO[0m [2mrvoip_session_core::coordinator::event_handler[0m[2m:[0m Updated media session with remote SDP for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba
🎯 COORDINATOR: Handling event: MediaNegotiated { session_id: SessionId("sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba"), local_addr: 0.0.0.0:27902, remote_addr: 0.0.0.0:27902, codec: "PCMU" }
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-505b0fb500314deea3c76e726f46f325:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-505b0fb500314deea3c76e726f46f325:INVITE:server). Final state: Terminated
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 100, 53, 102, 99, 98, 102, 52, 54, 55, 55, 97, 53, 52, 102, 100, 49, 56, 100, 50, 99, 55, 102, 56, 55, 100, 101, 56, 49, 102, 55, 100, 48]
Successfully parsed tag: tag-d5fcbf4677a54fd18d2c7f87de81f7d0
[2m2025-07-05T04:36:04.269583Z[0m [32m INFO[0m [2mrvoip_dialog_core::manager::transaction_integration[0m[2m:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-505b0fb500314deea3c76e726f46f325:INVITE:server) in dialog c890628b-f99f-4e80-99a1-13fe9fcc5c4b - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(c890628b-f99f-4e80-99a1-13fe9fcc5c4b), transaction_id: z9hG4bK-505b0fb500314deea3c76e726f46f325:INVITE:server, negotiated_sdp: None }
[2m2025-07-05T04:36:04.269687Z[0m [32m INFO[0m [2mrvoip_session_core::dialog::coordinator[0m[2m:[0m ✅ RFC 3261: ACK RECEIVED for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba - creating media session (UAS side)
🎯 COORDINATOR: Handling event: MediaEvent { session_id: SessionId("sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba"), event: "rfc_compliant_media_creation_uas" }
[2m2025-07-05T04:36:04.269729Z[0m [32m INFO[0m [2mrvoip_session_core::coordinator::event_handler[0m[2m:[0m Media creation event for sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba: rfc_compliant_media_creation_uas
🎯 COORDINATOR: Handling event: StateChanged { session_id: SessionId("sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba"), old_state: Initiating, new_state: Active }
[2m2025-07-05T04:36:04.269807Z[0m [32m INFO[0m [2mrvoip_session_core::coordinator::event_handler[0m[2m:[0m Session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba state changed: Initiating -> Active
[2m2025-07-05T04:36:04.269870Z[0m [32m INFO[0m [2mrvoip_session_core::coordinator::event_handler[0m[2m:[0m Media info available: true
[2m2025-07-05T04:36:04.269892Z[0m [32m INFO[0m [2mrvoip_session_core::coordinator::event_handler[0m[2m:[0m Local SDP length: Some(229)
[2m2025-07-05T04:36:04.269907Z[0m [32m INFO[0m [2mrvoip_session_core::coordinator::event_handler[0m[2m:[0m Remote SDP length: Some(229)
[2m2025-07-05T04:36:04.269919Z[0m [32m INFO[0m [2mrvoip_session_core::coordinator::event_handler[0m[2m:[0m Notifying handler about call sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba establishment
[2m2025-07-05T04:36:04.269963Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m Call sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba established
[2m2025-07-05T04:36:04.269985Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m Local SDP: Some(229)
[2m2025-07-05T04:36:04.269998Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m Remote SDP: Some(229)
[2m2025-07-05T04:36:04.270034Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m Have coordinator and remote SDP, parsing...
[2m2025-07-05T04:36:04.270053Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m Found IP in SDP: Some("0.0.0.0")
[2m2025-07-05T04:36:04.270069Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m Found port in SDP: Some(27902)
[2m2025-07-05T04:36:04.270084Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m Establishing media flow to 0.0.0.0:27902
[2m2025-07-05T04:36:04.270099Z[0m [32m INFO[0m [2mrvoip_media_core::relay::controller::rtp_management[0m[2m:[0m 🔗 Establishing media flow for dialog: media-sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba -> 0.0.0.0:27902
[2m2025-07-05T04:36:04.270115Z[0m [32m INFO[0m [2mrvoip_media_core::relay::controller::rtp_management[0m[2m:[0m ✅ Updated RTP remote address for dialog: media-sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba -> 0.0.0.0:27902
[2m2025-07-05T04:36:04.270130Z[0m [32m INFO[0m [2mrvoip_media_core::relay::controller::rtp_management[0m[2m:[0m 🎵 Starting audio transmission for dialog: media-sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba
[2m2025-07-05T04:36:04.270145Z[0m [32m INFO[0m [2mrvoip_media_core::relay::controller::audio_generation[0m[2m:[0m 🎵 Started audio transmission (440Hz tone, 20ms packets)
[2m2025-07-05T04:36:04.270161Z[0m [32m INFO[0m [2mrvoip_media_core::relay::controller::rtp_management[0m[2m:[0m ✅ Audio transmission started for dialog: media-sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba
[2m2025-07-05T04:36:04.270179Z[0m [32m INFO[0m [2mrvoip_media_core::relay::controller::rtp_management[0m[2m:[0m ✅ Media flow established for dialog: media-sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba
[2m2025-07-05T04:36:04.270192Z[0m [32m INFO[0m [2mrvoip_session_core::api::media[0m[2m:[0m Established media flow for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba to 0.0.0.0:27902
[2m2025-07-05T04:36:04.270208Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m ✅ Successfully established media flow for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba
[2m2025-07-05T04:36:04.270221Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m ✅ Audio transmission (440Hz sine wave) started automatically
[2m2025-07-05T04:36:04.270235Z[0m [32m INFO[0m [2mrvoip_media_core::relay::controller::statistics[0m[2m:[0m 📊 Starting statistics monitoring for dialog: media-sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba (interval: 2s)
[2m2025-07-05T04:36:04.270266Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m ✅ Started statistics monitoring for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba
[2m2025-07-05T04:36:04.272059Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m 📊 Statistics Update #1 for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba
[2m2025-07-05T04:36:04.272121Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   RTP - Sent: 0 pkts (0 bytes), Recv: 0 pkts (0 bytes)
[2m2025-07-05T04:36:04.272146Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   RTP - Lost: 0 pkts, Jitter: 0.0ms
[2m2025-07-05T04:36:04.272191Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   Quality - Loss: 0.0%, MOS: 4.5, Network: 100.0%
[2m2025-07-05T04:36:04.340118Z[0m [32m INFO[0m [2mrvoip_rtp_core::session[0m[2m:[0m New RTP stream detected with SSRC=191ddf89
[2m2025-07-05T04:36:04.366353Z[0m [32m INFO[0m [2mrvoip_rtp_core::session[0m[2m:[0m New RTP stream detected with SSRC=3287bfa9
[2m2025-07-05T04:36:07.271336Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m 📊 Statistics Update #2 for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba
[2m2025-07-05T04:36:07.271419Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   RTP - Sent: 150 pkts (25800 bytes), Recv: 128 pkts (22016 bytes)
[2m2025-07-05T04:36:07.271451Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   RTP - Lost: 95 pkts, Jitter: 0.0ms
[2m2025-07-05T04:36:07.271479Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   Quality - Loss: 42.6%, MOS: 2.0, Network: 57.4%
[2m2025-07-05T04:36:07.271510Z[0m [33m WARN[0m [2muas_server[0m[2m:[0m ⚠️ Quality degradation detected for call sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba: Loss: 42.6%, Jitter: 0.5ms
[2m2025-07-05T04:36:10.127701Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m Server stats - Calls received: 1, Active: 1, Accepted: 2, Rejected: 0
[2m2025-07-05T04:36:10.270966Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m 📊 Statistics Update #3 for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba
[2m2025-07-05T04:36:10.271059Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   RTP - Sent: 300 pkts (51600 bytes), Recv: 151 pkts (25972 bytes)
[2m2025-07-05T04:36:10.271098Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   RTP - Lost: 79 pkts, Jitter: 0.0ms
[2m2025-07-05T04:36:10.271125Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   Quality - Loss: 34.3%, MOS: 2.0, Network: 65.7%
[2m2025-07-05T04:36:10.271149Z[0m [33m WARN[0m [2muas_server[0m[2m:[0m ⚠️ Quality degradation detected for call sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba: Loss: 34.3%, Jitter: 0.5ms
[2m2025-07-05T04:36:13.271707Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m 📊 Statistics Update #4 for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba
[2m2025-07-05T04:36:13.271780Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   RTP - Sent: 450 pkts (77400 bytes), Recv: 151 pkts (25972 bytes)
[2m2025-07-05T04:36:13.271805Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   RTP - Lost: 79 pkts, Jitter: 0.0ms
[2m2025-07-05T04:36:13.271822Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   Quality - Loss: 34.3%, MOS: 2.0, Network: 65.7%
[2m2025-07-05T04:36:13.271842Z[0m [33m WARN[0m [2muas_server[0m[2m:[0m ⚠️ Quality degradation detected for call sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba: Loss: 34.3%, Jitter: 0.5ms
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 100, 53, 102, 99, 98, 102, 52, 54, 55, 55, 97, 53, 52, 102, 100, 49, 56, 100, 50, 99, 55, 102, 56, 55, 100, 101, 56, 49, 102, 55, 100, 48]
Successfully parsed tag: tag-d5fcbf4677a54fd18d2c7f87de81f7d0
[2m2025-07-05T04:36:13.877541Z[0m [32m INFO[0m [2mrvoip_transaction_core::manager[0m[2m:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-5325c80ab7834d1398de8b02b55842d7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-5325c80ab7834d1398de8b02b55842d7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-5325c80ab7834d1398de8b02b55842d7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("uas"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [From(From(Address { display_name: Some("User"), uri: Uri { scheme: Sip, user: Some("uac"), password: None, host: Address(127.0.0.1), port: None, parameters: [], headers: {}, raw_uri: None }, params: [Tag("56c30068")] })), To(To(Address { display_name: Some("User"), uri: Uri { scheme: Sip, user: Some("uas"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-d5fcbf4677a54fd18d2c7f87de81f7d0")] })), CallId(CallId("call-b55ad814-8e71-43fe-b66d-741b62bfdd1d")), CSeq(CSeq { seq: 2, method: Bye }), MaxForwards(MaxForwards(70)), ContentLength(ContentLength(0)), Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(0.0.0.0), sent_by_port: Some(5061), params: [Branch("z9hG4bK-5325c80ab7834d1398de8b02b55842d7")] }]))], body: b"" })) for transaction Key(z9hG4bK-5325c80ab7834d1398de8b02b55842d7:BYE:server)
[2m2025-07-05T04:36:13.877813Z[0m [32m INFO[0m [2mrvoip_sip_transport::transport::udp[0m[2m:[0m Sending response message to 127.0.0.1:5061
[2m2025-07-05T04:36:13.878258Z[0m [32m INFO[0m [2mrvoip_dialog_core::protocol::bye_handler[0m[2m:[0m BYE processed for dialog c890628b-f99f-4e80-99a1-13fe9fcc5c4b
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(c890628b-f99f-4e80-99a1-13fe9fcc5c4b), reason: "BYE received" }
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-5325c80ab7834d1398de8b02b55842d7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
Valid state transition: Trying -> Completed
State successfully changed to: Completed
Sent StateChanged event result: Success
[2m2025-07-05T04:36:13.878449Z[0m [32m INFO[0m [2mrvoip_session_core::dialog::coordinator[0m[2m:[0m handle_call_terminated called for dialog c890628b-f99f-4e80-99a1-13fe9fcc5c4b: BYE received
[2m2025-07-05T04:36:13.878604Z[0m [32m INFO[0m [2mrvoip_session_core::dialog::coordinator[0m[2m:[0m Call terminated for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba: c890628b-f99f-4e80-99a1-13fe9fcc5c4b - BYE received
🎯 COORDINATOR: Handling event: SessionTerminated { session_id: SessionId("sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba"), reason: "BYE received" }
🎯 COORDINATOR: Matched SessionTerminated event for sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba - BYE received
🔴 COORDINATOR: handle_session_terminated called for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba with reason: BYE received
[2m2025-07-05T04:36:13.878678Z[0m [32m INFO[0m [2mrvoip_session_core::coordinator::event_handler[0m[2m:[0m Session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba terminated: BYE received
[2m2025-07-05T04:36:13.878694Z[0m [33m WARN[0m [2mrvoip_session_core::media::coordinator[0m[2m:[0m No media session found for SIP session: sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba
🔔 COORDINATOR: Handler exists, checking for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba
✅ COORDINATOR: Found session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba, calling handler.on_call_ended
[2m2025-07-05T04:36:13.878741Z[0m [32m INFO[0m [2mrvoip_session_core::coordinator::event_handler[0m[2m:[0m Notifying handler about session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba termination
[2m2025-07-05T04:36:13.878756Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m Call sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba ended: BYE received
[2m2025-07-05T04:36:13.878806Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m 📊 Final call statistics for session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba:
[2m2025-07-05T04:36:13.878834Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   Total packets sent: 480
[2m2025-07-05T04:36:13.878846Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   Total packets received: 151
[2m2025-07-05T04:36:13.878857Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   Total bytes sent: 82560
[2m2025-07-05T04:36:13.878869Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   Total bytes received: 25972
[2m2025-07-05T04:36:13.878879Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   Packets lost: 79
[2m2025-07-05T04:36:13.878888Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   Final jitter: 0.0ms
[2m2025-07-05T04:36:13.878931Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   Final packet loss: 34.3%
[2m2025-07-05T04:36:13.878944Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   Final MOS score: 2.0
[2m2025-07-05T04:36:13.878956Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m   Final network effectiveness: 65.7%
[2m2025-07-05T04:36:13.878974Z[0m [32m INFO[0m [2muas_server[0m[2m:[0m ✅ Audio transmission was active during the call
🎯 COORDINATOR: Handling event: StateChanged { session_id: SessionId("sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba"), old_state: Active, new_state: Terminated }
[2m2025-07-05T04:36:13.879011Z[0m [32m INFO[0m [2mrvoip_session_core::coordinator::event_handler[0m[2m:[0m Session sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba state changed: Active -> Terminated
[2m2025-07-05T04:36:13.879029Z[0m [33m WARN[0m [2mrvoip_session_core::media::coordinator[0m[2m:[0m No media session found for SIP session: sess_da1cc73a-ba17-43de-a6cb-0ba0ec5a00ba
