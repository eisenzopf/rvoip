/* ITU G.722 3rd Edition (2012-09) */

/*-----------------------------------------------------------------------------------
 ITU-T G.722-SWBS / G.722 Annex D - Reference C code for fixed-point implementation          
 Version 1.0
 Copyright (c) 2012,
 Huawei Technologies
-----------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------
 ITU-T Annex B (ex G.722-SWB) Source Code
 Software Release 1.00 (2010-09)
 (C) 2010 France Telecom, Huawei Technologies, NTT, VoiceAge Corp.
--------------------------------------------------------------------------*/

#include "pcmswb_common.h"
#include "mathtool.h"

/* Table for square-root operation, SqrtI31() */
const Word16 table_sqrt_w[49] = 
{
  16384, 16888, 17378, 17854, 18318, 18770, 19212, 
  19644, 20066, 20480, 20886, 21283, 21674, 22058,
  22435, 22806, 23170, 23530, 23884, 24232, 24576,
  24915, 25249, 25580, 25905, 26227, 26545, 26859,
  27170, 27477, 27780, 28081, 28378, 28672, 28963,
  29251, 29537, 29819, 30099, 30377, 30652, 30924, 
  31194, 31462, 31727, 31991, 32252, 32511, 32767
};

const Word32 L_deposit_h_table_sqrt_w[49] =
{
  1073741824, 1106771968, 1138884608, 1170079744, 1200488448, 1230110720, 1259077632,
  1287389184, 1315045376, 1342177280, 1368784896, 1394802688, 1420427264, 1445593088,
  1470300160, 1494614016, 1518469120, 1542062080, 1565261824, 1588068352, 1610612736,
  1632829440, 1654718464, 1676410880, 1697710080, 1718812672, 1739653120, 1760231424,
  1780613120, 1800732672, 1820590080, 1840316416, 1859780608, 1879048192, 1898119168,
  1916993536, 1935736832, 1954217984, 1972568064, 1990787072, 2008809472, 2026635264,
  2044329984, 2061893632, 2079260672, 2096562176, 2113667072, 2130640896, 2147418112 
};
const Word16 sub_table_sqrt_w_i_i1[48] =
{
  -504, -490, -476, -464, -452, -442, -432, -422, -414, -406, -397, -391, 
  -384, -377, -371, -364, -360, -354, -348, -344, -339, -334, -331, -325,
  -322, -318, -314, -311, -307, -303, -301, -297, -294, -291, -288, -286,
  -282, -280, -278, -275, -272, -270, -268, -265, -264, -261, -259, -256
};

/* Table for inverse square-root operation, Isqrt_n() */
Word16 table_isqrt[49] =
{ /* Table is negated to correctly represent 1.0 i.e. -32768 first element */
  -32768, -31790, -30894, -30070, -29309, -28602, -27945,
  -27330, -26755, -26214, -25705, -25225, -24770, -24339,
  -23930, -23541, -23170, -22817, -22479, -22155, -21845,
  -21548, -21263, -20988, -20724, -20470, -20225, -19988,
  -19760, -19539, -19326, -19119, -18919, -18725, -18536,
  -18354, -18176, -18004, -17837, -17674, -17515, -17361,
  -17211, -17064, -16921, -16782, -16646, -16514, -16384
};

const Word32 L_mult_table_isqrt_m32768[49] =
{
  2147483647, 2083389440, 2024669184, 1970667520, 1920794624, 1874460672, 1831403520,
  1791098880, 1753415680, 1717960704, 1684602880, 1653145600, 1623326720, 1595080704,
  1568276480, 1542782976, 1518469120, 1495334912, 1473183744, 1451950080, 1431633920,
  1412169728, 1393491968, 1375469568, 1358168064, 1341521920, 1325465600, 1309933568,
  1294991360, 1280507904, 1266548736, 1252982784, 1239875584, 1227161600, 1214775296,
  1202847744, 1191182336, 1179910144, 1168965632, 1158283264, 1147863040, 1137770496,
  1127940096, 1118306304, 1108934656, 1099825152, 1090912256, 1082261504, 1073741824 
};
const Word16 table_isqrt_i_i1[48] =
{
  -978, -896, -824, -761, -707, -657, -615, -575, -541, -509, -480, -455,
  -431, -409, -389, -371, -353, -338, -324, -310, -297, -285, -275, -264,
  -254, -245, -237, -228, -221, -213, -207, -200, -194, -189, -182, -178,
  -172, -167, -163, -159, -154, -150, -147, -143, -139, -136, -132, -130
};
