//! Window function tables for G.729A

use crate::codecs::g729a::types::Q15;

/// ITU-T G.729A LP analysis window (wlp)
/// This is the exact table from bcg729 reference implementation
/// Note: This is NOT a Hamming window - it's asymmetric and peaks near position 199
static WLP_WINDOW: [Q15; 240] = [
    // Values from bcg729 src/codebooks.c - wlp[L_LP_ANALYSIS_WINDOW] in Q15
    Q15(2621), Q15(2623), Q15(2629), Q15(2638), Q15(2651), Q15(2668), Q15(2689), Q15(2713), Q15(2741), Q15(2772),
    Q15(2808), Q15(2847), Q15(2890), Q15(2936), Q15(2986), Q15(3040), Q15(3097), Q15(3158), Q15(3223), Q15(3291),
    Q15(3363), Q15(3438), Q15(3517), Q15(3599), Q15(3685), Q15(3774), Q15(3867), Q15(3963), Q15(4063), Q15(4166),
    Q15(4272), Q15(4382), Q15(4495), Q15(4611), Q15(4731), Q15(4853), Q15(4979), Q15(5108), Q15(5240), Q15(5376),
    Q15(5514), Q15(5655), Q15(5800), Q15(5947), Q15(6097), Q15(6250), Q15(6406), Q15(6565), Q15(6726), Q15(6890),
    Q15(7057), Q15(7227), Q15(7399), Q15(7573), Q15(7750), Q15(7930), Q15(8112), Q15(8296), Q15(8483), Q15(8672),
    Q15(8863), Q15(9057), Q15(9252), Q15(9450), Q15(9650), Q15(9852), Q15(10055), Q15(10261), Q15(10468), Q15(10677),
    Q15(10888), Q15(11101), Q15(11315), Q15(11531), Q15(11748), Q15(11967), Q15(12187), Q15(12409), Q15(12632), Q15(12856),
    Q15(13082), Q15(13308), Q15(13536), Q15(13764), Q15(13994), Q15(14225), Q15(14456), Q15(14688), Q15(14921), Q15(15155),
    Q15(15389), Q15(15624), Q15(15859), Q15(16095), Q15(16331), Q15(16568), Q15(16805), Q15(17042), Q15(17279), Q15(17516),
    Q15(17754), Q15(17991), Q15(18228), Q15(18465), Q15(18702), Q15(18939), Q15(19175), Q15(19411), Q15(19647), Q15(19882),
    Q15(20117), Q15(20350), Q15(20584), Q15(20816), Q15(21048), Q15(21279), Q15(21509), Q15(21738), Q15(21967), Q15(22194),
    Q15(22420), Q15(22644), Q15(22868), Q15(23090), Q15(23311), Q15(23531), Q15(23749), Q15(23965), Q15(24181), Q15(24394),
    Q15(24606), Q15(24816), Q15(25024), Q15(25231), Q15(25435), Q15(25638), Q15(25839), Q15(26037), Q15(26234), Q15(26428),
    Q15(26621), Q15(26811), Q15(26999), Q15(27184), Q15(27368), Q15(27548), Q15(27727), Q15(27903), Q15(28076), Q15(28247),
    Q15(28415), Q15(28581), Q15(28743), Q15(28903), Q15(29061), Q15(29215), Q15(29367), Q15(29515), Q15(29661), Q15(29804),
    Q15(29944), Q15(30081), Q15(30214), Q15(30345), Q15(30472), Q15(30597), Q15(30718), Q15(30836), Q15(30950), Q15(31062),
    Q15(31170), Q15(31274), Q15(31376), Q15(31474), Q15(31568), Q15(31659), Q15(31747), Q15(31831), Q15(31911), Q15(31988),
    Q15(32062), Q15(32132), Q15(32198), Q15(32261), Q15(32320), Q15(32376), Q15(32428), Q15(32476), Q15(32521), Q15(32561),
    Q15(32599), Q15(32632), Q15(32662), Q15(32688), Q15(32711), Q15(32729), Q15(32744), Q15(32755), Q15(32763), Q15(32767),
    Q15(32767), Q15(32741), Q15(32665), Q15(32537), Q15(32359), Q15(32129), Q15(31850), Q15(31521), Q15(31143), Q15(30716),
    Q15(30242), Q15(29720), Q15(29151), Q15(28538), Q15(27879), Q15(27177), Q15(26433), Q15(25647), Q15(24821), Q15(23957),
    Q15(23055), Q15(22117), Q15(21145), Q15(20139), Q15(19102), Q15(18036), Q15(16941), Q15(15820), Q15(14674), Q15(13505),
    Q15(12315), Q15(11106), Q15(9879), Q15(8637), Q15(7381), Q15(6114), Q15(4838), Q15(3554), Q15(2264), Q15(971),
];

/// ITU-T G.729A lag window (wlag)
/// Used for bandwidth expansion of autocorrelation coefficients
static WLAG_WINDOW: [Q15; 13] = [
    // Values from bcg729 src/codebooks.c - wlag[NB_LSP_COEFF+3] in Q15
    // Note: first coefficient (32767) is not used in practice
    Q15(32767), Q15(32728), Q15(32619), Q15(32438), Q15(32187), Q15(31867), Q15(31480), 
    Q15(31029), Q15(30517), Q15(29946), Q15(29321), Q15(28646), Q15(27923),
];

/// Get the ITU-T G.729A LP analysis window (wlp)
/// This replaces the previous Hamming window with the exact bcg729 reference
pub fn get_wlp_window() -> &'static [Q15; 240] {
    &WLP_WINDOW
}

/// Get the ITU-T G.729A lag window (wlag) 
/// Used for autocorrelation bandwidth expansion
pub fn get_wlag_window() -> &'static [Q15; 13] {
    &WLAG_WINDOW
}

// Backward compatibility aliases
pub fn get_hamming_window() -> Vec<Q15> {
    WLP_WINDOW.to_vec()
}

pub fn get_lag_window() -> Vec<Q15> {
    WLAG_WINDOW.to_vec()
} 