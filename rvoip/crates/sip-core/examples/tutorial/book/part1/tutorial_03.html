<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Creating SIP Messages with the Builder Pattern</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="creating-sip-messages-with-the-builder-pattern"><a class="header" href="#creating-sip-messages-with-the-builder-pattern">Creating SIP Messages with the Builder Pattern</a></h1>
<p>In this tutorial, we'll explore how to create SIP messages using the builder pattern provided by the <code>rvoip-sip-core</code> library. The builder pattern offers a fluent, easy-to-use interface for constructing complex SIP messages without having to worry about the underlying details of the protocol.</p>
<h2 id="introduction-to-the-builder-pattern"><a class="header" href="#introduction-to-the-builder-pattern">Introduction to the Builder Pattern</a></h2>
<p>The builder pattern is a design pattern that allows for the step-by-step construction of complex objects. It's particularly useful for creating objects with many optional parameters or when the construction process involves multiple steps.</p>
<p>In the context of SIP messages, the builder pattern helps us:</p>
<ol>
<li>Create well-formed SIP messages with minimal code</li>
<li>Ensure all required headers are present</li>
<li>Validate the message structure as we build it</li>
<li>Provide a fluent, chainable API for better readability</li>
</ol>
<h2 id="sip-message-builders-in-rvoip-sip-core"><a class="header" href="#sip-message-builders-in-rvoip-sip-core">SIP Message Builders in rvoip-sip-core</a></h2>
<p>The <code>rvoip-sip-core</code> library provides several builder classes for creating SIP messages:</p>
<ol>
<li><strong>SimpleRequestBuilder</strong>: For creating SIP request messages (INVITE, REGISTER, etc.)</li>
<li><strong>ResponseBuilder</strong>: For creating SIP response messages (200 OK, 180 Ringing, etc.)</li>
<li><strong>SdpBuilder</strong>: For creating SDP bodies for media negotiation</li>
</ol>
<p>Let's explore each of these builders with practical examples.</p>
<h2 id="creating-sip-requests"><a class="header" href="#creating-sip-requests">Creating SIP Requests</a></h2>
<h3 id="basic-request-structure"><a class="header" href="#basic-request-structure">Basic Request Structure</a></h3>
<p>A SIP request typically contains:</p>
<ul>
<li>A request line with method, URI, and SIP version</li>
<li>A set of headers (From, To, Call-ID, CSeq, Via, etc.)</li>
<li>An optional message body</li>
</ul>
<h3 id="using-simplerequestbuilder"><a class="header" href="#using-simplerequestbuilder">Using SimpleRequestBuilder</a></h3>
<p>The <code>SimpleRequestBuilder</code> provides a fluent interface for creating SIP requests:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use rvoip_sip_core::prelude::*;
use rvoip_sip_core::builder::SimpleRequestBuilder;

// Create a basic INVITE request
let invite_request = SimpleRequestBuilder::invite("sip:bob@example.com")?
    .from("Alice", "sip:alice@example.com", Some("1928301774"))
    .to("Bob", "sip:bob@example.com", None)
    .call_id("a84b4c76e66710@alice-pc.example.com")
    .cseq(314159)
    .via("alice-pc.example.com:5060", "UDP", Some("z9hG4bK776asdhds"))
    .max_forwards(70)
    .contact("sip:alice@alice-pc.example.com", None)
    .build();

println!("{}", invite_request);
<span class="boring">}</span></code></pre></pre>
<p>This produces a well-formed SIP INVITE request:</p>
<pre><code>INVITE sip:bob@example.com SIP/2.0
From: Alice &lt;sip:alice@example.com&gt;;tag=1928301774
To: Bob &lt;sip:bob@example.com&gt;
Call-ID: a84b4c76e66710@alice-pc.example.com
CSeq: 314159 INVITE
Via: SIP/2.0/UDP alice-pc.example.com:5060;branch=z9hG4bK776asdhds
Max-Forwards: 70
Contact: &lt;sip:alice@alice-pc.example.com&gt;
</code></pre>
<h3 id="method-specific-builders"><a class="header" href="#method-specific-builders">Method-Specific Builders</a></h3>
<p>The <code>SimpleRequestBuilder</code> provides convenience constructors for common SIP methods:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// REGISTER request
let register_request = SimpleRequestBuilder::register("sip:registrar.example.com")?
    .from("User", "sip:user@example.com", Some("a73kszlfl"))
    .to("User", "sip:user@example.com", None)
    .call_id("1j9FpLxk3uxtm8tn@user-pc.example.com")
    .cseq(1)
    .via("user-pc.example.com:5060", "UDP", Some("z9hG4bKnashds7"))
    .max_forwards(70)
    .contact("sip:user@user-pc.example.com", None)
    .expires_seconds(3600)
    .build();

// BYE request
let bye_request = SimpleRequestBuilder::bye("sip:bob@example.com")?
    .from("Alice", "sip:alice@example.com", Some("1928301774"))
    .to("Bob", "sip:bob@example.com", Some("8675309"))
    .call_id("a84b4c76e66710@alice-pc.example.com")
    .cseq(314160)
    .via("alice-pc.example.com:5060", "UDP", Some("z9hG4bKasd123"))
    .max_forwards(70)
    .build();

// OPTIONS request
let options_request = SimpleRequestBuilder::options("sip:bob@example.com")?
    .from("Alice", "sip:alice@example.com", Some("1928301774"))
    .to("Bob", "sip:bob@example.com", None)
    .call_id("a84b4c76e66710@alice-pc.example.com")
    .cseq(314161)
    .via("alice-pc.example.com:5060", "UDP", Some("z9hG4bKasd456"))
    .max_forwards(70)
    .build();
<span class="boring">}</span></code></pre></pre>
<p>Other available method-specific builders include:</p>
<ul>
<li><code>SimpleRequestBuilder::ack()</code></li>
<li><code>SimpleRequestBuilder::cancel()</code></li>
<li><code>SimpleRequestBuilder::new()</code> (for any method)</li>
</ul>
<h2 id="creating-sip-responses"><a class="header" href="#creating-sip-responses">Creating SIP Responses</a></h2>
<h3 id="basic-response-structure"><a class="header" href="#basic-response-structure">Basic Response Structure</a></h3>
<p>A SIP response typically contains:</p>
<ul>
<li>A status line with SIP version, status code, and reason phrase</li>
<li>A set of headers (From, To, Call-ID, CSeq, Via, etc.)</li>
<li>An optional message body</li>
</ul>
<h3 id="using-responsebuilder"><a class="header" href="#using-responsebuilder">Using ResponseBuilder</a></h3>
<p>The <code>ResponseBuilder</code> provides a fluent interface for creating SIP responses:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use rvoip_sip_core::prelude::*;
use rvoip_sip_core::builder::CSeqBuilderExt;

// Create a 200 OK response to an INVITE
let response = ResponseBuilder::new(StatusCode::Ok, None)
    .from("Alice", "sip:alice@example.com", Some("1928301774"))
    .to("Bob", "sip:bob@example.com", Some("8675309"))
    .call_id("a84b4c76e66710@alice-pc.example.com")
    .cseq_with_method(314159, Method::Invite)
    .via("alice-pc.example.com", "UDP", Some("z9hG4bK776asdhds"))
    .contact("sip:bob@bob-pc.example.com", None)
    .build();

println!("{}", response);
<span class="boring">}</span></code></pre></pre>
<p>This produces a well-formed SIP 200 OK response:</p>
<pre><code>SIP/2.0 200 OK
From: Alice &lt;sip:alice@example.com&gt;;tag=1928301774
To: Bob &lt;sip:bob@example.com&gt;;tag=8675309
Call-ID: a84b4c76e66710@alice-pc.example.com
CSeq: 314159 INVITE
Via: SIP/2.0/UDP alice-pc.example.com;branch=z9hG4bK776asdhds
Contact: &lt;sip:bob@bob-pc.example.com&gt;
</code></pre>
<h3 id="creating-different-response-types"><a class="header" href="#creating-different-response-types">Creating Different Response Types</a></h3>
<p>You can create various response types by specifying different status codes:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// 100 Trying
let trying_response = ResponseBuilder::new(StatusCode::Trying, None)
    .from("Alice", "sip:alice@example.com", Some("1928301774"))
    .to("Bob", "sip:bob@example.com", None)
    .call_id("a84b4c76e66710@alice-pc.example.com")
    .cseq_with_method(314159, Method::Invite)
    .via("alice-pc.example.com", "UDP", Some("z9hG4bK776asdhds"))
    .build();

// 180 Ringing
let ringing_response = ResponseBuilder::new(StatusCode::Ringing, None)
    .from("Alice", "sip:alice@example.com", Some("1928301774"))
    .to("Bob", "sip:bob@example.com", Some("8675309"))
    .call_id("a84b4c76e66710@alice-pc.example.com")
    .cseq_with_method(314159, Method::Invite)
    .via("alice-pc.example.com", "UDP", Some("z9hG4bK776asdhds"))
    .contact("sip:bob@bob-pc.example.com", None)
    .build();

// 404 Not Found
let not_found_response = ResponseBuilder::new(StatusCode::NotFound, None)
    .from("Alice", "sip:alice@example.com", Some("1928301774"))
    .to("Bob", "sip:bob@example.com", Some("8675309"))
    .call_id("a84b4c76e66710@alice-pc.example.com")
    .cseq_with_method(314159, Method::Invite)
    .via("alice-pc.example.com", "UDP", Some("z9hG4bK776asdhds"))
    .build();
<span class="boring">}</span></code></pre></pre>
<h2 id="advanced-builder-features"><a class="header" href="#advanced-builder-features">Advanced Builder Features</a></h2>
<h3 id="working-with-multiple-headers"><a class="header" href="#working-with-multiple-headers">Working with Multiple Headers</a></h3>
<p>Some SIP headers, like Via, can appear multiple times in a message. The builder pattern handles this elegantly:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// INVITE request with multiple Via headers
let multi_via_request = SimpleRequestBuilder::invite("sip:bob@example.com")?
    .from("Alice", "sip:alice@example.com", Some("1928301774"))
    .to("Bob", "sip:bob@example.com", None)
    .call_id("a84b4c76e66710@alice-pc.example.com")
    .cseq(314159)
    // First Via header (proxy)
    .via("proxy1.example.com:5060", "UDP", Some("z9hG4bK87asdks7"))
    // Second Via header (client)
    .via("alice-pc.example.com:5060", "UDP", Some("z9hG4bKnashds7"))
    .max_forwards(70)
    .contact("sip:alice@alice-pc.example.com", None)
    .build();
<span class="boring">}</span></code></pre></pre>
<h3 id="adding-custom-headers"><a class="header" href="#adding-custom-headers">Adding Custom Headers</a></h3>
<p>You can add custom headers using the <code>header</code> method with <code>TypedHeader::Other</code>:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// INVITE request with custom headers
let custom_headers_request = SimpleRequestBuilder::invite("sip:bob@example.com")?
    .from("Alice", "sip:alice@example.com", Some("1928301774"))
    .to("Bob", "sip:bob@example.com", None)
    .call_id("a84b4c76e66710@alice-pc.example.com")
    .cseq(314159)
    .via("alice-pc.example.com:5060", "UDP", Some("z9hG4bK776asdhds"))
    .max_forwards(70)
    .contact("sip:alice@alice-pc.example.com", None)
    // Add custom headers using TypedHeader::Other
    .header(TypedHeader::Other(HeaderName::Other("X-Custom-Header".to_string()), HeaderValue::text("Custom Value")))
    .header(TypedHeader::Other(HeaderName::Other("X-Priority".to_string()), HeaderValue::text("1 (Highest)")))
    .header(TypedHeader::Other(HeaderName::Other("X-Session-ID".to_string()), HeaderValue::text("abc123")))
    .build();
<span class="boring">}</span></code></pre></pre>
<h3 id="working-with-complex-uris"><a class="header" href="#working-with-complex-uris">Working with Complex URIs</a></h3>
<p>The builder can handle complex SIP URIs with parameters:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Parse a complex URI
let complex_uri_str = "sip:bob@example.com:5060;transport=tcp;lr";

// Create a request with this URI
let complex_uri_request = SimpleRequestBuilder::new(Method::Message, complex_uri_str)?
    .from("Alice", "sip:alice@example.com", Some("1928301774"))
    .to("Bob", "sip:bob@example.com", None)
    .call_id("a84b4c76e66710@alice-pc.example.com")
    .cseq(314159)
    .via("alice-pc.example.com:5060", "TCP", Some("z9hG4bK776asdhds"))
    .max_forwards(70)
    .content_type("text/plain")
    .body("Hello, Bob! This is a SIP MESSAGE.")
    .build();
<span class="boring">}</span></code></pre></pre>
<h2 id="building-sdp-messages"><a class="header" href="#building-sdp-messages">Building SDP Messages</a></h2>
<p>SDP (Session Description Protocol) is commonly used with SIP for media negotiation. The <code>SdpBuilder</code> provides a fluent interface for creating SDP messages:</p>
<h3 id="basic-audio-sdp"><a class="header" href="#basic-audio-sdp">Basic Audio SDP</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use rvoip_sip_core::sdp::SdpBuilder;
use rvoip_sip_core::sdp::attributes::MediaDirection;

// Create a basic audio-only SDP
let basic_sdp = SdpBuilder::new("Audio Call")
    .origin("-", "1234567890", "1", "IN", "IP4", "192.168.1.100")
    .connection("IN", "IP4", "192.168.1.100")
    .time("0", "0")
    .media_audio(49170, "RTP/AVP")
        .formats(&amp;["0", "8"])
        .rtpmap("0", "PCMU/8000")
        .rtpmap("8", "PCMA/8000")
        .direction(MediaDirection::SendRecv)
        .done()
    .build()?;

println!("Basic Audio SDP:\n{}", basic_sdp);
<span class="boring">}</span></code></pre></pre>
<h3 id="audiovideo-sdp"><a class="header" href="#audiovideo-sdp">Audio/Video SDP</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Create a more complex SDP with audio and video
let complex_sdp = SdpBuilder::new("Audio/Video Call")
    .origin("-", "1234567890", "2", "IN", "IP4", "192.168.1.100")
    .connection("IN", "IP4", "192.168.1.100")
    .time("0", "0")
    .media_audio(49170, "RTP/AVP")
        .formats(&amp;["0", "8"])
        .rtpmap("0", "PCMU/8000")
        .rtpmap("8", "PCMA/8000")
        .direction(MediaDirection::SendRecv)
        .done()
    .media_video(51372, "RTP/AVP")
        .formats(&amp;["96", "97"])
        .rtpmap("96", "VP8/90000")
        .rtpmap("97", "H264/90000")
        .fmtp("97", "profile-level-id=42e01f;level-asymmetry-allowed=1")
        .direction(MediaDirection::SendRecv)
        .done()
    .build()?;
<span class="boring">}</span></code></pre></pre>
<h3 id="webrtc-sdp"><a class="header" href="#webrtc-sdp">WebRTC SDP</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Create a WebRTC-style SDP with ICE and DTLS
let webrtc_sdp = SdpBuilder::new("WebRTC Session")
    .origin("-", "1234567890", "2", "IN", "IP4", "192.168.1.100")
    .connection("IN", "IP4", "192.168.1.100")
    .time("0", "0")
    .group("BUNDLE", &amp;["audio", "video"])
    .ice_ufrag("F7gI")
    .ice_pwd("x9cml/YzichV2+XlhiMu8g")
    .fingerprint("sha-256", "D2:FA:0E:C3:22:59:5E:14:95:69:92:3D:13:B4:84:24")
    .media_audio(9, "UDP/TLS/RTP/SAVPF")
        .formats(&amp;["111", "103"])
        .rtpmap("111", "opus/48000/2")
        .rtpmap("103", "ISAC/16000")
        .fmtp("111", "minptime=10;useinbandfec=1")
        .rtcp_mux()
        .mid("audio")
        .direction(MediaDirection::SendRecv)
        .setup("actpass")
        .ice_ufrag("F7gI")
        .ice_pwd("x9cml/YzichV2+XlhiMu8g")
        .ice_candidate("1 1 UDP 2130706431 192.168.1.100 9 typ host")
        .done()
    .media_video(9, "UDP/TLS/RTP/SAVPF")
        .formats(&amp;["96", "97"])
        .rtpmap("96", "VP8/90000")
        .rtpmap("97", "H264/90000")
        .rtcp_fb("96", "nack", Some("pli"))
        .rtcp_fb("96", "ccm", Some("fir"))
        .rtcp_mux()
        .mid("video")
        .direction(MediaDirection::SendRecv)
        .setup("actpass")
        .ice_ufrag("F7gI")
        .ice_pwd("x9cml/YzichV2+XlhiMu8g")
        .ice_candidate("1 1 UDP 2130706431 192.168.1.100 9 typ host")
        .done()
    .build()?;
<span class="boring">}</span></code></pre></pre>
<h2 id="combining-sip-and-sdp"><a class="header" href="#combining-sip-and-sdp">Combining SIP and SDP</a></h2>
<p>To include an SDP body in a SIP message, you can use the <code>body</code> method:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Create an SDP offer using the builder
let sdp_offer = SdpBuilder::new("Call Offer")
    .origin("-", "1234567890", "1", "IN", "IP4", "192.168.1.100")
    .connection("IN", "IP4", "192.168.1.100")
    .time("0", "0")
    .media_audio(49170, "RTP/AVP")
        .formats(&amp;["0", "8"])
        .rtpmap("0", "PCMU/8000")
        .rtpmap("8", "PCMA/8000")
        .direction(MediaDirection::SendRecv)
        .done()
    .build()?;

// Use the SDP in an INVITE request
let invite_with_sdp = SimpleRequestBuilder::invite("sip:bob@example.com")?
    .from("Alice", "sip:alice@example.com", Some("1928301774"))
    .to("Bob", "sip:bob@example.com", None)
    .call_id("a84b4c76e66710@alice-pc.example.com")
    .cseq(314159)
    .via("alice-pc.example.com:5060", "UDP", Some("z9hG4bK776asdhds"))
    .max_forwards(70)
    .contact("sip:alice@alice-pc.example.com", None)
    .content_type("application/sdp")
    .body(sdp_offer.to_string())
    .build();
<span class="boring">}</span></code></pre></pre>
<h2 id="important-builder-methods"><a class="header" href="#important-builder-methods">Important Builder Methods</a></h2>
<p>Here are some of the most commonly used builder methods:</p>
<h3 id="request-builder-methods"><a class="header" href="#request-builder-methods">Request Builder Methods</a></h3>
<ul>
<li><code>from()</code>: Sets the From header</li>
<li><code>to()</code>: Sets the To header</li>
<li><code>call_id()</code>: Sets the Call-ID header</li>
<li><code>cseq()</code>: Sets the CSeq header</li>
<li><code>via()</code>: Adds a Via header</li>
<li><code>max_forwards()</code>: Sets the Max-Forwards header</li>
<li><code>contact()</code>: Sets the Contact header</li>
<li><code>content_type()</code>: Sets the Content-Type header</li>
<li><code>body()</code>: Sets the message body</li>
<li><code>header()</code>: Adds a custom header</li>
<li><code>build()</code>: Finalizes and returns the built message</li>
</ul>
<h3 id="sdp-builder-methods"><a class="header" href="#sdp-builder-methods">SDP Builder Methods</a></h3>
<ul>
<li><code>origin()</code>: Sets the origin (o=) field</li>
<li><code>connection()</code>: Sets the connection (c=) field</li>
<li><code>time()</code>: Sets the time (t=) field</li>
<li><code>media_audio()</code>: Starts building an audio media section</li>
<li><code>media_video()</code>: Starts building a video media section</li>
<li><code>formats()</code>: Sets the media formats</li>
<li><code>rtpmap()</code>: Adds an rtpmap attribute</li>
<li><code>fmtp()</code>: Adds an fmtp attribute</li>
<li><code>direction()</code>: Sets the media direction</li>
<li><code>done()</code>: Completes a media section</li>
<li><code>build()</code>: Finalizes and returns the built SDP</li>
</ul>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<p>The builder pattern provides a clean, intuitive way to create SIP and SDP messages. By chaining method calls, you can construct complex messages with minimal code and ensure that they adhere to the SIP and SDP specifications.</p>
<p>In the next tutorial, we'll dive deeper into SIP requests, exploring the different request methods, their specific requirements, and how to handle them properly.</p>
<h2 id="exercise"><a class="header" href="#exercise">Exercise</a></h2>
<ol>
<li>Create a SIP REGISTER request with multiple Contact headers and an Expires header.</li>
<li>Create a SIP 302 Moved Temporarily response with a Contact header pointing to a new location.</li>
<li>Create an SDP message for a video call with H.264 and VP8 codecs, then include it in a SIP INVITE request.</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../part1/tutorial_02.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../part1/tutorial_04.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../part1/tutorial_02.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../part1/tutorial_04.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
