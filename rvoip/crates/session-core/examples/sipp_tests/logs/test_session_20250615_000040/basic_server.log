warning: method `handle_auto_options` is never used
   --> crates/dialog-core/src/manager/unified.rs:563:14
    |
197 | impl UnifiedDialogManager {
    | ------------------------- method in this implementation
...
563 |     async fn handle_auto_options(&self, request: Request, source: SocketAddr) -> ApiResult<()> {
    |              ^^^^^^^^^^^^^^^^^^^
    |
    = note: `#[warn(dead_code)]` on by default

warning: method `extract_body_string` is never used
   --> crates/dialog-core/src/protocol/invite_handler.rs:177:8
    |
71  | impl DialogManager {
    | ------------------ method in this implementation
...
177 |     fn extract_body_string(&self, request: &Request) -> String {
    |        ^^^^^^^^^^^^^^^^^^^

warning: `rvoip-dialog-core` (lib) generated 2 warnings
warning: unused import: `StaticEvent`
  --> crates/infra-common/src/events/static_path.rs:14:60
   |
14 | use crate::events::types::{Event, EventResult, EventError, StaticEvent, EventFilter};
   |                                                            ^^^^^^^^^^^
   |
   = note: `#[warn(unused_imports)]` on by default

warning: unused imports: `EventError` and `StaticEvent`
  --> crates/infra-common/src/events/system.rs:16:48
   |
16 | use crate::events::types::{Event, EventResult, EventError, EventFilter, StaticEvent};
   |                                                ^^^^^^^^^^               ^^^^^^^^^^^

warning: unused imports: `EventSystemBuilder` and `ImplementationType`
  --> crates/infra-common/src/events/system.rs:21:30
   |
21 | use crate::events::builder::{ImplementationType, EventSystemBuilder};
   |                              ^^^^^^^^^^^^^^^^^^  ^^^^^^^^^^^^^^^^^^

warning: variable does not need to be mutable
  --> crates/infra-common/src/lifecycle/manager.rs:87:13
   |
87 |         let mut components = self.components.write().unwrap();
   |             ----^^^^^^^^^^
   |             |
   |             help: remove this `mut`
   |
   = note: `#[warn(unused_mut)]` on by default

warning: variable does not need to be mutable
   --> crates/infra-common/src/lifecycle/manager.rs:107:13
    |
107 |         let mut components = self.components.write().unwrap();
    |             ----^^^^^^^^^^
    |             |
    |             help: remove this `mut`

warning: variable does not need to be mutable
   --> crates/infra-common/src/lifecycle/manager.rs:127:13
    |
127 |         let mut components = self.components.write().unwrap();
    |             ----^^^^^^^^^^
    |             |
    |             help: remove this `mut`

warning: variable does not need to be mutable
   --> crates/infra-common/src/lifecycle/manager.rs:148:13
    |
148 |         let mut components = self.components.write().unwrap();
    |             ----^^^^^^^^^^
    |             |
    |             help: remove this `mut`

warning: use of deprecated method `config::Config::merge`: please use 'ConfigBuilder' instead
  --> crates/infra-common/src/config/loader.rs:63:20
   |
63 |             config.merge(File::from(base_path.clone()))
   |                    ^^^^^
   |
   = note: `#[warn(deprecated)]` on by default

warning: use of deprecated method `config::Config::merge`: please use 'ConfigBuilder' instead
  --> crates/infra-common/src/config/loader.rs:69:20
   |
69 |             config.merge(File::from(env_path))
   |                    ^^^^^

warning: use of deprecated method `config::Config::merge`: please use 'ConfigBuilder' instead
  --> crates/infra-common/src/config/loader.rs:75:16
   |
75 |         config.merge(Environment::with_prefix(&env_prefix).separator("__"))
   |                ^^^^^

warning: use of deprecated method `config::Config::merge`: please use 'ConfigBuilder' instead
  --> crates/infra-common/src/config/loader.rs:97:16
   |
97 |         config.merge(Environment::with_prefix(&env_prefix).separator("__"))
   |                ^^^^^

warning: use of deprecated method `config::Config::merge`: please use 'ConfigBuilder' instead
   --> crates/infra-common/src/config/loader.rs:115:20
    |
115 |             config.merge(File::from(p.clone()))
    |                    ^^^^^

warning: methods `type_name` and `clone_sender` are never used
  --> crates/infra-common/src/events/registry.rs:37:8
   |
35 | trait AnyBroadcastSender: Send + Sync + 'static {
   |       ------------------ methods in this trait
36 |     fn as_any(&self) -> &dyn Any;
37 |     fn type_name(&self) -> &str;
   |        ^^^^^^^^^
38 |     fn clone_sender(&self) -> Box<dyn AnyBroadcastSender>;
   |        ^^^^^^^^^^^^
   |
   = note: `#[warn(dead_code)]` on by default

warning: fields `id`, `event_type`, and `priority` are never read
  --> crates/infra-common/src/events/subscriber.rs:11:16
   |
10 | pub struct SubscriberHandle {
   |            ---------------- fields in this struct
11 |     pub(crate) id: u64,
   |                ^^
12 |     pub(crate) event_type: EventType,
   |                ^^^^^^^^^^
13 |     pub(crate) priority: EventPriority,
   |                ^^^^^^^^
   |
   = note: `SubscriberHandle` has derived impls for the traits `Clone` and `Debug`, but these are intentionally ignored during dead code analysis

warning: `infra-common` (lib) generated 14 warnings (run `cargo fix --lib -p infra-common` to apply 7 suggestions)
warning: unused import: `MediaControl`
 --> crates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs:8:69
  |
8 | use rvoip_session_core::{SessionCoordinator, SessionManagerBuilder, MediaControl};
  |                                                                     ^^^^^^^^^^^^
  |
  = note: `#[warn(unused_imports)]` on by default

warning: unused imports: `CallState` and `SessionId`
  --> crates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs:10:31
   |
10 |     CallHandler, CallSession, CallState, IncomingCall, CallDecision, SessionId,
   |                               ^^^^^^^^^                              ^^^^^^^^^

warning: unused import: `error`
  --> crates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs:18:21
   |
18 | use tracing::{info, error};
   |                     ^^^^^

warning: unused variable: `sdp_offer`
  --> crates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs:93:50
   |
93 |                 let sdp_answer = if let Some(ref sdp_offer) = call.sdp {
   |                                                  ^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_sdp_offer`
   |
   = note: `#[warn(unused_variables)]` on by default

warning: `sipp_tests` (bin "sip_test_server") generated 4 warnings (run `cargo fix --bin "sip_test_server"` to apply 3 suggestions)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.13s
     Running `/Users/jonathan/Documents/Work/Rudeless Ventures/rvoip/rvoip/target/debug/sip_test_server --port 5062 --mode auto-answer --log-level info`
[2m2025-06-15T07:00:44.220469Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m293:[0m 🧪 SIP Test Server starting...
[2m2025-06-15T07:00:44.220611Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m294:[0m 🔧 Configuration:
[2m2025-06-15T07:00:44.220642Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m295:[0m   📡 Port: 5062
[2m2025-06-15T07:00:44.220652Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m296:[0m   🎯 Mode: AutoAnswer
[2m2025-06-15T07:00:44.220662Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m297:[0m   📊 Metrics: true
[2m2025-06-15T07:00:44.220671Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m185:[0m 🚀 Starting SIP Test Server on port 5062
[2m2025-06-15T07:00:44.220997Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/api/unified.rs[0m[2m:[0m[2m805:[0m Creating UnifiedDialogApi with automatic transport setup in "Hybrid" mode
[2m2025-06-15T07:00:44.221521Z[0m [32m INFO[0m ThreadId(01) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m48:[0m SIP UDP transport bound to 0.0.0.0:5062
[2m2025-06-15T07:00:44.222296Z[0m [32m INFO[0m ThreadId(01) [2mcrates/transaction-core/src/transport/mod.rs[0m[2m:[0m[2m247:[0m Added UDP transport bound to 0.0.0.0:5062
[2m2025-06-15T07:00:44.222820Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/api/unified.rs[0m[2m:[0m[2m294:[0m Creating UnifiedDialogApi with global events in "Hybrid" mode
[2m2025-06-15T07:00:44.222873Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/unified.rs[0m[2m:[0m[2m252:[0m Creating UnifiedDialogManager with global events in "Hybrid" mode at 0.0.0.0:5062
[2m2025-06-15T07:00:44.222947Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/core.rs[0m[2m:[0m[2m100:[0m Creating new DialogManager with global transaction events and local address 0.0.0.0:5062
[2m2025-06-15T07:00:44.223352Z[0m [32m INFO[0m ThreadId(17) [2mcrates/dialog-core/src/manager/core.rs[0m[2m:[0m[2m128:[0m 🔄 Starting global transaction event processor for dialog-core
[2m2025-06-15T07:00:44.223646Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/src/manager/events.rs[0m[2m:[0m[2m162:[0m Session event processor started
🔗 SETUP: Setting up session coordination with dialog-core
✅ SETUP: Session coordination setup complete
[2m2025-06-15T07:00:44.223677Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m145:[0m SessionCoordinator initialized on port 5062
🎬 SPAWN: Starting session coordination event loop
📡 EVENT LOOP: Session coordination event loop started
[2m2025-06-15T07:00:44.223732Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m151:[0m Starting main coordinator event loop
[2m2025-06-15T07:00:44.223754Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/api/unified.rs[0m[2m:[0m[2m336:[0m Starting UnifiedDialogApi
[2m2025-06-15T07:00:44.223778Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/unified.rs[0m[2m:[0m[2m294:[0m Starting UnifiedDialogManager in "Hybrid" mode
[2m2025-06-15T07:00:44.223791Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/core.rs[0m[2m:[0m[2m399:[0m DialogManager starting
[2m2025-06-15T07:00:44.223800Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/core.rs[0m[2m:[0m[2m407:[0m DialogManager started successfully
[2m2025-06-15T07:00:44.223824Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/unified.rs[0m[2m:[0m[2m310:[0m Hybrid mode active - from_uri: Some("sip:test@127.0.0.1:5062"), domain: None, auto_auth: false, auto_options: false
[2m2025-06-15T07:00:44.223834Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/unified.rs[0m[2m:[0m[2m315:[0m UnifiedDialogManager started successfully
[2m2025-06-15T07:00:44.223854Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/src/manager/cleanup.rs[0m[2m:[0m[2m54:[0m Cleanup manager started
[2m2025-06-15T07:00:44.223866Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m407:[0m SessionCoordinator started
[2m2025-06-15T07:00:44.223876Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m212:[0m 🚀 Starting SIP Test Server session coordinator...
[2m2025-06-15T07:00:44.223884Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/api/unified.rs[0m[2m:[0m[2m336:[0m Starting UnifiedDialogApi
[2m2025-06-15T07:00:44.223892Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/unified.rs[0m[2m:[0m[2m294:[0m Starting UnifiedDialogManager in "Hybrid" mode
[2m2025-06-15T07:00:44.223900Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/core.rs[0m[2m:[0m[2m399:[0m DialogManager starting
[2m2025-06-15T07:00:44.223907Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/core.rs[0m[2m:[0m[2m407:[0m DialogManager started successfully
[2m2025-06-15T07:00:44.223927Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/unified.rs[0m[2m:[0m[2m310:[0m Hybrid mode active - from_uri: Some("sip:test@127.0.0.1:5062"), domain: None, auto_auth: false, auto_options: false
[2m2025-06-15T07:00:44.223935Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/unified.rs[0m[2m:[0m[2m315:[0m UnifiedDialogManager started successfully
[2m2025-06-15T07:00:44.223944Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m407:[0m SessionCoordinator started
[2m2025-06-15T07:00:44.223966Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m217:[0m ✅ SIP Test Server ready and listening on port 5062
[2m2025-06-15T07:00:44.223974Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m218:[0m 📋 Response mode: AutoAnswer
[2m2025-06-15T07:00:44.223981Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m219:[0m 🔄 Waiting for incoming calls from SIPp...
[2m2025-06-15T07:00:44.223989Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m220:[0m 📡 Real SIP server now active - SIPp can connect!
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-99874-1-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=99874SIPpTag001\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 1-99874@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6000 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 39, 39, 38, 37, 34, 2d, 31, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 39, 39, 38, 37, 34, 53, 49, 50, 70, 54, 61, 67, 30, 30, 31, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 31, 2d, 39, 39, 38, 37, 34, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 30, 30, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-15T07:00:48.769888Z[0m [32m INFO[0m ThreadId(05) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-99874-1-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
Transaction loop starting for Key(z9hG4bK-99874-1-0:INVITE:server)
Initial state: Proceeding
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-99874-1-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
Already in requested state, no transition needed: Proceeding
[2m2025-06-15T07:00:48.770484Z[0m [32m INFO[0m ThreadId(05) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog 74224e60-3f8a-440a-b8e9-d2751b4eb578 from INVITE request
🔍 INVITE HANDLER: Created early dialog 74224e60-3f8a-440a-b8e9-d2751b4eb578
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-99874-1-0:INVITE:server) with dialog 74224e60-3f8a-440a-b8e9-d2751b4eb578
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog 74224e60-3f8a-440a-b8e9-d2751b4eb578
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog 74224e60-3f8a-440a-b8e9-d2751b4eb578
[2m2025-06-15T07:00:48.770592Z[0m [32m INFO[0m ThreadId(05) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog 74224e60-3f8a-440a-b8e9-d2751b4eb578
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(74224e60-3f8a-440a-b8e9-d2751b4eb578), transaction_id: z9hG4bK-99874-1-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-99874-1-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("99874SIPpTag001")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("1-99874@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6000 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-15T07:00:48.770766Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m139:[0m handle_incoming_call called for dialog 74224e60-3f8a-440a-b8e9-d2751b4eb578
[2m2025-06-15T07:00:48.770790Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m145:[0m Incoming call from dialog 74224e60-3f8a-440a-b8e9-d2751b4eb578: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-15T07:00:48.770829Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m153:[0m Created session sess_1ae67ca9-785a-4b94-8829-b47618dc3af3 for incoming call dialog 74224e60-3f8a-440a-b8e9-d2751b4eb578
[2m2025-06-15T07:00:48.770869Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m178:[0m Calling handler.on_incoming_call for session sess_1ae67ca9-785a-4b94-8829-b47618dc3af3
[2m2025-06-15T07:00:48.770909Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m78:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-15T07:00:48.770924Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m79:[0m 📞 [SIPp-Test-Server] Call ID: sess_1ae67ca9-785a-4b94-8829-b47618dc3af3
[2m2025-06-15T07:00:48.770941Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m90:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-15T07:00:48.770954Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m94:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating simple answer
[2m2025-06-15T07:00:48.770966Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m108:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-15T07:00:48.770977Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m190:[0m Handler decision for session sess_1ae67ca9-785a-4b94-8829-b47618dc3af3: Accept(Some("v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"))
[2m2025-06-15T07:00:48.771034Z[0m [32m INFO[0m ThreadId(17) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call 74224e60-3f8a-440a-b8e9-d2751b4eb578
🎯 COORDINATOR: Handling event: SessionCreated { session_id: SessionId("sess_1ae67ca9-785a-4b94-8829-b47618dc3af3"), from: "sip:from@127.0.0.1", to: "sip:to@local", call_state: Ringing }
[2m2025-06-15T07:00:48.771238Z[0m [32m INFO[0m ThreadId(17) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-15T07:00:48.771261Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m205:[0m Session sess_1ae67ca9-785a-4b94-8829-b47618dc3af3 created with state Ringing
[2m2025-06-15T07:00:48.771388Z[0m [32m INFO[0m ThreadId(17) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog 74224e60-3f8a-440a-b8e9-d2751b4eb578 local tag set to match response: tag-b631034336a145d38075cb0042bd0fda
[2m2025-06-15T07:00:48.771402Z[0m [32m INFO[0m ThreadId(17) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog 74224e60-3f8a-440a-b8e9-d2751b4eb578 transitioned to Confirmed state
[2m2025-06-15T07:00:48.771422Z[0m [32m INFO[0m ThreadId(17) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog 74224e60-3f8a-440a-b8e9-d2751b4eb578
[2m2025-06-15T07:00:48.771439Z[0m [32m INFO[0m ThreadId(17) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call 74224e60-3f8a-440a-b8e9-d2751b4eb578
[2m2025-06-15T07:00:48.771479Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m214:[0m Successfully answered incoming call for session sess_1ae67ca9-785a-4b94-8829-b47618dc3af3
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(74224e60-3f8a-440a-b8e9-d2751b4eb578), session_answer: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
[2m2025-06-15T07:00:48.771552Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m418:[0m Call answered for session sess_1ae67ca9-785a-4b94-8829-b47618dc3af3: 74224e60-3f8a-440a-b8e9-d2751b4eb578 (awaiting ACK per RFC 3261)
[2m2025-06-15T07:00:48.771573Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m432:[0m 📞 Call answered for session sess_1ae67ca9-785a-4b94-8829-b47618dc3af3 - keeping in Initiating state until media ready
[2m2025-06-15T07:00:48.771585Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m435:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-99874-1-0:INVITE:server)
🎯 COORDINATOR: Handling event: SdpEvent { session_id: SessionId("sess_1ae67ca9-785a-4b94-8829-b47618dc3af3"), event_type: "remote_sdp_answer", sdp: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-99874-1-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
=== PARSING SIP MESSAGE ===
Input length: Sent StateChanged event result: Success
409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-99874-1-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=99874SIPpTag001\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-b631034336a145d38075cb0042bd0fda\r\nCall-ID: 1-99874@127.0.0.1Transaction loop ending for Key(z9hG4bK-99874-1-0:INVITE:server). Final state: Terminated
\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 39, 39, 38, 37, 34, 2d, 31, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 39, 39, 38, 37, 34, 53, 49, 50, 70, 54, 61, 67, 30, 30, 31, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 62, 36, 33, 31, 30, 33, 34, 33, 33, 36, 61, 31, 34, 35, 64, 33, 38, 30, 37, 35, 63, 62, 30, 30, 34, 32, 62, 64, 30, 66, 64, 61, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 31, 2d, 39, 39, 38, 37, 34, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 98, 54, 51, 49, 48, 51, 52, 51, 51, 54, 97, 49, 52, 53, 100, 51, 56, 48, 55, 53, 99, 98, 48, 48, 52, 50, 98, 100, 48, 102, 100, 97]
Successfully parsed tag: tag-b631034336a145d38075cb0042bd0fda
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"password": Null, "port": Number(5061.0), "parameters": Array([]), "raw_uri": Null, "host": Object({"Address": String("127.0.0.1")}), "scheme": String("Sip"), "headers": Object({}), "user": String("sipp")}), "display_name": String("SIPp Test"), "params": Array([Object({"Tag": String("99874SIPpTag001")})])})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("99874SIPpTag001")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("99874SIPpTag001")})
Final value for path 'headers.From.params[0].Tag': String("99874SIPpTag001")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("SIPp Test"), "params": Array([Object({"Tag": String("99874SIPpTag001")})]), "uri": Object({"raw_uri": Null, "scheme": String("Sip"), "password": Null, "headers": Object({}), "host": Object({"Address": String("127.0.0.1")}), "user": String("sipp"), "parameters": Array([]), "port": Number(5061.0)})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("99874SIPpTag001")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("99874SIPpTag001")})
Final value for path 'headers.From.params[0].Tag': String("99874SIPpTag001")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "uri": Object({"password": Null, "scheme": String("Sip"), "port": Number(5062.0), "user": String("test"), "headers": Object({}), "host": Object({"Address": String("127.0.0.1")}), "parameters": Array([]), "raw_uri": Null}), "params": Array([])})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("tag-b631034336a145d38075cb0042bd0fda")})]), "uri": Object({"host": Object({"Address": String("127.0.0.1")}), "user": String("test"), "headers": Object({}), "scheme": String("Sip"), "parameters": Array([]), "raw_uri": Null, "port": Number(5062.0), "password": Null}), "display_name": String("Test User")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-b631034336a145d38075cb0042bd0fda")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-b631034336a145d38075cb0042bd0fda")})
Final value for path 'headers.To.params[0].Tag': String("tag-b631034336a145d38075cb0042bd0fda")
[2m2025-06-15T07:00:48.775600Z[0m [32m INFO[0m ThreadId(05) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-99874-1-0:INVITE:server) in dialog 74224e60-3f8a-440a-b8e9-d2751b4eb578 - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(74224e60-3f8a-440a-b8e9-d2751b4eb578), transaction_id: z9hG4bK-99874-1-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-15T07:00:48.775660Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m527:[0m ✅ RFC 3261: ACK RECEIVED for session sess_1ae67ca9-785a-4b94-8829-b47618dc3af3 - creating media session (UAS side)
🎯 COORDINATOR: Handling event: MediaEvent { session_id: SessionId("sess_1ae67ca9-785a-4b94-8829-b47618dc3af3"), event: "rfc_compliant_media_creation_uas" }
[2m2025-06-15T07:00:48.775688Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m324:[0m Media creation event for sess_1ae67ca9-785a-4b94-8829-b47618dc3af3: rfc_compliant_media_creation_uas
🎯 COORDINATOR: Handling event: StateChanged { session_id: SessionId("sess_1ae67ca9-785a-4b94-8829-b47618dc3af3"), old_state: Ringing, new_state: Active }
[2m2025-06-15T07:00:48.775717Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m229:[0m Session sess_1ae67ca9-785a-4b94-8829-b47618dc3af3 state changed: Ringing -> Active
[2m2025-06-15T07:00:48.775738Z[0m [32m INFO[0m ThreadId(05) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m263:[0m Starting media session for dialog: media-sess_1ae67ca9-785a-4b94-8829-b47618dc3af3
[2m2025-06-15T07:00:48.775889Z[0m [32m INFO[0m ThreadId(05) [2mcrates/rtp-core/src/transport/allocator.rs[0m[2m:[0m[2m564:[0m Created global port allocator with range 16384-32767
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-99874-2-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=99874SIPpTag002\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 2-99874@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6004 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 39, 39, 38, 37, 34, 2d, 32, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 39, 39, 38, 37, 34, 53, 49, 50, 70, 54, 61, 67, 30, 30, 32, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 32, 2d, 39, 39, 38, 37, 34, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 30, 34, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-15T07:00:49.757519Z[0m [32m INFO[0m ThreadId(17) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-99874-2-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
Transaction loop starting for Key(z9hG4bK-99874-2-0:INVITE:server)
Initial state: Proceeding
[2m2025-06-15T07:00:49.757948Z[0m [32m INFO[0m ThreadId(17) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog 6accf691-9618-4706-b71c-b931e36f4af4 from INVITE request
🔍 INVITE HANDLER: Created early dialog 6accf691-9618-4706-b71c-b931e36f4af4
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-99874-2-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-99874-2-0:INVITE:server) with dialog 6accf691-9618-4706-b71c-b931e36f4af4
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog 6accf691-9618-4706-b71c-b931e36f4af4
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog 6accf691-9618-4706-b71c-b931e36f4af4
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(6accf691-9618-4706-b71c-b931e36f4af4), transaction_id: z9hG4bK-99874-2-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-99874-2-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("99874SIPpTag002")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("2-99874@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6004 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-15T07:00:49.758663Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m139:[0m handle_incoming_call called for dialog 6accf691-9618-4706-b71c-b931e36f4af4
[2m2025-06-15T07:00:49.758458Z[0m [32m INFO[0m ThreadId(17) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog 6accf691-9618-4706-b71c-b931e36f4af4
[2m2025-06-15T07:00:49.758820Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m145:[0m Incoming call from dialog 6accf691-9618-4706-b71c-b931e36f4af4: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-15T07:00:49.758969Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m153:[0m Created session sess_5b575408-ceac-4ebf-878d-777da37394f0 for incoming call dialog 6accf691-9618-4706-b71c-b931e36f4af4
[2m2025-06-15T07:00:49.759042Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m178:[0m Calling handler.on_incoming_call for session sess_5b575408-ceac-4ebf-878d-777da37394f0
[2m2025-06-15T07:00:49.759082Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m78:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-15T07:00:49.759112Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m79:[0m 📞 [SIPp-Test-Server] Call ID: sess_5b575408-ceac-4ebf-878d-777da37394f0
[2m2025-06-15T07:00:49.759144Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m90:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-15T07:00:49.759171Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m94:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating simple answer
[2m2025-06-15T07:00:49.759215Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m108:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-15T07:00:49.759253Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m190:[0m Handler decision for session sess_5b575408-ceac-4ebf-878d-777da37394f0: Accept(Some("v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"))
[2m2025-06-15T07:00:49.759393Z[0m [32m INFO[0m ThreadId(05) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call 6accf691-9618-4706-b71c-b931e36f4af4
[2m2025-06-15T07:00:49.760049Z[0m [32m INFO[0m ThreadId(05) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-15T07:00:49.760315Z[0m [32m INFO[0m ThreadId(05) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog 6accf691-9618-4706-b71c-b931e36f4af4 local tag set to match response: tag-0e94de120e8543a6b6a9d94884430a53
[2m2025-06-15T07:00:49.760619Z[0m [32m INFO[0m ThreadId(05) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog 6accf691-9618-4706-b71c-b931e36f4af4 transitioned to Confirmed state
[2m2025-06-15T07:00:49.760748Z[0m [32m INFO[0m ThreadId(05) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog 6accf691-9618-4706-b71c-b931e36f4af4
[2m2025-06-15T07:00:49.760818Z[0m [32m INFO[0m ThreadId(05) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call 6accf691-9618-4706-b71c-b931e36f4af4
[2m2025-06-15T07:00:49.760873Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m214:[0m Successfully answered incoming call for session sess_5b575408-ceac-4ebf-878d-777da37394f0
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(6accf691-9618-4706-b71c-b931e36f4af4), session_answer: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
[2m2025-06-15T07:00:49.761060Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m418:[0m Call answered for session sess_5b575408-ceac-4ebf-878d-777da37394f0: 6accf691-9618-4706-b71c-b931e36f4af4 (awaiting ACK per RFC 3261)
[2m2025-06-15T07:00:49.761113Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m432:[0m 📞 Call answered for session sess_5b575408-ceac-4ebf-878d-777da37394f0 - keeping in Initiating state until media ready
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r[2m2025-06-15T07:00:49.761154Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m435:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-99874-2-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=99874SIPpTag002\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-0e94de120e8543a6b6a9d94884430a53\r\nCall-ID: 2-99874@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, Received command: CancelTimer100 for transaction Key(z9hG4bK-99874-2-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-99874-2-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
31, 3a, 35, 30, 36, Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-99874-2-0:INVITE:server). Final state: Terminated
32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 39, 39, 38, 37, 34, 2d, 32, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 39, 39, 38, 37, 34, 53, 49, 50, 70, 54, 61, 67, 30, 30, 32, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 30, 65, 39, 34, 64, 65, 31, 32, 30, 65, 38, 35, 34, 33, 61, 36, 62, 36, 61, 39, 64, 39, 34, 38, 38, 34, 34, 33, 30, 61, 35, 33, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 32, 2d, 39, 39, 38, 37, 34, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 48, 101, 57, 52, 100, 101, 49, 50, 48, 101, 56, 53, 52, 51, 97, 54, 98, 54, 97, 57, 100, 57, 52, 56, 56, 52, 52, 51, 48, 97, 53, 51]
Successfully parsed tag: tag-0e94de120e8543a6b6a9d94884430a53
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"headers": Object({}), "port": Number(5061.0), "password": Null, "raw_uri": Null, "host": Object({"Address": String("127.0.0.1")}), "scheme": String("Sip"), "user": String("sipp"), "parameters": Array([])}), "display_name": String("SIPp Test"), "params": Array([Object({"Tag": String("99874SIPpTag002")})])})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("99874SIPpTag002")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("99874SIPpTag002")})
Final value for path 'headers.From.params[0].Tag': String("99874SIPpTag002")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"port": Number(5061.0), "password": Null, "user": String("sipp"), "parameters": Array([]), "host": Object({"Address": String("127.0.0.1")}), "scheme": String("Sip"), "headers": Object({}), "raw_uri": Null}), "display_name": String("SIPp Test"), "params": Array([Object({"Tag": String("99874SIPpTag002")})])})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("99874SIPpTag002")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("99874SIPpTag002")})
Final value for path 'headers.From.params[0].Tag': String("99874SIPpTag002")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "uri": Object({"port": Number(5062.0), "host": Object({"Address": String("127.0.0.1")}), "user": String("test"), "headers": Object({}), "scheme": String("Sip"), "raw_uri": Null, "parameters": Array([]), "password": Null}), "params": Array([])})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("tag-0e94de120e8543a6b6a9d94884430a53")})]), "display_name": String("Test User"), "uri": Object({"user": String("test"), "port": Number(5062.0), "raw_uri": Null, "scheme": String("Sip"), "parameters": Array([]), "host": Object({"Address": String("127.0.0.1")}), "password": Null, "headers": Object({})})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-0e94de120e8543a6b6a9d94884430a53")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-0e94de120e8543a6b6a9d94884430a53")})
Final value for path 'headers.To.params[0].Tag': String("tag-0e94de120e8543a6b6a9d94884430a53")
[2m2025-06-15T07:00:49.769547Z[0m [32m INFO[0m ThreadId(16) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-99874-2-0:INVITE:server) in dialog 6accf691-9618-4706-b71c-b931e36f4af4 - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(6accf691-9618-4706-b71c-b931e36f4af4), transaction_id: z9hG4bK-99874-2-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-15T07:00:49.769640Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m527:[0m ✅ RFC 3261: ACK RECEIVED for session sess_5b575408-ceac-4ebf-878d-777da37394f0 - creating media session (UAS side)
[2m2025-06-15T07:00:49.782198Z[0m [32m INFO[0m ThreadId(16) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-15T07:00:49.782708Z[0m [32m INFO[0m ThreadId(16) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=b3aa727a
[2m2025-06-15T07:00:49.782817Z[0m [32m INFO[0m ThreadId(16) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m339:[0m ✅ Created media session with REAL RTP session: media-sess_1ae67ca9-785a-4b94-8829-b47618dc3af3 (port: 30219)
[2m2025-06-15T07:00:49.782930Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m411:[0m ✅ Created media session: media-sess_1ae67ca9-785a-4b94-8829-b47618dc3af3 for SIP session: sess_1ae67ca9-785a-4b94-8829-b47618dc3af3 with real MediaSessionController + zero-copy enabled
[2m2025-06-15T07:00:49.782956Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m64:[0m Media session created and mapped for SIP session: sess_1ae67ca9-785a-4b94-8829-b47618dc3af3
[2m2025-06-15T07:00:49.783001Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m243:[0m Media info available: true
[2m2025-06-15T07:00:49.783021Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m245:[0m Local SDP length: None
[2m2025-06-15T07:00:49.783034Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m246:[0m Remote SDP length: None
[2m2025-06-15T07:00:49.783046Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m252:[0m Notifying handler about call sess_1ae67ca9-785a-4b94-8829-b47618dc3af3 establishment
[2m2025-06-15T07:00:49.783068Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/api/handlers.rs[0m[2m:[0m[2m31:[0m Call sess_1ae67ca9-785a-4b94-8829-b47618dc3af3 established
🎯 COORDINATOR: Handling event: SessionCreated { session_id: SessionId("sess_5b575408-ceac-4ebf-878d-777da37394f0"), from: "sip:from@127.0.0.1", to: "sip:to@local", call_state: Ringing }
[2m2025-06-15T07:00:49.783112Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m205:[0m Session sess_5b575408-ceac-4ebf-878d-777da37394f0 created with state Ringing
🎯 COORDINATOR: Handling event: SdpEvent { session_id: SessionId("sess_5b575408-ceac-4ebf-878d-777da37394f0"), event_type: "remote_sdp_answer", sdp: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
🎯 COORDINATOR: Handling event: MediaEvent { session_id: SessionId("sess_5b575408-ceac-4ebf-878d-777da37394f0"), event: "rfc_compliant_media_creation_uas" }
[2m2025-06-15T07:00:49.783149Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m324:[0m Media creation event for sess_5b575408-ceac-4ebf-878d-777da37394f0: rfc_compliant_media_creation_uas
🎯 COORDINATOR: Handling event: StateChanged { session_id: SessionId("sess_5b575408-ceac-4ebf-878d-777da37394f0"), old_state: Ringing, new_state: Active }
[2m2025-06-15T07:00:49.783187Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m229:[0m Session sess_5b575408-ceac-4ebf-878d-777da37394f0 state changed: Ringing -> Active
[2m2025-06-15T07:00:49.783211Z[0m [32m INFO[0m ThreadId(16) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m263:[0m Starting media session for dialog: media-sess_5b575408-ceac-4ebf-878d-777da37394f0
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-99874-3-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=99874SIPpTag003\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 3-99874@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6008 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 39, 39, 38, 37, 34, 2d, 33, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 39, 39, 38, 37, 34, 53, 49, 50, 70, 54, 61, 67, 30, 30, 33, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 33, 2d, 39, 39, 38, 37, 34, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 30, 38, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-15T07:00:50.758137Z[0m [32m INFO[0m ThreadId(15) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-99874-3-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
Transaction loop starting for Key(z9hG4bK-99874-3-0:INVITE:server)
Initial state: Proceeding
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-99874-3-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
[2m2025-06-15T07:00:50.758400Z[0m [32m INFO[0m ThreadId(15) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog 99df1fc8-f438-4691-923c-425e059fd71b from INVITE request
🔍 INVITE HANDLER: Created early dialog 99df1fc8-f438-4691-923c-425e059fd71b
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-99874-3-0:INVITE:server) with dialog 99df1fc8-f438-4691-923c-425e059fd71b
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog 99df1fc8-f438-4691-923c-425e059fd71b
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog 99df1fc8-f438-4691-923c-425e059fd71b
[2m2025-06-15T07:00:50.758487Z[0m [32m INFO[0m ThreadId(15) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog 99df1fc8-f438-4691-923c-425e059fd71b
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(99df1fc8-f438-4691-923c-425e059fd71b), transaction_id: z9hG4bK-99874-3-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-99874-3-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("99874SIPpTag003")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("3-99874@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6008 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-15T07:00:50.758645Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m139:[0m handle_incoming_call called for dialog 99df1fc8-f438-4691-923c-425e059fd71b
[2m2025-06-15T07:00:50.758664Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m145:[0m Incoming call from dialog 99df1fc8-f438-4691-923c-425e059fd71b: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-15T07:00:50.758705Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m153:[0m Created session sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb for incoming call dialog 99df1fc8-f438-4691-923c-425e059fd71b
[2m2025-06-15T07:00:50.758791Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m178:[0m Calling handler.on_incoming_call for session sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb
[2m2025-06-15T07:00:50.758844Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m78:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-15T07:00:50.758861Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m79:[0m 📞 [SIPp-Test-Server] Call ID: sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb
[2m2025-06-15T07:00:50.758879Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m90:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-15T07:00:50.758894Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m94:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating simple answer
[2m2025-06-15T07:00:50.758919Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m108:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-15T07:00:50.758958Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m190:[0m Handler decision for session sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb: Accept(Some("v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"))
[2m2025-06-15T07:00:50.759009Z[0m [32m INFO[0m ThreadId(17) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call 99df1fc8-f438-4691-923c-425e059fd71b
[2m2025-06-15T07:00:50.759262Z[0m [32m INFO[0m ThreadId(17) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-15T07:00:50.759434Z[0m [32m INFO[0m ThreadId(17) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog 99df1fc8-f438-4691-923c-425e059fd71b local tag set to match response: tag-8dc2881ceba84e049758875245729ef6
[2m2025-06-15T07:00:50.759453Z[0m [32m INFO[0m ThreadId(17) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog 99df1fc8-f438-4691-923c-425e059fd71b transitioned to Confirmed state
[2m2025-06-15T07:00:50.759491Z[0m [32m INFO[0m ThreadId(17) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog 99df1fc8-f438-4691-923c-425e059fd71b
[2m2025-06-15T07:00:50.759518Z[0m [32m INFO[0m ThreadId(17) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call 99df1fc8-f438-4691-923c-425e059fd71b
[2m2025-06-15T07:00:50.759535Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m214:[0m Successfully answered incoming call for session sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(99df1fc8-f438-4691-923c-425e059fd71b), session_answer: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
[2m2025-06-15T07:00:50.759596Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m418:[0m Call answered for session sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb: 99df1fc8-f438-4691-923c-425e059fd71b (awaiting ACK per RFC 3261)
[2m2025-06-15T07:00:50.759620Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m432:[0m 📞 Call answered for session sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb - keeping in Initiating state until media ready
[2m2025-06-15T07:00:50.759632Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m435:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-99874-3-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-99874-3-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-99874-3-0:INVITE:server). Final state: Terminated
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-99874-3-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=99874SIPpTag003\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-8dc2881ceba84e049758875245729ef6\r\nCall-ID: 3-99874@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 39, 39, 38, 37, 34, 2d, 33, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 39, 39, 38, 37, 34, 53, 49, 50, 70, 54, 61, 67, 30, 30, 33, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 38, 64, 63, 32, 38, 38, 31, 63, 65, 62, 61, 38, 34, 65, 30, 34, 39, 37, 35, 38, 38, 37, 35, 32, 34, 35, 37, 32, 39, 65, 66, 36, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 33, 2d, 39, 39, 38, 37, 34, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 56, 100, 99, 50, 56, 56, 49, 99, 101, 98, 97, 56, 52, 101, 48, 52, 57, 55, 53, 56, 56, 55, 53, 50, 52, 53, 55, 50, 57, 101, 102, 54]
Successfully parsed tag: tag-8dc2881ceba84e049758875245729ef6
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("99874SIPpTag003")})]), "uri": Object({"scheme": String("Sip"), "raw_uri": Null, "host": Object({"Address": String("127.0.0.1")}), "user": String("sipp"), "password": Null, "port": Number(5061.0), "parameters": Array([]), "headers": Object({})}), "display_name": String("SIPp Test")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("99874SIPpTag003")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("99874SIPpTag003")})
Final value for path 'headers.From.params[0].Tag': String("99874SIPpTag003")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("SIPp Test"), "params": Array([Object({"Tag": String("99874SIPpTag003")})]), "uri": Object({"password": Null, "port": Number(5061.0), "headers": Object({}), "user": String("sipp"), "raw_uri": Null, "scheme": String("Sip"), "parameters": Array([]), "host": Object({"Address": String("127.0.0.1")})})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("99874SIPpTag003")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("99874SIPpTag003")})
Final value for path 'headers.From.params[0].Tag': String("99874SIPpTag003")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "uri": Object({"port": Number(5062.0), "host": Object({"Address": String("127.0.0.1")}), "scheme": String("Sip"), "headers": Object({}), "user": String("test"), "parameters": Array([]), "raw_uri": Null, "password": Null}), "params": Array([])})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"host": Object({"Address": String("127.0.0.1")}), "headers": Object({}), "parameters": Array([]), "raw_uri": Null, "scheme": String("Sip"), "password": Null, "user": String("test"), "port": Number(5062.0)}), "display_name": String("Test User"), "params": Array([Object({"Tag": String("tag-8dc2881ceba84e049758875245729ef6")})])})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-8dc2881ceba84e049758875245729ef6")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-8dc2881ceba84e049758875245729ef6")})
Final value for path 'headers.To.params[0].Tag': String("tag-8dc2881ceba84e049758875245729ef6")
[2m2025-06-15T07:00:50.764292Z[0m [32m INFO[0m ThreadId(14) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-99874-3-0:INVITE:server) in dialog 99df1fc8-f438-4691-923c-425e059fd71b - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(99df1fc8-f438-4691-923c-425e059fd71b), transaction_id: z9hG4bK-99874-3-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-15T07:00:50.764365Z[0m [32m INFO[0m ThreadId(14) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m527:[0m ✅ RFC 3261: ACK RECEIVED for session sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb - creating media session (UAS side)
[2m2025-06-15T07:00:50.786877Z[0m [32m INFO[0m ThreadId(17) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-15T07:00:50.787098Z[0m [32m INFO[0m ThreadId(17) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=a3325419
[2m2025-06-15T07:00:50.787157Z[0m [32m INFO[0m ThreadId(17) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m339:[0m ✅ Created media session with REAL RTP session: media-sess_5b575408-ceac-4ebf-878d-777da37394f0 (port: 31200)
[2m2025-06-15T07:00:50.787217Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m411:[0m ✅ Created media session: media-sess_5b575408-ceac-4ebf-878d-777da37394f0 for SIP session: sess_5b575408-ceac-4ebf-878d-777da37394f0 with real MediaSessionController + zero-copy enabled
[2m2025-06-15T07:00:50.787244Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m64:[0m Media session created and mapped for SIP session: sess_5b575408-ceac-4ebf-878d-777da37394f0
[2m2025-06-15T07:00:50.787287Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m243:[0m Media info available: true
[2m2025-06-15T07:00:50.787305Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m245:[0m Local SDP length: None
[2m2025-06-15T07:00:50.787321Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m246:[0m Remote SDP length: None
[2m2025-06-15T07:00:50.787336Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m252:[0m Notifying handler about call sess_5b575408-ceac-4ebf-878d-777da37394f0 establishment
[2m2025-06-15T07:00:50.787353Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/api/handlers.rs[0m[2m:[0m[2m31:[0m Call sess_5b575408-ceac-4ebf-878d-777da37394f0 established
🎯 COORDINATOR: Handling event: SessionCreated { session_id: SessionId("sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb"), from: "sip:from@127.0.0.1", to: "sip:to@local", call_state: Ringing }
[2m2025-06-15T07:00:50.787392Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m205:[0m Session sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb created with state Ringing
🎯 COORDINATOR: Handling event: SdpEvent { session_id: SessionId("sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb"), event_type: "remote_sdp_answer", sdp: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
🎯 COORDINATOR: Handling event: MediaEvent { session_id: SessionId("sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb"), event: "rfc_compliant_media_creation_uas" }
[2m2025-06-15T07:00:50.787431Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m324:[0m Media creation event for sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb: rfc_compliant_media_creation_uas
🎯 COORDINATOR: Handling event: StateChanged { session_id: SessionId("sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb"), old_state: Ringing, new_state: Active }
[2m2025-06-15T07:00:50.787483Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m229:[0m Session sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb state changed: Ringing -> Active
[2m2025-06-15T07:00:50.787507Z[0m [32m INFO[0m ThreadId(17) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m263:[0m Starting media session for dialog: media-sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb
[2m2025-06-15T07:00:51.789711Z[0m [32m INFO[0m ThreadId(17) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-15T07:00:51.789817Z[0m [32m INFO[0m ThreadId(17) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=b02a62bc
[2m2025-06-15T07:00:51.789858Z[0m [32m INFO[0m ThreadId(17) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m339:[0m ✅ Created media session with REAL RTP session: media-sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb (port: 25472)
[2m2025-06-15T07:00:51.789896Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m411:[0m ✅ Created media session: media-sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb for SIP session: sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb with real MediaSessionController + zero-copy enabled
[2m2025-06-15T07:00:51.789916Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m64:[0m Media session created and mapped for SIP session: sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb
[2m2025-06-15T07:00:51.789948Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m243:[0m Media info available: true
[2m2025-06-15T07:00:51.789962Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m245:[0m Local SDP length: None
[2m2025-06-15T07:00:51.789974Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m246:[0m Remote SDP length: None
[2m2025-06-15T07:00:51.789986Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m252:[0m Notifying handler about call sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb establishment
[2m2025-06-15T07:00:51.789998Z[0m [32m INFO[0m ThreadId(17) [2mcrates/session-core/src/api/handlers.rs[0m[2m:[0m[2m31:[0m Call sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb established
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-99874-1-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=99874SIPpTag001\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-b631034336a145d38075cb0042bd0fda\r\nCall-ID: 1-99874@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 39, 39, 38, 37, 34, 2d, 31, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 39, 39, 38, 37, 34, 53, 49, 50, 70, 54, 61, 67, 30, 30, 31, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 62, 36, 33, 31, 30, 33, 34, 33, 33, 36, 61, 31, 34, 35, 64, 33, 38, 30, 37, 35, 63, 62, 30, 30, 34, 32, 62, 64, 30, 66, 64, 61, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 31, 2d, 39, 39, 38, 37, 34, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 98, 54, 51, 49, 48, 51, 52, 51, 51, 54, 97, 49, 52, 53, 100, 51, 56, 48, 55, 53, 99, 98, 48, 48, 52, 50, 98, 100, 48, 102, 100, 97]
Successfully parsed tag: tag-b631034336a145d38075cb0042bd0fda
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-15T07:00:53.782850Z[0m [32m INFO[0m ThreadId(14) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-99874-1-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-99874-1-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-99874-1-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-99874-1-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("99874SIPpTag001")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-b631034336a145d38075cb0042bd0fda")] })), CallId(CallId("1-99874@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-99874-1-7:BYE:server)
[2m2025-06-15T07:00:53.783534Z[0m [32m INFO[0m ThreadId(14) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-99874-1-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
Valid state transition: Trying -> Completed
State successfully changed to: Completed
[2m2025-06-15T07:00:53.783933Z[0m [32m INFO[0m ThreadId(14) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog 74224e60-3f8a-440a-b8e9-d2751b4eb578
Sent StateChanged event result: Success
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(74224e60-3f8a-440a-b8e9-d2751b4eb578), reason: "BYE received" }
[2m2025-06-15T07:00:53.784473Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m601:[0m handle_call_terminated called for dialog 74224e60-3f8a-440a-b8e9-d2751b4eb578: BYE received
[2m2025-06-15T07:00:53.784545Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m604:[0m Call terminated for session sess_1ae67ca9-785a-4b94-8829-b47618dc3af3: 74224e60-3f8a-440a-b8e9-d2751b4eb578 - BYE received
🎯 COORDINATOR: Handling event: SessionTerminated { session_id: SessionId("sess_1ae67ca9-785a-4b94-8829-b47618dc3af3"), reason: "BYE received" }
🎯 COORDINATOR: Matched SessionTerminated event for sess_1ae67ca9-785a-4b94-8829-b47618dc3af3 - BYE received
🔴 COORDINATOR: handle_session_terminated called for session sess_1ae67ca9-785a-4b94-8829-b47618dc3af3 with reason: BYE received
[2m2025-06-15T07:00:53.784710Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m289:[0m Session sess_1ae67ca9-785a-4b94-8829-b47618dc3af3 terminated: BYE received
[2m2025-06-15T07:00:53.784770Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m92:[0m Media session terminated for SIP session: sess_1ae67ca9-785a-4b94-8829-b47618dc3af3
🔔 COORDINATOR: Handler exists, checking for session sess_1ae67ca9-785a-4b94-8829-b47618dc3af3
✅ COORDINATOR: Found session sess_1ae67ca9-785a-4b94-8829-b47618dc3af3, calling handler.on_call_ended
[2m2025-06-15T07:00:53.784875Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m299:[0m Notifying handler about session sess_1ae67ca9-785a-4b94-8829-b47618dc3af3 termination
[2m2025-06-15T07:00:53.784916Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m162:[0m 📴 [SIPp-Test-Server] Call sess_1ae67ca9-785a-4b94-8829-b47618dc3af3 ended: BYE received
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-99874-2-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=99874SIPpTag002\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-0e94de120e8543a6b6a9d94884430a53\r\nCall-ID: 2-99874@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 39, 39, 38, 37, 34, 2d, 32, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 39, 39, 38, 37, 34, 53, 49, 50, 70, 54, 61, 67, 30, 30, 32, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 30, 65, 39, 34, 64, 65, 31, 32, 30, 65, 38, 35, 34, 33, 61, 36, 62, 36, 61, 39, 64, 39, 34, 38, 38, 34, 34, 33, 30, 61, 35, 33, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 32, 2d, 39, 39, 38, 37, 34, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 48, 101, 57, 52, 100, 101, 49, 50, 48, 101, 56, 53, 52, 51, 97, 54, 98, 54, 97, 57, 100, 57, 52, 56, 56, 52, 52, 51, 48, 97, 53, 51]
Successfully parsed tag: tag-0e94de120e8543a6b6a9d94884430a53
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-15T07:00:54.768492Z[0m [32m INFO[0m ThreadId(05) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-99874-2-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-99874-2-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-99874-2-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-99874-2-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("99874SIPpTag002")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-0e94de120e8543a6b6a9d94884430a53")] })), CallId(CallId("2-99874@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-99874-2-7:BYE:server)
[2m2025-06-15T07:00:54.768868Z[0m [32m INFO[0m ThreadId(05) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-99874-2-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
Valid state transition: Trying -> Completed
State successfully changed to: Completed
Sent StateChanged event result: Success
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(6accf691-9618-4706-b71c-b931e36f4af4), reason: "BYE received" }
[2m2025-06-15T07:00:54.769245Z[0m [32m INFO[0m ThreadId(05) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog 6accf691-9618-4706-b71c-b931e36f4af4
[2m2025-06-15T07:00:54.769281Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m601:[0m handle_call_terminated called for dialog 6accf691-9618-4706-b71c-b931e36f4af4: BYE received
[2m2025-06-15T07:00:54.769309Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m604:[0m Call terminated for session sess_5b575408-ceac-4ebf-878d-777da37394f0: 6accf691-9618-4706-b71c-b931e36f4af4 - BYE received
🎯 COORDINATOR: Handling event: SessionTerminated { session_id: SessionId("sess_5b575408-ceac-4ebf-878d-777da37394f0"), reason: "BYE received" }
🎯 COORDINATOR: Matched SessionTerminated event for sess_5b575408-ceac-4ebf-878d-777da37394f0 - BYE received
🔴 COORDINATOR: handle_session_terminated called for session sess_5b575408-ceac-4ebf-878d-777da37394f0 with reason: BYE received
[2m2025-06-15T07:00:54.769377Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m289:[0m Session sess_5b575408-ceac-4ebf-878d-777da37394f0 terminated: BYE received
[2m2025-06-15T07:00:54.769404Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m92:[0m Media session terminated for SIP session: sess_5b575408-ceac-4ebf-878d-777da37394f0
🔔 COORDINATOR: Handler exists, checking for session sess_5b575408-ceac-4ebf-878d-777da37394f0
✅ COORDINATOR: Found session sess_5b575408-ceac-4ebf-878d-777da37394f0, calling handler.on_call_ended
[2m2025-06-15T07:00:54.769437Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m299:[0m Notifying handler about session sess_5b575408-ceac-4ebf-878d-777da37394f0 termination
[2m2025-06-15T07:00:54.769454Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m162:[0m 📴 [SIPp-Test-Server] Call sess_5b575408-ceac-4ebf-878d-777da37394f0 ended: BYE received
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-99874-3-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=99874SIPpTag003\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-8dc2881ceba84e049758875245729ef6\r\nCall-ID: 3-99874@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 39, 39, 38, 37, 34, 2d, 33, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 39, 39, 38, 37, 34, 53, 49, 50, 70, 54, 61, 67, 30, 30, 33, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 38, 64, 63, 32, 38, 38, 31, 63, 65, 62, 61, 38, 34, 65, 30, 34, 39, 37, 35, 38, 38, 37, 35, 32, 34, 35, 37, 32, 39, 65, 66, 36, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 33, 2d, 39, 39, 38, 37, 34, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 56, 100, 99, 50, 56, 56, 49, 99, 101, 98, 97, 56, 52, 101, 48, 52, 57, 55, 53, 56, 56, 55, 53, 50, 52, 53, 55, 50, 57, 101, 102, 54]
Successfully parsed tag: tag-8dc2881ceba84e049758875245729ef6
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-15T07:00:55.772973Z[0m [32m INFO[0m ThreadId(05) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-99874-3-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-99874-3-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-99874-3-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-99874-3-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("99874SIPpTag003")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-8dc2881ceba84e049758875245729ef6")] })), CallId(CallId("3-99874@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-99874-3-7:BYE:server)
[2m2025-06-15T07:00:55.773509Z[0m [32m INFO[0m ThreadId(05) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-99874-3-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
Valid state transition: Trying -> Completed
State successfully changed to: Completed
Sent StateChanged event result: Success
[2m2025-06-15T07:00:55.773902Z[0m [32m INFO[0m ThreadId(05) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog 99df1fc8-f438-4691-923c-425e059fd71b
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(99df1fc8-f438-4691-923c-425e059fd71b), reason: "BYE received" }
[2m2025-06-15T07:00:55.774249Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m601:[0m handle_call_terminated called for dialog 99df1fc8-f438-4691-923c-425e059fd71b: BYE received
[2m2025-06-15T07:00:55.774312Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m604:[0m Call terminated for session sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb: 99df1fc8-f438-4691-923c-425e059fd71b - BYE received
🎯 COORDINATOR: Handling event: SessionTerminated { session_id: SessionId("sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb"), reason: "BYE received" }
🎯 COORDINATOR: Matched SessionTerminated event for sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb - BYE received
🔴 COORDINATOR: handle_session_terminated called for session sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb with reason: BYE received
[2m2025-06-15T07:00:55.774449Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m289:[0m Session sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb terminated: BYE received
[2m2025-06-15T07:00:55.774496Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m92:[0m Media session terminated for SIP session: sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb
🔔 COORDINATOR: Handler exists, checking for session sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb
✅ COORDINATOR: Found session sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb, calling handler.on_call_ended
[2m2025-06-15T07:00:55.774580Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m299:[0m Notifying handler about session sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb termination
[2m2025-06-15T07:00:55.774614Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m162:[0m 📴 [SIPp-Test-Server] Call sess_c352f469-6f5c-4bfa-81cb-31a042ad69bb ended: BYE received
[2m2025-06-15T07:00:55.817481Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m246:[0m 📡 Received SIGTERM signal
[2m2025-06-15T07:00:55.817508Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m225:[0m 🛑 SIP Test Server shutting down
[2m2025-06-15T07:00:55.817519Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m265:[0m 📊 Final Statistics:
[2m2025-06-15T07:00:55.817527Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m266:[0m   ⏱️  Uptime: 11.59 seconds
[2m2025-06-15T07:00:55.817536Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m267:[0m   📞 Total calls: 3
[2m2025-06-15T07:00:55.817543Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m268:[0m   ✅ Successful calls: 3
[2m2025-06-15T07:00:55.817551Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m269:[0m   ❌ Failed calls: 0
[2m2025-06-15T07:00:55.817557Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m270:[0m   🔄 Active calls: 0
[2m2025-06-15T07:00:55.817563Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m271:[0m   📈 Success rate: 100.0%
[2m2025-06-15T07:00:55.817571Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m275:[0m   🚀 Average call rate: 0.26 calls/second
[2m2025-06-15T07:00:55.817579Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m313:[0m 👋 SIP Test Server shutdown complete
