warning: method `handle_auto_options` is never used
   --> crates/dialog-core/src/manager/unified.rs:563:14
    |
197 | impl UnifiedDialogManager {
    | ------------------------- method in this implementation
...
563 |     async fn handle_auto_options(&self, request: Request, source: SocketAddr) -> ApiResult<()> {
    |              ^^^^^^^^^^^^^^^^^^^
    |
    = note: `#[warn(dead_code)]` on by default

warning: method `extract_body_string` is never used
   --> crates/dialog-core/src/protocol/invite_handler.rs:177:8
    |
71  | impl DialogManager {
    | ------------------ method in this implementation
...
177 |     fn extract_body_string(&self, request: &Request) -> String {
    |        ^^^^^^^^^^^^^^^^^^^

warning: unused import: `StaticEvent`
  --> crates/infra-common/src/events/static_path.rs:14:60
   |
14 | use crate::events::types::{Event, EventResult, EventError, StaticEvent, EventFilter};
   |                                                            ^^^^^^^^^^^
   |
   = note: `#[warn(unused_imports)]` on by default

warning: unused imports: `EventError` and `StaticEvent`
  --> crates/infra-common/src/events/system.rs:16:48
   |
16 | use crate::events::types::{Event, EventResult, EventError, EventFilter, StaticEvent};
   |                                                ^^^^^^^^^^               ^^^^^^^^^^^

warning: unused imports: `EventSystemBuilder` and `ImplementationType`
  --> crates/infra-common/src/events/system.rs:21:30
   |
21 | use crate::events::builder::{ImplementationType, EventSystemBuilder};
   |                              ^^^^^^^^^^^^^^^^^^  ^^^^^^^^^^^^^^^^^^

warning: variable does not need to be mutable
  --> crates/infra-common/src/lifecycle/manager.rs:87:13
   |
87 |         let mut components = self.components.write().unwrap();
   |             ----^^^^^^^^^^
   |             |
   |             help: remove this `mut`
   |
   = note: `#[warn(unused_mut)]` on by default

warning: variable does not need to be mutable
   --> crates/infra-common/src/lifecycle/manager.rs:107:13
    |
107 |         let mut components = self.components.write().unwrap();
    |             ----^^^^^^^^^^
    |             |
    |             help: remove this `mut`

warning: variable does not need to be mutable
   --> crates/infra-common/src/lifecycle/manager.rs:127:13
    |
127 |         let mut components = self.components.write().unwrap();
    |             ----^^^^^^^^^^
    |             |
    |             help: remove this `mut`

warning: variable does not need to be mutable
   --> crates/infra-common/src/lifecycle/manager.rs:148:13
    |
148 |         let mut components = self.components.write().unwrap();
    |             ----^^^^^^^^^^
    |             |
    |             help: remove this `mut`

warning: use of deprecated method `config::Config::merge`: please use 'ConfigBuilder' instead
  --> crates/infra-common/src/config/loader.rs:63:20
   |
63 |             config.merge(File::from(base_path.clone()))
   |                    ^^^^^
   |
   = note: `#[warn(deprecated)]` on by default

warning: use of deprecated method `config::Config::merge`: please use 'ConfigBuilder' instead
  --> crates/infra-common/src/config/loader.rs:69:20
   |
69 |             config.merge(File::from(env_path))
   |                    ^^^^^

warning: use of deprecated method `config::Config::merge`: please use 'ConfigBuilder' instead
  --> crates/infra-common/src/config/loader.rs:75:16
   |
75 |         config.merge(Environment::with_prefix(&env_prefix).separator("__"))
   |                ^^^^^

warning: use of deprecated method `config::Config::merge`: please use 'ConfigBuilder' instead
  --> crates/infra-common/src/config/loader.rs:97:16
   |
97 |         config.merge(Environment::with_prefix(&env_prefix).separator("__"))
   |                ^^^^^

warning: use of deprecated method `config::Config::merge`: please use 'ConfigBuilder' instead
   --> crates/infra-common/src/config/loader.rs:115:20
    |
115 |             config.merge(File::from(p.clone()))
    |                    ^^^^^

warning: methods `type_name` and `clone_sender` are never used
  --> crates/infra-common/src/events/registry.rs:37:8
   |
35 | trait AnyBroadcastSender: Send + Sync + 'static {
   |       ------------------ methods in this trait
36 |     fn as_any(&self) -> &dyn Any;
37 |     fn type_name(&self) -> &str;
   |        ^^^^^^^^^
38 |     fn clone_sender(&self) -> Box<dyn AnyBroadcastSender>;
   |        ^^^^^^^^^^^^
   |
   = note: `#[warn(dead_code)]` on by default

warning: fields `id`, `event_type`, and `priority` are never read
  --> crates/infra-common/src/events/subscriber.rs:11:16
   |
10 | pub struct SubscriberHandle {
   |            ---------------- fields in this struct
11 |     pub(crate) id: u64,
   |                ^^
12 |     pub(crate) event_type: EventType,
   |                ^^^^^^^^^^
13 |     pub(crate) priority: EventPriority,
   |                ^^^^^^^^
   |
   = note: `SubscriberHandle` has derived impls for the traits `Clone` and `Debug`, but these are intentionally ignored during dead code analysis

warning: `rvoip-dialog-core` (lib) generated 2 warnings
warning: `infra-common` (lib) generated 14 warnings (run `cargo fix --lib -p infra-common` to apply 7 suggestions)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.10s
     Running `/Users/jonathan/Documents/Work/Rudeless Ventures/rvoip/rvoip/target/debug/sip_test_server --port 5062 --mode auto-answer --log-level info`
[2m2025-06-09T03:42:39.771881Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m278:[0m 🧪 SIP Test Server starting...
[2m2025-06-09T03:42:39.771997Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m279:[0m 🔧 Configuration:
[2m2025-06-09T03:42:39.772010Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m280:[0m   📡 Port: 5062
[2m2025-06-09T03:42:39.772038Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m281:[0m   🎯 Mode: AutoAnswer
[2m2025-06-09T03:42:39.772048Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m282:[0m   📊 Metrics: true
[2m2025-06-09T03:42:39.772058Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m168:[0m 🚀 Starting SIP Test Server on port 5062
[2m2025-06-09T03:42:39.772525Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/api/unified.rs[0m[2m:[0m[2m805:[0m Creating UnifiedDialogApi with automatic transport setup in "Hybrid" mode
[2m2025-06-09T03:42:39.773069Z[0m [32m INFO[0m ThreadId(01) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m48:[0m SIP UDP transport bound to 127.0.0.1:5062
[2m2025-06-09T03:42:39.773995Z[0m [32m INFO[0m ThreadId(01) [2mcrates/transaction-core/src/transport/mod.rs[0m[2m:[0m[2m247:[0m Added UDP transport bound to 127.0.0.1:5062
[2m2025-06-09T03:42:39.774507Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/api/unified.rs[0m[2m:[0m[2m294:[0m Creating UnifiedDialogApi with global events in "Hybrid" mode
[2m2025-06-09T03:42:39.774569Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/unified.rs[0m[2m:[0m[2m252:[0m Creating UnifiedDialogManager with global events in "Hybrid" mode at 127.0.0.1:5062
[2m2025-06-09T03:42:39.774612Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/core.rs[0m[2m:[0m[2m100:[0m Creating new DialogManager with global transaction events and local address 127.0.0.1:5062
🔗 SETUP: Initializing dialog coordination via DialogCoordinator
🔗 SETUP: Setting up session coordination with dialog-core
✅ SETUP: Session coordination setup complete
🎬 SPAWN: Starting dialog coordination event loop
🎬 SPAWN: Starting session coordination event loop
[2m2025-06-09T03:42:39.774996Z[0m [32m INFO[0m ThreadId(10) [2mcrates/dialog-core/src/manager/core.rs[0m[2m:[0m[2m128:[0m 🔄 Starting global transaction event processor for dialog-core
📡 EVENT LOOP: Session coordination event loop started
🌉 BRIDGE: Setting up session event bridge with media auto-creation and SDP handling
[2m2025-06-09T03:42:39.775114Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m289:[0m SessionManager initialized on port 5062
[2m2025-06-09T03:42:39.775133Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m197:[0m 🚀 Starting SIP Test Server session manager...
[2m2025-06-09T03:42:39.775145Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/api/unified.rs[0m[2m:[0m[2m336:[0m Starting UnifiedDialogApi
[2m2025-06-09T03:42:39.775156Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/unified.rs[0m[2m:[0m[2m294:[0m Starting UnifiedDialogManager in "Hybrid" mode
[2m2025-06-09T03:42:39.775168Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/core.rs[0m[2m:[0m[2m399:[0m DialogManager starting
[2m2025-06-09T03:42:39.775180Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/core.rs[0m[2m:[0m[2m407:[0m DialogManager started successfully
[2m2025-06-09T03:42:39.775192Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/unified.rs[0m[2m:[0m[2m310:[0m Hybrid mode active - from_uri: Some("sip:test@127.0.0.1:5062"), domain: None, auto_auth: false, auto_options: false
[2m2025-06-09T03:42:39.775202Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/unified.rs[0m[2m:[0m[2m315:[0m UnifiedDialogManager started successfully
[2m2025-06-09T03:42:39.775220Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/src/manager/events.rs[0m[2m:[0m[2m141:[0m Session event processor started
[2m2025-06-09T03:42:39.775256Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/src/manager/cleanup.rs[0m[2m:[0m[2m54:[0m Cleanup manager started
[2m2025-06-09T03:42:39.775268Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m302:[0m SessionManager started
[2m2025-06-09T03:42:39.775277Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m202:[0m ✅ SIP Test Server ready and listening on port 5062
[2m2025-06-09T03:42:39.775286Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m203:[0m 📋 Response mode: AutoAnswer
[2m2025-06-09T03:42:39.775295Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m204:[0m 🔄 Waiting for incoming calls from SIPp...
[2m2025-06-09T03:42:39.775304Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m205:[0m 📡 Real SIP server now active - SIPp can connect!
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-1-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag001\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 1-35937@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6000 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 31, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 31, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 31, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 30, 30, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:43.983380Z[0m [32m INFO[0m ThreadId(11) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-1-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
Transaction loop starting for Key(z9hG4bK-35937-1-0:INVITE:server)
Initial state: Proceeding
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-35937-1-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
[2m2025-06-09T03:42:43.983928Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog 93a0b567-2359-4ef2-9c1b-e78e45f58ddc from INVITE request
🔍 INVITE HANDLER: Created early dialog 93a0b567-2359-4ef2-9c1b-e78e45f58ddc
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-35937-1-0:INVITE:server) with dialog 93a0b567-2359-4ef2-9c1b-e78e45f58ddc
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog 93a0b567-2359-4ef2-9c1b-e78e45f58ddc
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog 93a0b567-2359-4ef2-9c1b-e78e45f58ddc
[2m2025-06-09T03:42:43.984020Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog 93a0b567-2359-4ef2-9c1b-e78e45f58ddc
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(93a0b567-2359-4ef2-9c1b-e78e45f58ddc), transaction_id: z9hG4bK-35937-1-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-1-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag001")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("1-35937@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6000 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-09T03:42:43.984224Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m143:[0m Incoming call from dialog 93a0b567-2359-4ef2-9c1b-e78e45f58ddc: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-09T03:42:43.984351Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m77:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-09T03:42:43.984365Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m78:[0m 📞 [SIPp-Test-Server] Call ID: sess_f406a287-8ef3-4429-83b0-f3f642636e2f
[2m2025-06-09T03:42:43.984380Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m89:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-09T03:42:43.984390Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m93:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating answer
[2m2025-06-09T03:42:43.984521Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m96:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-09T03:42:43.984609Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call 93a0b567-2359-4ef2-9c1b-e78e45f58ddc
[2m2025-06-09T03:42:43.984799Z[0m [32m INFO[0m ThreadId(09) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-09T03:42:43.984911Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog 93a0b567-2359-4ef2-9c1b-e78e45f58ddc local tag set to match response: tag-a62de703b3a943c0a6d7c9fbe6ece785
[2m2025-06-09T03:42:43.984924Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog 93a0b567-2359-4ef2-9c1b-e78e45f58ddc transitioned to Confirmed state
[2m2025-06-09T03:42:43.984946Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog 93a0b567-2359-4ef2-9c1b-e78e45f58ddc
[2m2025-06-09T03:42:43.984965Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call 93a0b567-2359-4ef2-9c1b-e78e45f58ddc
[2m2025-06-09T03:42:43.984987Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m205:[0m Successfully answered incoming call for session sess_f406a287-8ef3-4429-83b0-f3f642636e2f
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(93a0b567-2359-4ef2-9c1b-e78e45f58ddc), session_answer: "v=0\r\no=rvoip 1749440563 1749440563 IN IP4 127.0.0.1\r\ns=RVOIP Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0\r\na=rtpmap:0 PCMU/8000\r\na=sendrecv\r\n" }
[2m2025-06-09T03:42:43.985024Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m409:[0m Call answered for session sess_f406a287-8ef3-4429-83b0-f3f642636e2f: 93a0b567-2359-4ef2-9c1b-e78e45f58ddc (awaiting ACK per RFC 3261)
[2m2025-06-09T03:42:43.985046Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m423:[0m 📞 Call answered for session sess_f406a287-8ef3-4429-83b0-f3f642636e2f - keeping in Initiating state until media ready
[2m2025-06-09T03:42:43.985055Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m426:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-35937-1-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-35937-1-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-35937-1-0:INVITE:server). Final state: Terminated
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-1-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag001\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-a62de703b3a943c0a6d7c9fbe6ece785\r\nCall-ID: 1-35937@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 31, 2d, 34, 0d, 0a, [2m2025-06-09T03:42:43.985662Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m159:[0m 📄 Stored remote SDP answer for session sess_f406a287-8ef3-4429-83b0-f3f642636e2f
46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 31, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 61, 36, 32, 64, 65, 37, 30, 33, 62, 33, 61, 39, 34, 33, 63, 30, 61, 36, 64, 37, 63, 39, 66, 62, 65, 36, 65, 63, 65, 37, 38, 35, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 31, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 97, 54, 50, 100, 101, 55, 48, 51, 98, 51, 97, 57, 52, 51, 99, 48, 97, 54, 100, 55, 99, 57, 102, 98, 101, 54, 101, 99, 101, 55, 56, 53]
Successfully parsed tag: tag-a62de703b3a943c0a6d7c9fbe6ece785
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("35937SIPpTag001")})]), "display_name": String("SIPp Test"), "uri": Object({"port": Number(5061.0), "raw_uri": Null, "parameters": Array([]), "password": Null, "scheme": String("Sip"), "headers": Object({}), "host": Object({"Address": String("127.0.0.1")}), "user": String("sipp")})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag001")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag001")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag001")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("35937SIPpTag001")})]), "uri": Object({"host": Object({"Address": String("127.0.0.1")}), "port": Number(5061.0), "raw_uri": Null, "parameters": Array([]), "scheme": String("Sip"), "password": Null, "user": String("sipp"), "headers": Object({})}), "display_name": String("SIPp Test")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag001")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag001")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag001")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([]), "display_name": String("Test User"), "uri": Object({"host": Object({"Address": String("127.0.0.1")}), "scheme": String("Sip"), "raw_uri": Null, "user": String("test"), "headers": Object({}), "port": Number(5062.0), "password": Null, "parameters": Array([])})})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("tag-a62de703b3a943c0a6d7c9fbe6ece785")})]), "display_name": String("Test User"), "uri": Object({"host": Object({"Address": String("127.0.0.1")}), "headers": Object({}), "password": Null, "port": Number(5062.0), "raw_uri": Null, "user": String("test"), "parameters": Array([]), "scheme": String("Sip")})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-a62de703b3a943c0a6d7c9fbe6ece785")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-a62de703b3a943c0a6d7c9fbe6ece785")})
Final value for path 'headers.To.params[0].Tag': String("tag-a62de703b3a943c0a6d7c9fbe6ece785")
[2m2025-06-09T03:42:43.988869Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-35937-1-0:INVITE:server) in dialog 93a0b567-2359-4ef2-9c1b-e78e45f58ddc - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(93a0b567-2359-4ef2-9c1b-e78e45f58ddc), transaction_id: z9hG4bK-35937-1-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-09T03:42:43.988928Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m518:[0m ✅ RFC 3261: ACK RECEIVED for session sess_f406a287-8ef3-4429-83b0-f3f642636e2f - creating media session (UAS side)
[2m2025-06-09T03:42:43.988948Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m206:[0m 🚀 RFC 3261: Creating media session after ACK for sess_f406a287-8ef3-4429-83b0-f3f642636e2f: rfc_compliant_media_creation_uas
[2m2025-06-09T03:42:43.988966Z[0m [32m INFO[0m ThreadId(11) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m377:[0m Starting media session for dialog: media-sess_f406a287-8ef3-4429-83b0-f3f642636e2f
[2m2025-06-09T03:42:43.989112Z[0m [32m INFO[0m ThreadId(11) [2mcrates/rtp-core/src/transport/allocator.rs[0m[2m:[0m[2m564:[0m Created global port allocator with range 16384-32767
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-2-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag002\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 2-35937@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6004 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 32, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 32, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 32, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 30, 34, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:44.485523Z[0m [32m INFO[0m ThreadId(09) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-2-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
Transaction loop starting for Key(z9hG4bK-35937-2-0:INVITE:server)
Initial state: Proceeding
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-35937-2-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
[2m2025-06-09T03:42:44.485750Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog 2bf130fa-6fa8-4e3a-b127-3f562d0159db from INVITE request
🔍 INVITE HANDLER: Created early dialog 2bf130fa-6fa8-4e3a-b127-3f562d0159db
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-35937-2-0:INVITE:server) with dialog 2bf130fa-6fa8-4e3a-b127-3f562d0159db
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog 2bf130fa-6fa8-4e3a-b127-3f562d0159db
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog 2bf130fa-6fa8-4e3a-b127-3f562d0159db
[2m2025-06-09T03:42:44.485833Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog 2bf130fa-6fa8-4e3a-b127-3f562d0159db
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(2bf130fa-6fa8-4e3a-b127-3f562d0159db), transaction_id: z9hG4bK-35937-2-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-2-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag002")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("2-35937@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6004 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-09T03:42:44.485959Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m143:[0m Incoming call from dialog 2bf130fa-6fa8-4e3a-b127-3f562d0159db: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-09T03:42:44.486036Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m77:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-09T03:42:44.486053Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m78:[0m 📞 [SIPp-Test-Server] Call ID: sess_36f5a773-74e1-41a6-945a-52ec2c171e76
[2m2025-06-09T03:42:44.486081Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m89:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-09T03:42:44.486093Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m93:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating answer
[2m2025-06-09T03:42:44.486166Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m96:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-09T03:42:44.486209Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call 2bf130fa-6fa8-4e3a-b127-3f562d0159db
[2m2025-06-09T03:42:44.486408Z[0m [32m INFO[0m ThreadId(08) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-09T03:42:44.486513Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog 2bf130fa-6fa8-4e3a-b127-3f562d0159db local tag set to match response: tag-4e616f83f3f0433681eef2e13e871829
[2m2025-06-09T03:42:44.486527Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog 2bf130fa-6fa8-4e3a-b127-3f562d0159db transitioned to Confirmed state
[2m2025-06-09T03:42:44.486553Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog 2bf130fa-6fa8-4e3a-b127-3f562d0159db
[2m2025-06-09T03:42:44.486576Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call 2bf130fa-6fa8-4e3a-b127-3f562d0159db
[2m2025-06-09T03:42:44.486592Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m205:[0m Successfully answered incoming call for session sess_36f5a773-74e1-41a6-945a-52ec2c171e76
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(2bf130fa-6fa8-4e3a-b127-3f562d0159db), session_answer: "v=0\r\no=rvoip 1749440564 1749440564 IN IP4 127.0.0.1\r\ns=RVOIP Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0\r\na=rtpmap:0 PCMU/8000\r\na=sendrecv\r\n" }
[2m2025-06-09T03:42:44.486635Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m409:[0m Call answered for session sess_36f5a773-74e1-41a6-945a-52ec2c171e76: 2bf130fa-6fa8-4e3a-b127-3f562d0159db (awaiting ACK per RFC 3261)
[2m2025-06-09T03:42:44.486660Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m423:[0m 📞 Call answered for session sess_36f5a773-74e1-41a6-945a-52ec2c171e76 - keeping in Initiating state until media ready
[2m2025-06-09T03:42:44.486672Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m426:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-35937-2-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-35937-2-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-35937-2-0:INVITE:server). Final state: Terminated
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-2-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag002\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-4e616f83f3f0433681eef2e13e871829\r\nCall-ID: 2-35937@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 32, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 32, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 34, 65, 36, 31, 36, 66, 38, 33, 66, 33, 66, 30, 34, 33, 33, 36, 38, 31, 65, 65, 66, 32, 65, 31, 33, 65, 38, 37, 31, 38, 32, 39, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 32, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 52, 101, 54, 49, 54, 102, 56, 51, 102, 51, 102, 48, 52, 51, 51, 54, 56, 49, 101, 101, 102, 50, 101, 49, 51, 101, 56, 55, 49, 56, 50, 57]
Successfully parsed tag: tag-4e616f83f3f0433681eef2e13e871829
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("35937SIPpTag002")})]), "uri": Object({"port": Number(5061.0), "scheme": String("Sip"), "user": String("sipp"), "parameters": Array([]), "raw_uri": Null, "host": Object({"Address": String("127.0.0.1")}), "password": Null, "headers": Object({})}), "display_name": String("SIPp Test")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag002")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag002")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag002")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"user": String("sipp"), "host": Object({"Address": String("127.0.0.1")}), "password": Null, "raw_uri": Null, "parameters": Array([]), "headers": Object({}), "scheme": String("Sip"), "port": Number(5061.0)}), "params": Array([Object({"Tag": String("35937SIPpTag002")})]), "display_name": String("SIPp Test")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag002")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag002")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag002")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([]), "uri": Object({"password": Null, "headers": Object({}), "parameters": Array([]), "host": Object({"Address": String("127.0.0.1")}), "raw_uri": Null, "scheme": String("Sip"), "user": String("test"), "port": Number(5062.0)}), "display_name": String("Test User")})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "params": Array([Object({"Tag": String("tag-4e616f83f3f0433681eef2e13e871829")})]), "uri": Object({"password": Null, "scheme": String("Sip"), "port": Number(5062.0), "user": String("test"), "host": Object({"Address": String("127.0.0.1")}), "parameters": Array([]), "headers": Object({}), "raw_uri": Null})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-4e616f83f3f0433681eef2e13e871829")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-4e616f83f3f0433681eef2e13e871829")})
Final value for path 'headers.To.params[0].Tag': String("tag-4e616f83f3f0433681eef2e13e871829")
[2m2025-06-09T03:42:44.490645Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-35937-2-0:INVITE:server) in dialog 2bf130fa-6fa8-4e3a-b127-3f562d0159db - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(2bf130fa-6fa8-4e3a-b127-3f562d0159db), transaction_id: z9hG4bK-35937-2-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-09T03:42:44.490704Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m518:[0m ✅ RFC 3261: ACK RECEIVED for session sess_36f5a773-74e1-41a6-945a-52ec2c171e76 - creating media session (UAS side)
[2m2025-06-09T03:42:44.490921Z[0m [32m INFO[0m ThreadId(08) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-09T03:42:44.491072Z[0m [32m INFO[0m ThreadId(08) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=02d8d1c4
[2m2025-06-09T03:42:44.491115Z[0m [32m INFO[0m ThreadId(08) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m457:[0m ✅ Created media session with REAL RTP session: media-sess_f406a287-8ef3-4429-83b0-f3f642636e2f (port: 10000)
[2m2025-06-09T03:42:44.491141Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m82:[0m ✅ Created media session: media-sess_f406a287-8ef3-4429-83b0-f3f642636e2f for SIP session: sess_f406a287-8ef3-4429-83b0-f3f642636e2f with real MediaSessionController
[2m2025-06-09T03:42:44.491154Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m215:[0m ✅ Successfully created RFC-compliant media session for sess_f406a287-8ef3-4429-83b0-f3f642636e2f
[2m2025-06-09T03:42:44.491197Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m119:[0m ✅ Updated media session for SIP session: sess_f406a287-8ef3-4429-83b0-f3f642636e2f with remote: 127.0.0.1:10001 and codecs: ["PCMU"]
[2m2025-06-09T03:42:44.491211Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m224:[0m ✅ Applied stored remote SDP to new media session for sess_f406a287-8ef3-4429-83b0-f3f642636e2f
[2m2025-06-09T03:42:44.491232Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m239:[0m 🎉 Session sess_f406a287-8ef3-4429-83b0-f3f642636e2f transitioned to Active in registry - media ready and session fully established!
[2m2025-06-09T03:42:44.491278Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m159:[0m 📄 Stored remote SDP answer for session sess_36f5a773-74e1-41a6-945a-52ec2c171e76
[2m2025-06-09T03:42:44.491310Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m206:[0m 🚀 RFC 3261: Creating media session after ACK for sess_36f5a773-74e1-41a6-945a-52ec2c171e76: rfc_compliant_media_creation_uas
[2m2025-06-09T03:42:44.491325Z[0m [32m INFO[0m ThreadId(08) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m377:[0m Starting media session for dialog: media-sess_36f5a773-74e1-41a6-945a-52ec2c171e76
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-3-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag003\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 3-35937@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6008 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 33, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 33, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 33, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 30, 38, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:44.980610Z[0m [32m INFO[0m ThreadId(07) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-3-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
Transaction loop starting for Key(z9hG4bK-35937-3-0:INVITE:server)
Initial state: Proceeding
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-35937-3-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
[2m2025-06-09T03:42:44.980888Z[0m [32m INFO[0m ThreadId(07) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog 9df08fee-8c1e-46eb-96d2-4ae200a3a5a6 from INVITE request
🔍 INVITE HANDLER: Created early dialog 9df08fee-8c1e-46eb-96d2-4ae200a3a5a6
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-35937-3-0:INVITE:server) with dialog 9df08fee-8c1e-46eb-96d2-4ae200a3a5a6
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog 9df08fee-8c1e-46eb-96d2-4ae200a3a5a6
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog 9df08fee-8c1e-46eb-96d2-4ae200a3a5a6
[2m2025-06-09T03:42:44.980970Z[0m [32m INFO[0m ThreadId(07) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog 9df08fee-8c1e-46eb-96d2-4ae200a3a5a6
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(9df08fee-8c1e-46eb-96d2-4ae200a3a5a6), transaction_id: z9hG4bK-35937-3-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-3-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag003")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("3-35937@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6008 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-09T03:42:44.981097Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m143:[0m Incoming call from dialog 9df08fee-8c1e-46eb-96d2-4ae200a3a5a6: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-09T03:42:44.981169Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m77:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-09T03:42:44.981185Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m78:[0m 📞 [SIPp-Test-Server] Call ID: sess_7c4b5180-0c60-42a4-8388-fc1531710522
[2m2025-06-09T03:42:44.981204Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m89:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-09T03:42:44.981226Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m93:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating answer
[2m2025-06-09T03:42:44.981283Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m96:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-09T03:42:44.981318Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call 9df08fee-8c1e-46eb-96d2-4ae200a3a5a6
[2m2025-06-09T03:42:44.981487Z[0m [32m INFO[0m ThreadId(09) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-09T03:42:44.981563Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog 9df08fee-8c1e-46eb-96d2-4ae200a3a5a6 local tag set to match response: tag-b3258207cbb240d9a0dd4ee2e0cf60b5
[2m2025-06-09T03:42:44.981578Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog 9df08fee-8c1e-46eb-96d2-4ae200a3a5a6 transitioned to Confirmed state
[2m2025-06-09T03:42:44.981603Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog 9df08fee-8c1e-46eb-96d2-4ae200a3a5a6
[2m2025-06-09T03:42:44.981623Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call 9df08fee-8c1e-46eb-96d2-4ae200a3a5a6
[2m2025-06-09T03:42:44.981639Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m205:[0m Successfully answered incoming call for session sess_7c4b5180-0c60-42a4-8388-fc1531710522
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(9df08fee-8c1e-46eb-96d2-4ae200a3a5a6), session_answer: "v=0\r\no=rvoip 1749440564 1749440564 IN IP4 127.0.0.1\r\ns=RVOIP Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0\r\na=rtpmap:0 PCMU/8000\r\na=sendrecv\r\n" }
[2m2025-06-09T03:42:44.981681Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m409:[0m Call answered for session sess_7c4b5180-0c60-42a4-8388-fc1531710522: 9df08fee-8c1e-46eb-96d2-4ae200a3a5a6 (awaiting ACK per RFC 3261)
[2m2025-06-09T03:42:44.981704Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m423:[0m 📞 Call answered for session sess_7c4b5180-0c60-42a4-8388-fc1531710522 - keeping in Initiating state until media ready
[2m2025-06-09T03:42:44.981715Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m426:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-35937-3-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-35937-3-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-35937-3-0:INVITE:server). Final state: Terminated
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-3-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag003\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-b3258207cbb240d9a0dd4ee2e0cf60b5\r\nCall-ID: 3-35937@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 33, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 33, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 62, 33, 32, 35, 38, 32, 30, 37, 63, 62, 62, 32, 34, 30, 64, 39, 61, 30, 64, 64, 34, 65, 65, 32, 65, 30, 63, 66, 36, 30, 62, 35, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 33, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 98, 51, 50, 53, 56, 50, 48, 55, 99, 98, 98, 50, 52, 48, 100, 57, 97, 48, 100, 100, 52, 101, 101, 50, 101, 48, 99, 102, 54, 48, 98, 53]
Successfully parsed tag: tag-b3258207cbb240d9a0dd4ee2e0cf60b5
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("SIPp Test"), "uri": Object({"user": String("sipp"), "password": Null, "headers": Object({}), "host": Object({"Address": String("127.0.0.1")}), "parameters": Array([]), "raw_uri": Null, "scheme": String("Sip"), "port": Number(5061.0)}), "params": Array([Object({"Tag": String("35937SIPpTag003")})])})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag003")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag003")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag003")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("35937SIPpTag003")})]), "uri": Object({"port": Number(5061.0), "headers": Object({}), "parameters": Array([]), "user": String("sipp"), "host": Object({"Address": String("127.0.0.1")}), "scheme": String("Sip"), "raw_uri": Null, "password": Null}), "display_name": String("SIPp Test")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag003")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag003")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag003")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"scheme": String("Sip"), "raw_uri": Null, "parameters": Array([]), "headers": Object({}), "port": Number(5062.0), "host": Object({"Address": String("127.0.0.1")}), "password": Null, "user": String("test")}), "params": Array([]), "display_name": String("Test User")})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "params": Array([Object({"Tag": String("tag-b3258207cbb240d9a0dd4ee2e0cf60b5")})]), "uri": Object({"user": String("test"), "parameters": Array([]), "port": Number(5062.0), "raw_uri": Null, "headers": Object({}), "password": Null, "host": Object({"Address": String("127.0.0.1")}), "scheme": String("Sip")})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-b3258207cbb240d9a0dd4ee2e0cf60b5")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-b3258207cbb240d9a0dd4ee2e0cf60b5")})
Final value for path 'headers.To.params[0].Tag': String("tag-b3258207cbb240d9a0dd4ee2e0cf60b5")
[2m2025-06-09T03:42:44.985643Z[0m [32m INFO[0m ThreadId(06) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-35937-3-0:INVITE:server) in dialog 9df08fee-8c1e-46eb-96d2-4ae200a3a5a6 - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(9df08fee-8c1e-46eb-96d2-4ae200a3a5a6), transaction_id: z9hG4bK-35937-3-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-09T03:42:44.985714Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m518:[0m ✅ RFC 3261: ACK RECEIVED for session sess_7c4b5180-0c60-42a4-8388-fc1531710522 - creating media session (UAS side)
[2m2025-06-09T03:42:44.992887Z[0m [32m INFO[0m ThreadId(09) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-09T03:42:44.993051Z[0m [32m INFO[0m ThreadId(09) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=c725c0a2
[2m2025-06-09T03:42:44.993088Z[0m [32m INFO[0m ThreadId(09) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m457:[0m ✅ Created media session with REAL RTP session: media-sess_36f5a773-74e1-41a6-945a-52ec2c171e76 (port: 10002)
[2m2025-06-09T03:42:44.993112Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m82:[0m ✅ Created media session: media-sess_36f5a773-74e1-41a6-945a-52ec2c171e76 for SIP session: sess_36f5a773-74e1-41a6-945a-52ec2c171e76 with real MediaSessionController
[2m2025-06-09T03:42:44.993125Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m215:[0m ✅ Successfully created RFC-compliant media session for sess_36f5a773-74e1-41a6-945a-52ec2c171e76
[2m2025-06-09T03:42:44.993171Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m119:[0m ✅ Updated media session for SIP session: sess_36f5a773-74e1-41a6-945a-52ec2c171e76 with remote: 127.0.0.1:10001 and codecs: ["PCMU"]
[2m2025-06-09T03:42:44.993184Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m224:[0m ✅ Applied stored remote SDP to new media session for sess_36f5a773-74e1-41a6-945a-52ec2c171e76
[2m2025-06-09T03:42:44.993211Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m239:[0m 🎉 Session sess_36f5a773-74e1-41a6-945a-52ec2c171e76 transitioned to Active in registry - media ready and session fully established!
[2m2025-06-09T03:42:44.993268Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m159:[0m 📄 Stored remote SDP answer for session sess_7c4b5180-0c60-42a4-8388-fc1531710522
[2m2025-06-09T03:42:44.993289Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m206:[0m 🚀 RFC 3261: Creating media session after ACK for sess_7c4b5180-0c60-42a4-8388-fc1531710522: rfc_compliant_media_creation_uas
[2m2025-06-09T03:42:44.993305Z[0m [32m INFO[0m ThreadId(09) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m377:[0m Starting media session for dialog: media-sess_7c4b5180-0c60-42a4-8388-fc1531710522
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-4-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag004\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 4-35937@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6012 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 34, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 34, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 34, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 31, 32, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:45.480514Z[0m [32m INFO[0m ThreadId(11) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-4-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
Transaction loop starting for Key(z9hG4bK-35937-4-0:INVITE:server)
Initial state: Proceeding
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-35937-4-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
[2m2025-06-09T03:42:45.480711Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c from INVITE request
🔍 INVITE HANDLER: Created early dialog e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-35937-4-0:INVITE:server) with dialog e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c
[2m2025-06-09T03:42:45.480781Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c), transaction_id: z9hG4bK-35937-4-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-4-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag004")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("4-35937@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6012 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-09T03:42:45.480900Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m143:[0m Incoming call from dialog e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-09T03:42:45.480985Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m77:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-09T03:42:45.480999Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m78:[0m 📞 [SIPp-Test-Server] Call ID: sess_925f9990-4e71-44e7-89f6-db2f80a7ffc0
[2m2025-06-09T03:42:45.481013Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m89:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-09T03:42:45.481022Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m93:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating answer
[2m2025-06-09T03:42:45.481098Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m96:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-09T03:42:45.481127Z[0m [32m INFO[0m ThreadId(07) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c
[2m2025-06-09T03:42:45.481280Z[0m [32m INFO[0m ThreadId(07) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-09T03:42:45.481356Z[0m [32m INFO[0m ThreadId(07) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c local tag set to match response: tag-a8cfc318bc1c487b83880810b28db824
[2m2025-06-09T03:42:45.481368Z[0m [32m INFO[0m ThreadId(07) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c transitioned to Confirmed state
[2m2025-06-09T03:42:45.481389Z[0m [32m INFO[0m ThreadId(07) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c
[2m2025-06-09T03:42:45.481406Z[0m [32m INFO[0m ThreadId(07) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c
[2m2025-06-09T03:42:45.481419Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m205:[0m Successfully answered incoming call for session sess_925f9990-4e71-44e7-89f6-db2f80a7ffc0
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c), session_answer: "v=0\r\no=rvoip 1749440565 1749440565 IN IP4 127.0.0.1\r\ns=RVOIP Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0\r\na=rtpmap:0 PCMU/8000\r\na=sendrecv\r\n" }
[2m2025-06-09T03:42:45.481453Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m409:[0m Call answered for session sess_925f9990-4e71-44e7-89f6-db2f80a7ffc0: e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c (awaiting ACK per RFC 3261)
[2m2025-06-09T03:42:45.481474Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m423:[0m 📞 Call answered for session sess_925f9990-4e71-44e7-89f6-db2f80a7ffc0 - keeping in Initiating state until media ready
[2m2025-06-09T03:42:45.481482Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m426:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-35937-4-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-35937-4-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-35937-4-0:INVITE:server). Final state: Terminated
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-4-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag004\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-a8cfc318bc1c487b83880810b28db824\r\nCall-ID: 4-35937@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 34, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 34, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 61, 38, 63, 66, 63, 33, 31, 38, 62, 63, 31, 63, 34, 38, 37, 62, 38, 33, 38, 38, 30, 38, 31, 30, 62, 32, 38, 64, 62, 38, 32, 34, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 34, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 97, 56, 99, 102, 99, 51, 49, 56, 98, 99, 49, 99, 52, 56, 55, 98, 56, 51, 56, 56, 48, 56, 49, 48, 98, 50, 56, 100, 98, 56, 50, 52]
Successfully parsed tag: tag-a8cfc318bc1c487b83880810b28db824
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("35937SIPpTag004")})]), "uri": Object({"scheme": String("Sip"), "port": Number(5061.0), "headers": Object({}), "host": Object({"Address": String("127.0.0.1")}), "raw_uri": Null, "password": Null, "parameters": Array([]), "user": String("sipp")}), "display_name": String("SIPp Test")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag004")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag004")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag004")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("SIPp Test"), "params": Array([Object({"Tag": String("35937SIPpTag004")})]), "uri": Object({"password": Null, "parameters": Array([]), "headers": Object({}), "host": Object({"Address": String("127.0.0.1")}), "port": Number(5061.0), "raw_uri": Null, "user": String("sipp"), "scheme": String("Sip")})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag004")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag004")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag004")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([]), "display_name": String("Test User"), "uri": Object({"raw_uri": Null, "port": Number(5062.0), "headers": Object({}), "host": Object({"Address": String("127.0.0.1")}), "parameters": Array([]), "scheme": String("Sip"), "user": String("test"), "password": Null})})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "params": Array([Object({"Tag": String("tag-a8cfc318bc1c487b83880810b28db824")})]), "uri": Object({"user": String("test"), "scheme": String("Sip"), "host": Object({"Address": String("127.0.0.1")}), "raw_uri": Null, "headers": Object({}), "password": Null, "port": Number(5062.0), "parameters": Array([])})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-a8cfc318bc1c487b83880810b28db824")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-a8cfc318bc1c487b83880810b28db824")})
Final value for path 'headers.To.params[0].Tag': String("tag-a8cfc318bc1c487b83880810b28db824")
[2m2025-06-09T03:42:45.485153Z[0m [32m INFO[0m ThreadId(07) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-35937-4-0:INVITE:server) in dialog e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c), transaction_id: z9hG4bK-35937-4-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-09T03:42:45.485203Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m518:[0m ✅ RFC 3261: ACK RECEIVED for session sess_925f9990-4e71-44e7-89f6-db2f80a7ffc0 - creating media session (UAS side)
[2m2025-06-09T03:42:45.494706Z[0m [32m INFO[0m ThreadId(07) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-09T03:42:45.494855Z[0m [32m INFO[0m ThreadId(07) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=15168a18
[2m2025-06-09T03:42:45.494888Z[0m [32m INFO[0m ThreadId(07) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m457:[0m ✅ Created media session with REAL RTP session: media-sess_7c4b5180-0c60-42a4-8388-fc1531710522 (port: 10004)
[2m2025-06-09T03:42:45.494909Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m82:[0m ✅ Created media session: media-sess_7c4b5180-0c60-42a4-8388-fc1531710522 for SIP session: sess_7c4b5180-0c60-42a4-8388-fc1531710522 with real MediaSessionController
[2m2025-06-09T03:42:45.494922Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m215:[0m ✅ Successfully created RFC-compliant media session for sess_7c4b5180-0c60-42a4-8388-fc1531710522
[2m2025-06-09T03:42:45.494963Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m119:[0m ✅ Updated media session for SIP session: sess_7c4b5180-0c60-42a4-8388-fc1531710522 with remote: 127.0.0.1:10001 and codecs: ["PCMU"]
[2m2025-06-09T03:42:45.494975Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m224:[0m ✅ Applied stored remote SDP to new media session for sess_7c4b5180-0c60-42a4-8388-fc1531710522
[2m2025-06-09T03:42:45.494992Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m239:[0m 🎉 Session sess_7c4b5180-0c60-42a4-8388-fc1531710522 transitioned to Active in registry - media ready and session fully established!
[2m2025-06-09T03:42:45.495037Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m159:[0m 📄 Stored remote SDP answer for session sess_925f9990-4e71-44e7-89f6-db2f80a7ffc0
[2m2025-06-09T03:42:45.495054Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m206:[0m 🚀 RFC 3261: Creating media session after ACK for sess_925f9990-4e71-44e7-89f6-db2f80a7ffc0: rfc_compliant_media_creation_uas
[2m2025-06-09T03:42:45.495068Z[0m [32m INFO[0m ThreadId(07) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m377:[0m Starting media session for dialog: media-sess_925f9990-4e71-44e7-89f6-db2f80a7ffc0
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-5-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag005\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 5-35937@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6016 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 35, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 35, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 35, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 31, 36, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:45.984019Z[0m [32m INFO[0m ThreadId(07) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-5-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
Transaction loop starting for Key(z9hG4bK-35937-5-0:INVITE:server)
Initial state: Proceeding
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-35937-5-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
[2m2025-06-09T03:42:45.984237Z[0m [32m INFO[0m ThreadId(07) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog 1f20f687-d380-4914-96f6-d7d8f96ad065 from INVITE request
🔍 INVITE HANDLER: Created early dialog 1f20f687-d380-4914-96f6-d7d8f96ad065
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-35937-5-0:INVITE:server) with dialog 1f20f687-d380-4914-96f6-d7d8f96ad065
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog 1f20f687-d380-4914-96f6-d7d8f96ad065
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog 1f20f687-d380-4914-96f6-d7d8f96ad065
[2m2025-06-09T03:42:45.984314Z[0m [32m INFO[0m ThreadId(07) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog 1f20f687-d380-4914-96f6-d7d8f96ad065
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(1f20f687-d380-4914-96f6-d7d8f96ad065), transaction_id: z9hG4bK-35937-5-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-5-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag005")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("5-35937@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6016 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-09T03:42:45.984428Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m143:[0m Incoming call from dialog 1f20f687-d380-4914-96f6-d7d8f96ad065: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-09T03:42:45.984482Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m77:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-09T03:42:45.984495Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m78:[0m 📞 [SIPp-Test-Server] Call ID: sess_00a93a75-6f25-4980-b8cc-941e822f4e43
[2m2025-06-09T03:42:45.984510Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m89:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-09T03:42:45.984519Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m93:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating answer
[2m2025-06-09T03:42:45.984566Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m96:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-09T03:42:45.984596Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call 1f20f687-d380-4914-96f6-d7d8f96ad065
[2m2025-06-09T03:42:45.984756Z[0m [32m INFO[0m ThreadId(08) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-09T03:42:45.984846Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog 1f20f687-d380-4914-96f6-d7d8f96ad065 local tag set to match response: tag-59d14bce8b9b4dd19cd7ea70f8d0eb2f
[2m2025-06-09T03:42:45.984858Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog 1f20f687-d380-4914-96f6-d7d8f96ad065 transitioned to Confirmed state
[2m2025-06-09T03:42:45.984879Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog 1f20f687-d380-4914-96f6-d7d8f96ad065
[2m2025-06-09T03:42:45.984896Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call 1f20f687-d380-4914-96f6-d7d8f96ad065
[2m2025-06-09T03:42:45.984910Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m205:[0m Successfully answered incoming call for session sess_00a93a75-6f25-4980-b8cc-941e822f4e43
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(1f20f687-d380-4914-96f6-d7d8f96ad065), session_answer: "v=0\r\no=rvoip 1749440565 1749440565 IN IP4 127.0.0.1\r\ns=RVOIP Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0\r\na=rtpmap:0 PCMU/8000\r\na=sendrecv\r\n" }
[2m2025-06-09T03:42:45.984948Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m409:[0m Call answered for session sess_00a93a75-6f25-4980-b8cc-941e822f4e43: 1f20f687-d380-4914-96f6-d7d8f96ad065 (awaiting ACK per RFC 3261)
[2m2025-06-09T03:42:45.984970Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m423:[0m 📞 Call answered for session sess_00a93a75-6f25-4980-b8cc-941e822f4e43 - keeping in Initiating state until media ready
[2m2025-06-09T03:42:45.984979Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m426:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-35937-5-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-35937-5-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-35937-5-0:INVITE:server). Final state: Terminated
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-5-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag005\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-59d14bce8b9b4dd19cd7ea70f8d0eb2f\r\nCall-ID: 5-35937@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 35, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 35, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 35, 39, 64, 31, 34, 62, 63, 65, 38, 62, 39, 62, 34, 64, 64, 31, 39, 63, 64, 37, 65, 61, 37, 30, 66, 38, 64, 30, 65, 62, 32, 66, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 35, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 53, 57, 100, 49, 52, 98, 99, 101, 56, 98, 57, 98, 52, 100, 100, 49, 57, 99, 100, 55, 101, 97, 55, 48, 102, 56, 100, 48, 101, 98, 50, 102]
Successfully parsed tag: tag-59d14bce8b9b4dd19cd7ea70f8d0eb2f
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("35937SIPpTag005")})]), "uri": Object({"password": Null, "scheme": String("Sip"), "user": String("sipp"), "port": Number(5061.0), "parameters": Array([]), "host": Object({"Address": String("127.0.0.1")}), "headers": Object({}), "raw_uri": Null}), "display_name": String("SIPp Test")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag005")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag005")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag005")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"port": Number(5061.0), "scheme": String("Sip"), "headers": Object({}), "parameters": Array([]), "user": String("sipp"), "host": Object({"Address": String("127.0.0.1")}), "password": Null, "raw_uri": Null}), "params": Array([Object({"Tag": String("35937SIPpTag005")})]), "display_name": String("SIPp Test")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag005")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag005")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag005")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([]), "uri": Object({"raw_uri": Null, "user": String("test"), "parameters": Array([]), "scheme": String("Sip"), "host": Object({"Address": String("127.0.0.1")}), "password": Null, "port": Number(5062.0), "headers": Object({})}), "display_name": String("Test User")})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("tag-59d14bce8b9b4dd19cd7ea70f8d0eb2f")})]), "uri": Object({"parameters": Array([]), "headers": Object({}), "scheme": String("Sip"), "port": Number(5062.0), "password": Null, "raw_uri": Null, "host": Object({"Address": String("127.0.0.1")}), "user": String("test")}), "display_name": String("Test User")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-59d14bce8b9b4dd19cd7ea70f8d0eb2f")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-59d14bce8b9b4dd19cd7ea70f8d0eb2f")})
Final value for path 'headers.To.params[0].Tag': String("tag-59d14bce8b9b4dd19cd7ea70f8d0eb2f")
[2m2025-06-09T03:42:45.988793Z[0m [32m INFO[0m ThreadId(06) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-35937-5-0:INVITE:server) in dialog 1f20f687-d380-4914-96f6-d7d8f96ad065 - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(1f20f687-d380-4914-96f6-d7d8f96ad065), transaction_id: z9hG4bK-35937-5-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-09T03:42:45.988859Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m518:[0m ✅ RFC 3261: ACK RECEIVED for session sess_00a93a75-6f25-4980-b8cc-941e822f4e43 - creating media session (UAS side)
[2m2025-06-09T03:42:45.996136Z[0m [32m INFO[0m ThreadId(09) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-09T03:42:45.996248Z[0m [32m INFO[0m ThreadId(09) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=6931ceac
[2m2025-06-09T03:42:45.996322Z[0m [32m INFO[0m ThreadId(09) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m457:[0m ✅ Created media session with REAL RTP session: media-sess_925f9990-4e71-44e7-89f6-db2f80a7ffc0 (port: 10006)
[2m2025-06-09T03:42:45.996353Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m82:[0m ✅ Created media session: media-sess_925f9990-4e71-44e7-89f6-db2f80a7ffc0 for SIP session: sess_925f9990-4e71-44e7-89f6-db2f80a7ffc0 with real MediaSessionController
[2m2025-06-09T03:42:45.996368Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m215:[0m ✅ Successfully created RFC-compliant media session for sess_925f9990-4e71-44e7-89f6-db2f80a7ffc0
[2m2025-06-09T03:42:45.996422Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m119:[0m ✅ Updated media session for SIP session: sess_925f9990-4e71-44e7-89f6-db2f80a7ffc0 with remote: 127.0.0.1:10001 and codecs: ["PCMU"]
[2m2025-06-09T03:42:45.996438Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m224:[0m ✅ Applied stored remote SDP to new media session for sess_925f9990-4e71-44e7-89f6-db2f80a7ffc0
[2m2025-06-09T03:42:45.996461Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m239:[0m 🎉 Session sess_925f9990-4e71-44e7-89f6-db2f80a7ffc0 transitioned to Active in registry - media ready and session fully established!
[2m2025-06-09T03:42:45.996520Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m159:[0m 📄 Stored remote SDP answer for session sess_00a93a75-6f25-4980-b8cc-941e822f4e43
[2m2025-06-09T03:42:45.996544Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m206:[0m 🚀 RFC 3261: Creating media session after ACK for sess_00a93a75-6f25-4980-b8cc-941e822f4e43: rfc_compliant_media_creation_uas
[2m2025-06-09T03:42:45.996561Z[0m [32m INFO[0m ThreadId(09) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m377:[0m Starting media session for dialog: media-sess_00a93a75-6f25-4980-b8cc-941e822f4e43
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-6-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag006\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 6-35937@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6020 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 36, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 36, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 36, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 32, 30, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:46.482702Z[0m [32m INFO[0m ThreadId(08) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-6-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
Transaction loop starting for Key(z9hG4bK-35937-6-0:INVITE:server)
Initial state: Proceeding
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-35937-6-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
[2m2025-06-09T03:42:46.482920Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog b001f64a-202b-46a9-b17c-96ff9acfc971 from INVITE request
🔍 INVITE HANDLER: Created early dialog b001f64a-202b-46a9-b17c-96ff9acfc971
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-35937-6-0:INVITE:server) with dialog b001f64a-202b-46a9-b17c-96ff9acfc971
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog b001f64a-202b-46a9-b17c-96ff9acfc971
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog b001f64a-202b-46a9-b17c-96ff9acfc971
[2m2025-06-09T03:42:46.483001Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog b001f64a-202b-46a9-b17c-96ff9acfc971
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(b001f64a-202b-46a9-b17c-96ff9acfc971), transaction_id: z9hG4bK-35937-6-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-6-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag006")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("6-35937@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6020 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-09T03:42:46.483137Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m143:[0m Incoming call from dialog b001f64a-202b-46a9-b17c-96ff9acfc971: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-09T03:42:46.483206Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m77:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-09T03:42:46.483221Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m78:[0m 📞 [SIPp-Test-Server] Call ID: sess_e5ed18c4-be11-4e59-92c9-b71286d29a5a
[2m2025-06-09T03:42:46.483237Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m89:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-09T03:42:46.483248Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m93:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating answer
[2m2025-06-09T03:42:46.483317Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m96:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-09T03:42:46.483352Z[0m [32m INFO[0m ThreadId(06) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call b001f64a-202b-46a9-b17c-96ff9acfc971
[2m2025-06-09T03:42:46.483561Z[0m [32m INFO[0m ThreadId(06) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-09T03:42:46.483680Z[0m [32m INFO[0m ThreadId(06) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog b001f64a-202b-46a9-b17c-96ff9acfc971 local tag set to match response: tag-54255032098f44b8ac0ac3f5b4588be6
[2m2025-06-09T03:42:46.483697Z[0m [32m INFO[0m ThreadId(06) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog b001f64a-202b-46a9-b17c-96ff9acfc971 transitioned to Confirmed state
[2m2025-06-09T03:42:46.483723Z[0m [32m INFO[0m ThreadId(06) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog b001f64a-202b-46a9-b17c-96ff9acfc971
[2m2025-06-09T03:42:46.483744Z[0m [32m INFO[0m ThreadId(06) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call b001f64a-202b-46a9-b17c-96ff9acfc971
[2m2025-06-09T03:42:46.483763Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m205:[0m Successfully answered incoming call for session sess_e5ed18c4-be11-4e59-92c9-b71286d29a5a
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(b001f64a-202b-46a9-b17c-96ff9acfc971), session_answer: "v=0\r\no=rvoip 1749440566 1749440566 IN IP4 127.0.0.1\r\ns=RVOIP Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0\r\na=rtpmap:0 PCMU/8000\r\na=sendrecv\r\n" }
[2m2025-06-09T03:42:46.483809Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m409:[0m Call answered for session sess_e5ed18c4-be11-4e59-92c9-b71286d29a5a: b001f64a-202b-46a9-b17c-96ff9acfc971 (awaiting ACK per RFC 3261)
[2m2025-06-09T03:42:46.483832Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m423:[0m 📞 Call answered for session sess_e5ed18c4-be11-4e59-92c9-b71286d29a5a - keeping in Initiating state until media ready
[2m2025-06-09T03:42:46.483843Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m426:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-35937-6-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-35937-6-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-35937-6-0:INVITE:server). Final state: Terminated
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-6-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag006\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-54255032098f44b8ac0ac3f5b4588be6\r\nCall-ID: 6-35937@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 36, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 36, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 35, 34, 32, 35, 35, 30, 33, 32, 30, 39, 38, 66, 34, 34, 62, 38, 61, 63, 30, 61, 63, 33, 66, 35, 62, 34, 35, 38, 38, 62, 65, 36, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 36, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 53, 52, 50, 53, 53, 48, 51, 50, 48, 57, 56, 102, 52, 52, 98, 56, 97, 99, 48, 97, 99, 51, 102, 53, 98, 52, 53, 56, 56, 98, 101, 54]
Successfully parsed tag: tag-54255032098f44b8ac0ac3f5b4588be6
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("35937SIPpTag006")})]), "uri": Object({"port": Number(5061.0), "password": Null, "raw_uri": Null, "headers": Object({}), "user": String("sipp"), "scheme": String("Sip"), "parameters": Array([]), "host": Object({"Address": String("127.0.0.1")})}), "display_name": String("SIPp Test")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag006")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag006")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag006")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"password": Null, "host": Object({"Address": String("127.0.0.1")}), "parameters": Array([]), "raw_uri": Null, "user": String("sipp"), "scheme": String("Sip"), "headers": Object({}), "port": Number(5061.0)}), "display_name": String("SIPp Test"), "params": Array([Object({"Tag": String("35937SIPpTag006")})])})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag006")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag006")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag006")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([]), "uri": Object({"parameters": Array([]), "host": Object({"Address": String("127.0.0.1")}), "port": Number(5062.0), "raw_uri": Null, "headers": Object({}), "scheme": String("Sip"), "password": Null, "user": String("test")}), "display_name": String("Test User")})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "params": Array([Object({"Tag": String("tag-54255032098f44b8ac0ac3f5b4588be6")})]), "uri": Object({"scheme": String("Sip"), "raw_uri": Null, "parameters": Array([]), "password": Null, "port": Number(5062.0), "user": String("test"), "host": Object({"Address": String("127.0.0.1")}), "headers": Object({})})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-54255032098f44b8ac0ac3f5b4588be6")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-54255032098f44b8ac0ac3f5b4588be6")})
Final value for path 'headers.To.params[0].Tag': String("tag-54255032098f44b8ac0ac3f5b4588be6")
[2m2025-06-09T03:42:46.487697Z[0m [32m INFO[0m ThreadId(06) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-35937-6-0:INVITE:server) in dialog b001f64a-202b-46a9-b17c-96ff9acfc971 - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(b001f64a-202b-46a9-b17c-96ff9acfc971), transaction_id: z9hG4bK-35937-6-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-09T03:42:46.487745Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m518:[0m ✅ RFC 3261: ACK RECEIVED for session sess_e5ed18c4-be11-4e59-92c9-b71286d29a5a - creating media session (UAS side)
[2m2025-06-09T03:42:46.498355Z[0m [32m INFO[0m ThreadId(07) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-09T03:42:46.498444Z[0m [32m INFO[0m ThreadId(07) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=e4e17b32
[2m2025-06-09T03:42:46.498486Z[0m [32m INFO[0m ThreadId(07) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m457:[0m ✅ Created media session with REAL RTP session: media-sess_00a93a75-6f25-4980-b8cc-941e822f4e43 (port: 10008)
[2m2025-06-09T03:42:46.498513Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m82:[0m ✅ Created media session: media-sess_00a93a75-6f25-4980-b8cc-941e822f4e43 for SIP session: sess_00a93a75-6f25-4980-b8cc-941e822f4e43 with real MediaSessionController
[2m2025-06-09T03:42:46.498529Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m215:[0m ✅ Successfully created RFC-compliant media session for sess_00a93a75-6f25-4980-b8cc-941e822f4e43
[2m2025-06-09T03:42:46.498583Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m119:[0m ✅ Updated media session for SIP session: sess_00a93a75-6f25-4980-b8cc-941e822f4e43 with remote: 127.0.0.1:10001 and codecs: ["PCMU"]
[2m2025-06-09T03:42:46.498599Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m224:[0m ✅ Applied stored remote SDP to new media session for sess_00a93a75-6f25-4980-b8cc-941e822f4e43
[2m2025-06-09T03:42:46.498622Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m239:[0m 🎉 Session sess_00a93a75-6f25-4980-b8cc-941e822f4e43 transitioned to Active in registry - media ready and session fully established!
[2m2025-06-09T03:42:46.498681Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m159:[0m 📄 Stored remote SDP answer for session sess_e5ed18c4-be11-4e59-92c9-b71286d29a5a
[2m2025-06-09T03:42:46.498703Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m206:[0m 🚀 RFC 3261: Creating media session after ACK for sess_e5ed18c4-be11-4e59-92c9-b71286d29a5a: rfc_compliant_media_creation_uas
[2m2025-06-09T03:42:46.498720Z[0m [32m INFO[0m ThreadId(07) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m377:[0m Starting media session for dialog: media-sess_e5ed18c4-be11-4e59-92c9-b71286d29a5a
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-7-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag007\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 7-35937@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6024 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 37, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 37, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 37, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 32, 34, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:46.985497Z[0m [32m INFO[0m ThreadId(09) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-7-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
Transaction loop starting for Key(z9hG4bK-35937-7-0:INVITE:server)
Initial state: Proceeding
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-35937-7-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
[2m2025-06-09T03:42:46.985753Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog d989becc-9ca9-42ae-99ba-c8d8918fde8c from INVITE request
🔍 INVITE HANDLER: Created early dialog d989becc-9ca9-42ae-99ba-c8d8918fde8c
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-35937-7-0:INVITE:server) with dialog d989becc-9ca9-42ae-99ba-c8d8918fde8c
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog d989becc-9ca9-42ae-99ba-c8d8918fde8c
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog d989becc-9ca9-42ae-99ba-c8d8918fde8c
[2m2025-06-09T03:42:46.985916Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog d989becc-9ca9-42ae-99ba-c8d8918fde8c
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(d989becc-9ca9-42ae-99ba-c8d8918fde8c), transaction_id: z9hG4bK-35937-7-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-7-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag007")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("7-35937@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6024 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-09T03:42:46.986088Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m143:[0m Incoming call from dialog d989becc-9ca9-42ae-99ba-c8d8918fde8c: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-09T03:42:46.986165Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m77:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-09T03:42:46.986183Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m78:[0m 📞 [SIPp-Test-Server] Call ID: sess_940ae187-a3af-430d-b429-3bae84e3b713
[2m2025-06-09T03:42:46.986202Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m89:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-09T03:42:46.986215Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m93:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating answer
[2m2025-06-09T03:42:46.986272Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m96:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-09T03:42:46.986307Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call d989becc-9ca9-42ae-99ba-c8d8918fde8c
[2m2025-06-09T03:42:46.986510Z[0m [32m INFO[0m ThreadId(08) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-09T03:42:46.986614Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog d989becc-9ca9-42ae-99ba-c8d8918fde8c local tag set to match response: tag-f4ebede0d6854ae7b3ae560192bb9a8d
[2m2025-06-09T03:42:46.986627Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog d989becc-9ca9-42ae-99ba-c8d8918fde8c transitioned to Confirmed state
[2m2025-06-09T03:42:46.986651Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog d989becc-9ca9-42ae-99ba-c8d8918fde8c
[2m2025-06-09T03:42:46.986671Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call d989becc-9ca9-42ae-99ba-c8d8918fde8c
[2m2025-06-09T03:42:46.986686Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m205:[0m Successfully answered incoming call for session sess_940ae187-a3af-430d-b429-3bae84e3b713
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(d989becc-9ca9-42ae-99ba-c8d8918fde8c), session_answer: "v=0\r\no=rvoip 1749440566 1749440566 IN IP4 127.0.0.1\r\ns=RVOIP Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0\r\na=rtpmap:0 PCMU/8000\r\na=sendrecv\r\n" }
[2m2025-06-09T03:42:46.986727Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m409:[0m Call answered for session sess_940ae187-a3af-430d-b429-3bae84e3b713: d989becc-9ca9-42ae-99ba-c8d8918fde8c (awaiting ACK per RFC 3261)
[2m2025-06-09T03:42:46.986748Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m423:[0m 📞 Call answered for session sess_940ae187-a3af-430d-b429-3bae84e3b713 - keeping in Initiating state until media ready
[2m2025-06-09T03:42:46.986760Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m426:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-35937-7-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-35937-7-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-35937-7-0:INVITE:server). Final state: Terminated
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-7-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag007\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-f4ebede0d6854ae7b3ae560192bb9a8d\r\nCall-ID: 7-35937@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 37, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 37, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 66, 34, 65, 62, 65, 64, 65, 30, 64, 36, 38, 35, 34, 61, 65, 37, 62, 33, 61, 65, 35, 36, 30, 31, 39, 32, 62, 62, 39, 61, 38, 64, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 37, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 102, 52, 101, 98, 101, 100, 101, 48, 100, 54, 56, 53, 52, 97, 101, 55, 98, 51, 97, 101, 53, 54, 48, 49, 57, 50, 98, 98, 57, 97, 56, 100]
Successfully parsed tag: tag-f4ebede0d6854ae7b3ae560192bb9a8d
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("35937SIPpTag007")})]), "display_name": String("SIPp Test"), "uri": Object({"user": String("sipp"), "headers": Object({}), "parameters": Array([]), "host": Object({"Address": String("127.0.0.1")}), "password": Null, "port": Number(5061.0), "raw_uri": Null, "scheme": String("Sip")})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag007")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag007")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag007")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("35937SIPpTag007")})]), "display_name": String("SIPp Test"), "uri": Object({"raw_uri": Null, "port": Number(5061.0), "user": String("sipp"), "host": Object({"Address": String("127.0.0.1")}), "parameters": Array([]), "scheme": String("Sip"), "headers": Object({}), "password": Null})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag007")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag007")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag007")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "uri": Object({"password": Null, "port": Number(5062.0), "scheme": String("Sip"), "host": Object({"Address": String("127.0.0.1")}), "raw_uri": Null, "user": String("test"), "parameters": Array([]), "headers": Object({})}), "params": Array([])})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "params": Array([Object({"Tag": String("tag-f4ebede0d6854ae7b3ae560192bb9a8d")})]), "uri": Object({"parameters": Array([]), "password": Null, "port": Number(5062.0), "scheme": String("Sip"), "host": Object({"Address": String("127.0.0.1")}), "headers": Object({}), "raw_uri": Null, "user": String("test")})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-f4ebede0d6854ae7b3ae560192bb9a8d")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-f4ebede0d6854ae7b3ae560192bb9a8d")})
Final value for path 'headers.To.params[0].Tag': String("tag-f4ebede0d6854ae7b3ae560192bb9a8d")
[2m2025-06-09T03:42:46.990692Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-35937-7-0:INVITE:server) in dialog d989becc-9ca9-42ae-99ba-c8d8918fde8c - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(d989becc-9ca9-42ae-99ba-c8d8918fde8c), transaction_id: z9hG4bK-35937-7-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-09T03:42:46.990747Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m518:[0m ✅ RFC 3261: ACK RECEIVED for session sess_940ae187-a3af-430d-b429-3bae84e3b713 - creating media session (UAS side)
[2m2025-06-09T03:42:47.000311Z[0m [32m INFO[0m ThreadId(11) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-09T03:42:47.000406Z[0m [32m INFO[0m ThreadId(11) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=04589a6f
[2m2025-06-09T03:42:47.000440Z[0m [32m INFO[0m ThreadId(11) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m457:[0m ✅ Created media session with REAL RTP session: media-sess_e5ed18c4-be11-4e59-92c9-b71286d29a5a (port: 10010)
[2m2025-06-09T03:42:47.000466Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m82:[0m ✅ Created media session: media-sess_e5ed18c4-be11-4e59-92c9-b71286d29a5a for SIP session: sess_e5ed18c4-be11-4e59-92c9-b71286d29a5a with real MediaSessionController
[2m2025-06-09T03:42:47.000480Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m215:[0m ✅ Successfully created RFC-compliant media session for sess_e5ed18c4-be11-4e59-92c9-b71286d29a5a
[2m2025-06-09T03:42:47.000531Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m119:[0m ✅ Updated media session for SIP session: sess_e5ed18c4-be11-4e59-92c9-b71286d29a5a with remote: 127.0.0.1:10001 and codecs: ["PCMU"]
[2m2025-06-09T03:42:47.000545Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m224:[0m ✅ Applied stored remote SDP to new media session for sess_e5ed18c4-be11-4e59-92c9-b71286d29a5a
[2m2025-06-09T03:42:47.000576Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m239:[0m 🎉 Session sess_e5ed18c4-be11-4e59-92c9-b71286d29a5a transitioned to Active in registry - media ready and session fully established!
[2m2025-06-09T03:42:47.000631Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m159:[0m 📄 Stored remote SDP answer for session sess_940ae187-a3af-430d-b429-3bae84e3b713
[2m2025-06-09T03:42:47.000652Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m206:[0m 🚀 RFC 3261: Creating media session after ACK for sess_940ae187-a3af-430d-b429-3bae84e3b713: rfc_compliant_media_creation_uas
[2m2025-06-09T03:42:47.000668Z[0m [32m INFO[0m ThreadId(11) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m377:[0m Starting media session for dialog: media-sess_940ae187-a3af-430d-b429-3bae84e3b713
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-8-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag008\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 8-35937@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6028 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 38, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 38, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 38, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 32, 38, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:47.481761Z[0m [32m INFO[0m ThreadId(11) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-8-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
Transaction loop starting for Key(z9hG4bK-35937-8-0:INVITE:server)
Initial state: Proceeding
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-35937-8-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
[2m2025-06-09T03:42:47.481993Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog 379f0552-0624-403b-aebe-031764808974 from INVITE request
🔍 INVITE HANDLER: Created early dialog 379f0552-0624-403b-aebe-031764808974
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-35937-8-0:INVITE:server) with dialog 379f0552-0624-403b-aebe-031764808974
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog 379f0552-0624-403b-aebe-031764808974
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog 379f0552-0624-403b-aebe-031764808974
[2m2025-06-09T03:42:47.482072Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog 379f0552-0624-403b-aebe-031764808974
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(379f0552-0624-403b-aebe-031764808974), transaction_id: z9hG4bK-35937-8-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-8-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag008")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("8-35937@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6028 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-09T03:42:47.482185Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m143:[0m Incoming call from dialog 379f0552-0624-403b-aebe-031764808974: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-09T03:42:47.482254Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m77:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-09T03:42:47.482270Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m78:[0m 📞 [SIPp-Test-Server] Call ID: sess_9eb34110-d383-4907-a0c1-ee9a6e7f1a20
[2m2025-06-09T03:42:47.482286Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m89:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-09T03:42:47.482297Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m93:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating answer
[2m2025-06-09T03:42:47.482353Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m96:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-09T03:42:47.482387Z[0m [32m INFO[0m ThreadId(06) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call 379f0552-0624-403b-aebe-031764808974
[2m2025-06-09T03:42:47.482558Z[0m [32m INFO[0m ThreadId(06) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-09T03:42:47.482636Z[0m [32m INFO[0m ThreadId(06) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog 379f0552-0624-403b-aebe-031764808974 local tag set to match response: tag-f7ec12e9c19947dda61af7c061bc4f3c
[2m2025-06-09T03:42:47.482650Z[0m [32m INFO[0m ThreadId(06) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog 379f0552-0624-403b-aebe-031764808974 transitioned to Confirmed state
[2m2025-06-09T03:42:47.482674Z[0m [32m INFO[0m ThreadId(06) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog 379f0552-0624-403b-aebe-031764808974
[2m2025-06-09T03:42:47.482694Z[0m [32m INFO[0m ThreadId(06) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call 379f0552-0624-403b-aebe-031764808974
[2m2025-06-09T03:42:47.482710Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m205:[0m Successfully answered incoming call for session sess_9eb34110-d383-4907-a0c1-ee9a6e7f1a20
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(379f0552-0624-403b-aebe-031764808974), session_answer: "v=0\r\no=rvoip 1749440567 1749440567 IN IP4 127.0.0.1\r\ns=RVOIP Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0\r\na=rtpmap:0 PCMU/8000\r\na=sendrecv\r\n" }
[2m2025-06-09T03:42:47.482752Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m409:[0m Call answered for session sess_9eb34110-d383-4907-a0c1-ee9a6e7f1a20: 379f0552-0624-403b-aebe-031764808974 (awaiting ACK per RFC 3261)
[2m2025-06-09T03:42:47.482775Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m423:[0m 📞 Call answered for session sess_9eb34110-d383-4907-a0c1-ee9a6e7f1a20 - keeping in Initiating state until media ready
[2m2025-06-09T03:42:47.482785Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m426:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-35937-8-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-35937-8-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-35937-8-0:INVITE:server). Final state: Terminated
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-8-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag008\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-f7ec12e9c19947dda61af7c061bc4f3c\r\nCall-ID: 8-35937@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 38, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 38, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 66, 37, 65, 63, 31, 32, 65, 39, 63, 31, 39, 39, 34, 37, 64, 64, 61, 36, 31, 61, 66, 37, 63, 30, 36, 31, 62, 63, 34, 66, 33, 63, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 38, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 102, 55, 101, 99, 49, 50, 101, 57, 99, 49, 57, 57, 52, 55, 100, 100, 97, 54, 49, 97, 102, 55, 99, 48, 54, 49, 98, 99, 52, 102, 51, 99]
Successfully parsed tag: tag-f7ec12e9c19947dda61af7c061bc4f3c
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("35937SIPpTag008")})]), "uri": Object({"user": String("sipp"), "headers": Object({}), "parameters": Array([]), "raw_uri": Null, "host": Object({"Address": String("127.0.0.1")}), "password": Null, "scheme": String("Sip"), "port": Number(5061.0)}), "display_name": String("SIPp Test")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag008")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag008")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag008")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("35937SIPpTag008")})]), "display_name": String("SIPp Test"), "uri": Object({"raw_uri": Null, "scheme": String("Sip"), "user": String("sipp"), "host": Object({"Address": String("127.0.0.1")}), "parameters": Array([]), "headers": Object({}), "password": Null, "port": Number(5061.0)})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag008")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag008")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag008")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "params": Array([]), "uri": Object({"raw_uri": Null, "headers": Object({}), "password": Null, "user": String("test"), "port": Number(5062.0), "parameters": Array([]), "host": Object({"Address": String("127.0.0.1")}), "scheme": String("Sip")})})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "params": Array([Object({"Tag": String("tag-f7ec12e9c19947dda61af7c061bc4f3c")})]), "uri": Object({"host": Object({"Address": String("127.0.0.1")}), "password": Null, "port": Number(5062.0), "scheme": String("Sip"), "headers": Object({}), "raw_uri": Null, "parameters": Array([]), "user": String("test")})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-f7ec12e9c19947dda61af7c061bc4f3c")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-f7ec12e9c19947dda61af7c061bc4f3c")})
Final value for path 'headers.To.params[0].Tag': String("tag-f7ec12e9c19947dda61af7c061bc4f3c")
[2m2025-06-09T03:42:47.486775Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-35937-8-0:INVITE:server) in dialog 379f0552-0624-403b-aebe-031764808974 - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(379f0552-0624-403b-aebe-031764808974), transaction_id: z9hG4bK-35937-8-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-09T03:42:47.486858Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m518:[0m ✅ RFC 3261: ACK RECEIVED for session sess_9eb34110-d383-4907-a0c1-ee9a6e7f1a20 - creating media session (UAS side)
[2m2025-06-09T03:42:47.502245Z[0m [32m INFO[0m ThreadId(08) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-09T03:42:47.502337Z[0m [32m INFO[0m ThreadId(08) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=ff382077
[2m2025-06-09T03:42:47.502380Z[0m [32m INFO[0m ThreadId(08) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m457:[0m ✅ Created media session with REAL RTP session: media-sess_940ae187-a3af-430d-b429-3bae84e3b713 (port: 10012)
[2m2025-06-09T03:42:47.502408Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m82:[0m ✅ Created media session: media-sess_940ae187-a3af-430d-b429-3bae84e3b713 for SIP session: sess_940ae187-a3af-430d-b429-3bae84e3b713 with real MediaSessionController
[2m2025-06-09T03:42:47.502423Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m215:[0m ✅ Successfully created RFC-compliant media session for sess_940ae187-a3af-430d-b429-3bae84e3b713
[2m2025-06-09T03:42:47.502475Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m119:[0m ✅ Updated media session for SIP session: sess_940ae187-a3af-430d-b429-3bae84e3b713 with remote: 127.0.0.1:10001 and codecs: ["PCMU"]
[2m2025-06-09T03:42:47.502490Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m224:[0m ✅ Applied stored remote SDP to new media session for sess_940ae187-a3af-430d-b429-3bae84e3b713
[2m2025-06-09T03:42:47.502511Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m239:[0m 🎉 Session sess_940ae187-a3af-430d-b429-3bae84e3b713 transitioned to Active in registry - media ready and session fully established!
[2m2025-06-09T03:42:47.502570Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m159:[0m 📄 Stored remote SDP answer for session sess_9eb34110-d383-4907-a0c1-ee9a6e7f1a20
[2m2025-06-09T03:42:47.502592Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m206:[0m 🚀 RFC 3261: Creating media session after ACK for sess_9eb34110-d383-4907-a0c1-ee9a6e7f1a20: rfc_compliant_media_creation_uas
[2m2025-06-09T03:42:47.502609Z[0m [32m INFO[0m ThreadId(08) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m377:[0m Starting media session for dialog: media-sess_9eb34110-d383-4907-a0c1-ee9a6e7f1a20
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-9-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag009\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 9-35937@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6032 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 39, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 39, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 39, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 33, 32, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:47.980514Z[0m [32m INFO[0m ThreadId(11) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-9-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
Transaction loop starting for Key(z9hG4bK-35937-9-0:INVITE:server)
Initial state: Proceeding
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-35937-9-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
[2m2025-06-09T03:42:47.980699Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog 74c92869-da9b-4a57-a130-64da8b44ae39 from INVITE request
🔍 INVITE HANDLER: Created early dialog 74c92869-da9b-4a57-a130-64da8b44ae39
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-35937-9-0:INVITE:server) with dialog 74c92869-da9b-4a57-a130-64da8b44ae39
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog 74c92869-da9b-4a57-a130-64da8b44ae39
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog 74c92869-da9b-4a57-a130-64da8b44ae39
[2m2025-06-09T03:42:47.980760Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog 74c92869-da9b-4a57-a130-64da8b44ae39
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(74c92869-da9b-4a57-a130-64da8b44ae39), transaction_id: z9hG4bK-35937-9-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-9-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag009")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("9-35937@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6032 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-09T03:42:47.980855Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m143:[0m Incoming call from dialog 74c92869-da9b-4a57-a130-64da8b44ae39: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-09T03:42:47.980916Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m77:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-09T03:42:47.980928Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m78:[0m 📞 [SIPp-Test-Server] Call ID: sess_562cd264-60c3-4afc-94da-9eb7d001e2c9
[2m2025-06-09T03:42:47.980940Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m89:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-09T03:42:47.980949Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m93:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating answer
[2m2025-06-09T03:42:47.980998Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m96:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-09T03:42:47.981026Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call 74c92869-da9b-4a57-a130-64da8b44ae39
[2m2025-06-09T03:42:47.981169Z[0m [32m INFO[0m ThreadId(09) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-09T03:42:47.981225Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog 74c92869-da9b-4a57-a130-64da8b44ae39 local tag set to match response: tag-260e76f54ea04bedad71e25bf1844ae7
[2m2025-06-09T03:42:47.981235Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog 74c92869-da9b-4a57-a130-64da8b44ae39 transitioned to Confirmed state
[2m2025-06-09T03:42:47.981253Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog 74c92869-da9b-4a57-a130-64da8b44ae39
[2m2025-06-09T03:42:47.981267Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call 74c92869-da9b-4a57-a130-64da8b44ae39
[2m2025-06-09T03:42:47.981278Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m205:[0m Successfully answered incoming call for session sess_562cd264-60c3-4afc-94da-9eb7d001e2c9
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(74c92869-da9b-4a57-a130-64da8b44ae39), session_answer: "v=0\r\no=rvoip 1749440567 1749440567 IN IP4 127.0.0.1\r\ns=RVOIP Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0\r\na=rtpmap:0 PCMU/8000\r\na=sendrecv\r\n" }
[2m2025-06-09T03:42:47.981314Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m409:[0m Call answered for session sess_562cd264-60c3-4afc-94da-9eb7d001e2c9: 74c92869-da9b-4a57-a130-64da8b44ae39 (awaiting ACK per RFC 3261)
[2m2025-06-09T03:42:47.981333Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m423:[0m 📞 Call answered for session sess_562cd264-60c3-4afc-94da-9eb7d001e2c9 - keeping in Initiating state until media ready
[2m2025-06-09T03:42:47.981340Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m426:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-35937-9-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-35937-9-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-35937-9-0:INVITE:server). Final state: Terminated
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-9-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag009\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-260e76f54ea04bedad71e25bf1844ae7\r\nCall-ID: 9-35937@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 39, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 39, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 32, 36, 30, 65, 37, 36, 66, 35, 34, 65, 61, 30, 34, 62, 65, 64, 61, 64, 37, 31, 65, 32, 35, 62, 66, 31, 38, 34, 34, 61, 65, 37, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 39, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 50, 54, 48, 101, 55, 54, 102, 53, 52, 101, 97, 48, 52, 98, 101, 100, 97, 100, 55, 49, 101, 50, 53, 98, 102, 49, 56, 52, 52, 97, 101, 55]
Successfully parsed tag: tag-260e76f54ea04bedad71e25bf1844ae7
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("35937SIPpTag009")})]), "uri": Object({"port": Number(5061.0), "host": Object({"Address": String("127.0.0.1")}), "raw_uri": Null, "password": Null, "user": String("sipp"), "parameters": Array([]), "scheme": String("Sip"), "headers": Object({})}), "display_name": String("SIPp Test")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag009")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag009")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag009")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"password": Null, "scheme": String("Sip"), "parameters": Array([]), "user": String("sipp"), "port": Number(5061.0), "host": Object({"Address": String("127.0.0.1")}), "headers": Object({}), "raw_uri": Null}), "params": Array([Object({"Tag": String("35937SIPpTag009")})]), "display_name": String("SIPp Test")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag009")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag009")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag009")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"scheme": String("Sip"), "raw_uri": Null, "parameters": Array([]), "port": Number(5062.0), "user": String("test"), "headers": Object({}), "host": Object({"Address": String("127.0.0.1")}), "password": Null}), "display_name": String("Test User"), "params": Array([])})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"port": Number(5062.0), "host": Object({"Address": String("127.0.0.1")}), "headers": Object({}), "parameters": Array([]), "password": Null, "raw_uri": Null, "scheme": String("Sip"), "user": String("test")}), "display_name": String("Test User"), "params": Array([Object({"Tag": String("tag-260e76f54ea04bedad71e25bf1844ae7")})])})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-260e76f54ea04bedad71e25bf1844ae7")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-260e76f54ea04bedad71e25bf1844ae7")})
Final value for path 'headers.To.params[0].Tag': String("tag-260e76f54ea04bedad71e25bf1844ae7")
[2m2025-06-09T03:42:47.984207Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-35937-9-0:INVITE:server) in dialog 74c92869-da9b-4a57-a130-64da8b44ae39 - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(74c92869-da9b-4a57-a130-64da8b44ae39), transaction_id: z9hG4bK-35937-9-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-09T03:42:47.984248Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m518:[0m ✅ RFC 3261: ACK RECEIVED for session sess_562cd264-60c3-4afc-94da-9eb7d001e2c9 - creating media session (UAS side)
[2m2025-06-09T03:42:48.004178Z[0m [32m INFO[0m ThreadId(09) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-09T03:42:48.004271Z[0m [32m INFO[0m ThreadId(09) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=ada0ea11
[2m2025-06-09T03:42:48.004340Z[0m [32m INFO[0m ThreadId(09) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m457:[0m ✅ Created media session with REAL RTP session: media-sess_9eb34110-d383-4907-a0c1-ee9a6e7f1a20 (port: 10014)
[2m2025-06-09T03:42:48.004372Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m82:[0m ✅ Created media session: media-sess_9eb34110-d383-4907-a0c1-ee9a6e7f1a20 for SIP session: sess_9eb34110-d383-4907-a0c1-ee9a6e7f1a20 with real MediaSessionController
[2m2025-06-09T03:42:48.004385Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m215:[0m ✅ Successfully created RFC-compliant media session for sess_9eb34110-d383-4907-a0c1-ee9a6e7f1a20
[2m2025-06-09T03:42:48.004441Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m119:[0m ✅ Updated media session for SIP session: sess_9eb34110-d383-4907-a0c1-ee9a6e7f1a20 with remote: 127.0.0.1:10001 and codecs: ["PCMU"]
[2m2025-06-09T03:42:48.004456Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m224:[0m ✅ Applied stored remote SDP to new media session for sess_9eb34110-d383-4907-a0c1-ee9a6e7f1a20
[2m2025-06-09T03:42:48.004476Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m239:[0m 🎉 Session sess_9eb34110-d383-4907-a0c1-ee9a6e7f1a20 transitioned to Active in registry - media ready and session fully established!
[2m2025-06-09T03:42:48.004533Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m159:[0m 📄 Stored remote SDP answer for session sess_562cd264-60c3-4afc-94da-9eb7d001e2c9
[2m2025-06-09T03:42:48.004551Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m206:[0m 🚀 RFC 3261: Creating media session after ACK for sess_562cd264-60c3-4afc-94da-9eb7d001e2c9: rfc_compliant_media_creation_uas
[2m2025-06-09T03:42:48.004565Z[0m [32m INFO[0m ThreadId(09) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m377:[0m Starting media session for dialog: media-sess_562cd264-60c3-4afc-94da-9eb7d001e2c9
=== PARSING SIP MESSAGE ===
Input length: 593 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-10-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag0010\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 10-35937@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6036 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 31, 30, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 31, 30, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 31, 30, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 33, 36, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:48.480516Z[0m [32m INFO[0m ThreadId(09) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-10-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
Transaction loop starting for Key(z9hG4bK-35937-10-0:INVITE:server)
Initial state: Proceeding
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-35937-10-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
[2m2025-06-09T03:42:48.480951Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog 6d73546e-8722-453b-89d7-7b24cbcb12ed from INVITE request
🔍 INVITE HANDLER: Created early dialog 6d73546e-8722-453b-89d7-7b24cbcb12ed
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-35937-10-0:INVITE:server) with dialog 6d73546e-8722-453b-89d7-7b24cbcb12ed
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog 6d73546e-8722-453b-89d7-7b24cbcb12ed
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog 6d73546e-8722-453b-89d7-7b24cbcb12ed
[2m2025-06-09T03:42:48.481097Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog 6d73546e-8722-453b-89d7-7b24cbcb12ed
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(6d73546e-8722-453b-89d7-7b24cbcb12ed), transaction_id: z9hG4bK-35937-10-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-10-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag0010")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("10-35937@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6036 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-09T03:42:48.481275Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m143:[0m Incoming call from dialog 6d73546e-8722-453b-89d7-7b24cbcb12ed: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-09T03:42:48.481356Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m77:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-09T03:42:48.481373Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m78:[0m 📞 [SIPp-Test-Server] Call ID: sess_149471e6-e42b-499f-9567-ae43ca403f43
[2m2025-06-09T03:42:48.481389Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m89:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-09T03:42:48.481401Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m93:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating answer
[2m2025-06-09T03:42:48.481469Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m96:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-09T03:42:48.481504Z[0m [32m INFO[0m ThreadId(07) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call 6d73546e-8722-453b-89d7-7b24cbcb12ed
[2m2025-06-09T03:42:48.481715Z[0m [32m INFO[0m ThreadId(07) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-09T03:42:48.481832Z[0m [32m INFO[0m ThreadId(07) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog 6d73546e-8722-453b-89d7-7b24cbcb12ed local tag set to match response: tag-0006b5a794ca48f4b4c30e82647b42aa
[2m2025-06-09T03:42:48.481845Z[0m [32m INFO[0m ThreadId(07) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog 6d73546e-8722-453b-89d7-7b24cbcb12ed transitioned to Confirmed state
[2m2025-06-09T03:42:48.481867Z[0m [32m INFO[0m ThreadId(07) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog 6d73546e-8722-453b-89d7-7b24cbcb12ed
[2m2025-06-09T03:42:48.481884Z[0m [32m INFO[0m ThreadId(07) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call 6d73546e-8722-453b-89d7-7b24cbcb12ed
[2m2025-06-09T03:42:48.481898Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m205:[0m Successfully answered incoming call for session sess_149471e6-e42b-499f-9567-ae43ca403f43
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(6d73546e-8722-453b-89d7-7b24cbcb12ed), session_answer: "v=0\r\no=rvoip 1749440568 1749440568 IN IP4 127.0.0.1\r\ns=RVOIP Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0\r\na=rtpmap:0 PCMU/8000\r\na=sendrecv\r\n" }
[2m2025-06-09T03:42:48.481941Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m409:[0m Call answered for session sess_149471e6-e42b-499f-9567-ae43ca403f43: 6d73546e-8722-453b-89d7-7b24cbcb12ed (awaiting ACK per RFC 3261)
[2m2025-06-09T03:42:48.481961Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m423:[0m 📞 Call answered for session sess_149471e6-e42b-499f-9567-ae43ca403f43 - keeping in Initiating state until media ready
[2m2025-06-09T03:42:48.481998Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m426:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-35937-10-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-35937-10-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-35937-10-0:INVITE:server). Final state: Terminated
=== PARSING SIP MESSAGE ===
Input length: 412 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-10-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag0010\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-0006b5a794ca48f4b4c30e82647b42aa\r\nCall-ID: 10-35937@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 31, 30, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 31, 30, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 30, 30, 30, 36, 62, 35, 61, 37, 39, 34, 63, 61, 34, 38, 66, 34, 62, 34, 63, 33, 30, 65, 38, 32, 36, 34, 37, 62, 34, 32, 61, 61, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 31, 30, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 48, 48, 48, 54, 98, 53, 97, 55, 57, 52, 99, 97, 52, 56, 102, 52, 98, 52, 99, 51, 48, 101, 56, 50, 54, 52, 55, 98, 52, 50, 97, 97]
Successfully parsed tag: tag-0006b5a794ca48f4b4c30e82647b42aa
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("SIPp Test"), "params": Array([Object({"Tag": String("35937SIPpTag0010")})]), "uri": Object({"scheme": String("Sip"), "parameters": Array([]), "password": Null, "user": String("sipp"), "headers": Object({}), "raw_uri": Null, "port": Number(5061.0), "host": Object({"Address": String("127.0.0.1")})})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag0010")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag0010")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag0010")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("SIPp Test"), "params": Array([Object({"Tag": String("35937SIPpTag0010")})]), "uri": Object({"password": Null, "parameters": Array([]), "port": Number(5061.0), "raw_uri": Null, "user": String("sipp"), "scheme": String("Sip"), "headers": Object({}), "host": Object({"Address": String("127.0.0.1")})})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("35937SIPpTag0010")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("35937SIPpTag0010")})
Final value for path 'headers.From.params[0].Tag': String("35937SIPpTag0010")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "params": Array([]), "uri": Object({"headers": Object({}), "parameters": Array([]), "port": Number(5062.0), "user": String("test"), "host": Object({"Address": String("127.0.0.1")}), "scheme": String("Sip"), "raw_uri": Null, "password": Null})})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("tag-0006b5a794ca48f4b4c30e82647b42aa")})]), "display_name": String("Test User"), "uri": Object({"headers": Object({}), "host": Object({"Address": String("127.0.0.1")}), "port": Number(5062.0), "parameters": Array([]), "password": Null, "raw_uri": Null, "scheme": String("Sip"), "user": String("test")})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-0006b5a794ca48f4b4c30e82647b42aa")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-0006b5a794ca48f4b4c30e82647b42aa")})
Final value for path 'headers.To.params[0].Tag': String("tag-0006b5a794ca48f4b4c30e82647b42aa")
[2m2025-06-09T03:42:48.485948Z[0m [32m INFO[0m ThreadId(06) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-35937-10-0:INVITE:server) in dialog 6d73546e-8722-453b-89d7-7b24cbcb12ed - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(6d73546e-8722-453b-89d7-7b24cbcb12ed), transaction_id: z9hG4bK-35937-10-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-09T03:42:48.486034Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m518:[0m ✅ RFC 3261: ACK RECEIVED for session sess_149471e6-e42b-499f-9567-ae43ca403f43 - creating media session (UAS side)
[2m2025-06-09T03:42:48.506613Z[0m [32m INFO[0m ThreadId(09) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-09T03:42:48.506710Z[0m [32m INFO[0m ThreadId(09) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=e2773f08
[2m2025-06-09T03:42:48.506752Z[0m [32m INFO[0m ThreadId(09) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m457:[0m ✅ Created media session with REAL RTP session: media-sess_562cd264-60c3-4afc-94da-9eb7d001e2c9 (port: 10016)
[2m2025-06-09T03:42:48.506781Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m82:[0m ✅ Created media session: media-sess_562cd264-60c3-4afc-94da-9eb7d001e2c9 for SIP session: sess_562cd264-60c3-4afc-94da-9eb7d001e2c9 with real MediaSessionController
[2m2025-06-09T03:42:48.506795Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m215:[0m ✅ Successfully created RFC-compliant media session for sess_562cd264-60c3-4afc-94da-9eb7d001e2c9
[2m2025-06-09T03:42:48.506848Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m119:[0m ✅ Updated media session for SIP session: sess_562cd264-60c3-4afc-94da-9eb7d001e2c9 with remote: 127.0.0.1:10001 and codecs: ["PCMU"]
[2m2025-06-09T03:42:48.506863Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m224:[0m ✅ Applied stored remote SDP to new media session for sess_562cd264-60c3-4afc-94da-9eb7d001e2c9
[2m2025-06-09T03:42:48.506885Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m239:[0m 🎉 Session sess_562cd264-60c3-4afc-94da-9eb7d001e2c9 transitioned to Active in registry - media ready and session fully established!
[2m2025-06-09T03:42:48.506950Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m159:[0m 📄 Stored remote SDP answer for session sess_149471e6-e42b-499f-9567-ae43ca403f43
[2m2025-06-09T03:42:48.506973Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m206:[0m 🚀 RFC 3261: Creating media session after ACK for sess_149471e6-e42b-499f-9567-ae43ca403f43: rfc_compliant_media_creation_uas
[2m2025-06-09T03:42:48.506993Z[0m [32m INFO[0m ThreadId(09) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m377:[0m Starting media session for dialog: media-sess_149471e6-e42b-499f-9567-ae43ca403f43
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-1-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag001\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-a62de703b3a943c0a6d7c9fbe6ece785\r\nCall-ID: 1-35937@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 31, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 31, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 61, 36, 32, 64, 65, 37, 30, 33, 62, 33, 61, 39, 34, 33, 63, 30, 61, 36, 64, 37, 63, 39, 66, 62, 65, 36, 65, 63, 65, 37, 38, 35, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 31, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 97, 54, 50, 100, 101, 55, 48, 51, 98, 51, 97, 57, 52, 51, 99, 48, 97, 54, 100, 55, 99, 57, 102, 98, 101, 54, 101, 99, 101, 55, 56, 53]
Successfully parsed tag: tag-a62de703b3a943c0a6d7c9fbe6ece785
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:48.988646Z[0m [32m INFO[0m ThreadId(08) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-1-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-35937-1-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-35937-1-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-1-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag001")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-a62de703b3a943c0a6d7c9fbe6ece785")] })), CallId(CallId("1-35937@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-35937-1-7:BYE:server)
[2m2025-06-09T03:42:48.988957Z[0m [32m INFO[0m ThreadId(08) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-35937-1-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
Valid state transition: Trying -> Completed
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(93a0b567-2359-4ef2-9c1b-e78e45f58ddc), reason: "BYE received" }
[2m2025-06-09T03:42:48.989027Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog 93a0b567-2359-4ef2-9c1b-e78e45f58ddc
State successfully changed to: Completed
Sent StateChanged event result: Success
[2m2025-06-09T03:42:48.989104Z[0m [32m INFO[0m ThreadId(06) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m593:[0m Call terminated for session sess_f406a287-8ef3-4429-83b0-f3f642636e2f: 93a0b567-2359-4ef2-9c1b-e78e45f58ddc - BYE received
[2m2025-06-09T03:42:49.008556Z[0m [32m INFO[0m ThreadId(05) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-09T03:42:49.008754Z[0m [32m INFO[0m ThreadId(05) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=d5489e62
[2m2025-06-09T03:42:49.008802Z[0m [32m INFO[0m ThreadId(05) [2mcrates/media-core/src/relay/controller.rs[0m[2m:[0m[2m457:[0m ✅ Created media session with REAL RTP session: media-sess_149471e6-e42b-499f-9567-ae43ca403f43 (port: 10018)
[2m2025-06-09T03:42:49.008830Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m82:[0m ✅ Created media session: media-sess_149471e6-e42b-499f-9567-ae43ca403f43 for SIP session: sess_149471e6-e42b-499f-9567-ae43ca403f43 with real MediaSessionController
[2m2025-06-09T03:42:49.008849Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m215:[0m ✅ Successfully created RFC-compliant media session for sess_149471e6-e42b-499f-9567-ae43ca403f43
[2m2025-06-09T03:42:49.008900Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m119:[0m ✅ Updated media session for SIP session: sess_149471e6-e42b-499f-9567-ae43ca403f43 with remote: 127.0.0.1:10001 and codecs: ["PCMU"]
[2m2025-06-09T03:42:49.008915Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m224:[0m ✅ Applied stored remote SDP to new media session for sess_149471e6-e42b-499f-9567-ae43ca403f43
[2m2025-06-09T03:42:49.008936Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/manager/core.rs[0m[2m:[0m[2m239:[0m 🎉 Session sess_149471e6-e42b-499f-9567-ae43ca403f43 transitioned to Active in registry - media ready and session fully established!
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-2-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag002\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-4e616f83f3f0433681eef2e13e871829\r\nCall-ID: 2-35937@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 32, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 32, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 34, 65, 36, 31, 36, 66, 38, 33, 66, 33, 66, 30, 34, 33, 33, 36, 38, 31, 65, 65, 66, 32, 65, 31, 33, 65, 38, 37, 31, 38, 32, 39, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 32, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 52, 101, 54, 49, 54, 102, 56, 51, 102, 51, 102, 48, 52, 51, 51, 54, 56, 49, 101, 101, 102, 50, 101, 49, 51, 101, 56, 55, 49, 56, 50, 57]
Successfully parsed tag: tag-4e616f83f3f0433681eef2e13e871829
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:49.497828Z[0m [32m INFO[0m ThreadId(09) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-2-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-35937-2-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-35937-2-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-2-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag002")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-4e616f83f3f0433681eef2e13e871829")] })), CallId(CallId("2-35937@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-35937-2-7:BYE:server)
[2m2025-06-09T03:42:49.498167Z[0m [32m INFO[0m ThreadId(09) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-09T03:42:49.498316Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog 2bf130fa-6fa8-4e3a-b127-3f562d0159db
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-35937-2-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
Valid state transition: Trying -> Completed
State successfully changed to: Completed
Sent StateChanged event result: Success
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(2bf130fa-6fa8-4e3a-b127-3f562d0159db), reason: "BYE received" }
[2m2025-06-09T03:42:49.498526Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m593:[0m Call terminated for session sess_36f5a773-74e1-41a6-945a-52ec2c171e76: 2bf130fa-6fa8-4e3a-b127-3f562d0159db - BYE received
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-3-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag003\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-b3258207cbb240d9a0dd4ee2e0cf60b5\r\nCall-ID: 3-35937@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 33, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 33, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 62, 33, 32, 35, 38, 32, 30, 37, 63, 62, 62, 32, 34, 30, 64, 39, 61, 30, 64, 64, 34, 65, 65, 32, 65, 30, 63, 66, 36, 30, 62, 35, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 33, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 98, 51, 50, 53, 56, 50, 48, 55, 99, 98, 98, 50, 52, 48, 100, 57, 97, 48, 100, 100, 52, 101, 101, 50, 101, 48, 99, 102, 54, 48, 98, 53]
Successfully parsed tag: tag-b3258207cbb240d9a0dd4ee2e0cf60b5
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:49.991646Z[0m [32m INFO[0m ThreadId(08) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-3-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-35937-3-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-35937-3-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-3-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag003")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-b3258207cbb240d9a0dd4ee2e0cf60b5")] })), CallId(CallId("3-35937@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-35937-3-7:BYE:server)
[2m2025-06-09T03:42:49.991934Z[0m [32m INFO[0m ThreadId(08) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-35937-3-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
Valid state transition: Trying -> Completed
State successfully changed to: Completed
[2m2025-06-09T03:42:49.992071Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog 9df08fee-8c1e-46eb-96d2-4ae200a3a5a6
Sent StateChanged event result: Success
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(9df08fee-8c1e-46eb-96d2-4ae200a3a5a6), reason: "BYE received" }
[2m2025-06-09T03:42:49.992249Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m593:[0m Call terminated for session sess_7c4b5180-0c60-42a4-8388-fc1531710522: 9df08fee-8c1e-46eb-96d2-4ae200a3a5a6 - BYE received
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-4-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag004\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-a8cfc318bc1c487b83880810b28db824\r\nCall-ID: 4-35937@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 34, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 34, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 61, 38, 63, 66, 63, 33, 31, 38, 62, 63, 31, 63, 34, 38, 37, 62, 38, 33, 38, 38, 30, 38, 31, 30, 62, 32, 38, 64, 62, 38, 32, 34, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 34, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 97, 56, 99, 102, 99, 51, 49, 56, 98, 99, 49, 99, 52, 56, 55, 98, 56, 51, 56, 56, 48, 56, 49, 48, 98, 50, 56, 100, 98, 56, 50, 52]
Successfully parsed tag: tag-a8cfc318bc1c487b83880810b28db824
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:50.488778Z[0m [32m INFO[0m ThreadId(08) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-4-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-35937-4-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-35937-4-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-4-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag004")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-a8cfc318bc1c487b83880810b28db824")] })), CallId(CallId("4-35937@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-35937-4-7:BYE:server)
[2m2025-06-09T03:42:50.489087Z[0m [32m INFO[0m ThreadId(08) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-35937-4-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
Valid state transition: Trying -> Completed
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c), reason: "BYE received" }
[2m2025-06-09T03:42:50.489225Z[0m [32m INFO[0m ThreadId(08) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c
State successfully changed to: Completed
[2m2025-06-09T03:42:50.489344Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m593:[0m Call terminated for session sess_925f9990-4e71-44e7-89f6-db2f80a7ffc0: e099ea8c-3cf7-40d7-9d06-4ee6a5364d5c - BYE received
Sent StateChanged event result: Success
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-5-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag005\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-59d14bce8b9b4dd19cd7ea70f8d0eb2f\r\nCall-ID: 5-35937@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 35, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 35, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 35, 39, 64, 31, 34, 62, 63, 65, 38, 62, 39, 62, 34, 64, 64, 31, 39, 63, 64, 37, 65, 61, 37, 30, 66, 38, 64, 30, 65, 62, 32, 66, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 35, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 53, 57, 100, 49, 52, 98, 99, 101, 56, 98, 57, 98, 52, 100, 100, 49, 57, 99, 100, 55, 101, 97, 55, 48, 102, 56, 100, 48, 101, 98, 50, 102]
Successfully parsed tag: tag-59d14bce8b9b4dd19cd7ea70f8d0eb2f
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:50.989437Z[0m [32m INFO[0m ThreadId(07) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-5-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-35937-5-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-35937-5-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-5-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag005")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-59d14bce8b9b4dd19cd7ea70f8d0eb2f")] })), CallId(CallId("5-35937@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-35937-5-7:BYE:server)
[2m2025-06-09T03:42:50.989758Z[0m [32m INFO[0m ThreadId(07) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-35937-5-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
Valid state transition: Trying -> Completed
State successfully changed to: Completed
[2m2025-06-09T03:42:50.989839Z[0m [32m INFO[0m ThreadId(07) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog 1f20f687-d380-4914-96f6-d7d8f96ad065
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(1f20f687-d380-4914-96f6-d7d8f96ad065), reason: "BYE received" }
Sent StateChanged event result: Success
[2m2025-06-09T03:42:50.989950Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m593:[0m Call terminated for session sess_00a93a75-6f25-4980-b8cc-941e822f4e43: 1f20f687-d380-4914-96f6-d7d8f96ad065 - BYE received
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-6-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag006\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-54255032098f44b8ac0ac3f5b4588be6\r\nCall-ID: 6-35937@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 36, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 36, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 35, 34, 32, 35, 35, 30, 33, 32, 30, 39, 38, 66, 34, 34, 62, 38, 61, 63, 30, 61, 63, 33, 66, 35, 62, 34, 35, 38, 38, 62, 65, 36, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 36, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 53, 52, 50, 53, 53, 48, 51, 50, 48, 57, 56, 102, 52, 52, 98, 56, 97, 99, 48, 97, 99, 51, 102, 53, 98, 52, 53, 56, 56, 98, 101, 54]
Successfully parsed tag: tag-54255032098f44b8ac0ac3f5b4588be6
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:51.496190Z[0m [32m INFO[0m ThreadId(05) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-6-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-35937-6-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-35937-6-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-6-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag006")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-54255032098f44b8ac0ac3f5b4588be6")] })), CallId(CallId("6-35937@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-35937-6-7:BYE:server)
[2m2025-06-09T03:42:51.496485Z[0m [32m INFO[0m ThreadId(05) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-35937-6-7:BYE:server)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(b001f64a-202b-46a9-b17c-96ff9acfc971), reason: "BYE received" }
[2m2025-06-09T03:42:51.496615Z[0m [32m INFO[0m ThreadId(05) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog b001f64a-202b-46a9-b17c-96ff9acfc971
Processing TransitionTo(Completed) current state: Trying
Valid state transition: Trying -> Completed
State successfully changed to: Completed
[2m2025-06-09T03:42:51.496729Z[0m [32m INFO[0m ThreadId(07) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m593:[0m Call terminated for session sess_e5ed18c4-be11-4e59-92c9-b71286d29a5a: b001f64a-202b-46a9-b17c-96ff9acfc971 - BYE received
Sent StateChanged event result: Success
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-7-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag007\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-f4ebede0d6854ae7b3ae560192bb9a8d\r\nCall-ID: 7-35937@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 37, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 37, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 66, 34, 65, 62, 65, 64, 65, 30, 64, 36, 38, 35, 34, 61, 65, 37, 62, 33, 61, 65, 35, 36, 30, 31, 39, 32, 62, 62, 39, 61, 38, 64, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 37, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 102, 52, 101, 98, 101, 100, 101, 48, 100, 54, 56, 53, 52, 97, 101, 55, 98, 51, 97, 101, 53, 54, 48, 49, 57, 50, 98, 98, 57, 97, 56, 100]
Successfully parsed tag: tag-f4ebede0d6854ae7b3ae560192bb9a8d
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:51.993512Z[0m [32m INFO[0m ThreadId(05) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-7-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-35937-7-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-35937-7-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-7-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag007")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-f4ebede0d6854ae7b3ae560192bb9a8d")] })), CallId(CallId("7-35937@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-35937-7-7:BYE:server)
[2m2025-06-09T03:42:51.993808Z[0m [32m INFO[0m ThreadId(05) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-35937-7-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
[2m2025-06-09T03:42:51.993917Z[0m [32m INFO[0m ThreadId(05) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog d989becc-9ca9-42ae-99ba-c8d8918fde8c
Valid state transition: Trying -> Completed
State successfully changed to: Completed
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(d989becc-9ca9-42ae-99ba-c8d8918fde8c), reason: "BYE received" }
Sent StateChanged event result: Success
[2m2025-06-09T03:42:51.994087Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m593:[0m Call terminated for session sess_940ae187-a3af-430d-b429-3bae84e3b713: d989becc-9ca9-42ae-99ba-c8d8918fde8c - BYE received
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-8-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag008\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-f7ec12e9c19947dda61af7c061bc4f3c\r\nCall-ID: 8-35937@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 38, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 38, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 66, 37, 65, 63, 31, 32, 65, 39, 63, 31, 39, 39, 34, 37, 64, 64, 61, 36, 31, 61, 66, 37, 63, 30, 36, 31, 62, 63, 34, 66, 33, 63, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 38, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 102, 55, 101, 99, 49, 50, 101, 57, 99, 49, 57, 57, 52, 55, 100, 100, 97, 54, 49, 97, 102, 55, 99, 48, 54, 49, 98, 99, 52, 102, 51, 99]
Successfully parsed tag: tag-f7ec12e9c19947dda61af7c061bc4f3c
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:52.488347Z[0m [32m INFO[0m ThreadId(06) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-8-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-35937-8-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-35937-8-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-8-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag008")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-f7ec12e9c19947dda61af7c061bc4f3c")] })), CallId(CallId("8-35937@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-35937-8-7:BYE:server)
[2m2025-06-09T03:42:52.488644Z[0m [32m INFO[0m ThreadId(06) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-35937-8-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
[2m2025-06-09T03:42:52.488727Z[0m [32m INFO[0m ThreadId(06) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog 379f0552-0624-403b-aebe-031764808974
Valid state transition: Trying -> Completed
State successfully changed to: Completed
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(379f0552-0624-403b-aebe-031764808974), reason: "BYE received" }
Sent StateChanged event result: Success
[2m2025-06-09T03:42:52.488845Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m593:[0m Call terminated for session sess_9eb34110-d383-4907-a0c1-ee9a6e7f1a20: 379f0552-0624-403b-aebe-031764808974 - BYE received
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-9-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag009\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-260e76f54ea04bedad71e25bf1844ae7\r\nCall-ID: 9-35937@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 39, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 39, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 32, 36, 30, 65, 37, 36, 66, 35, 34, 65, 61, 30, 34, 62, 65, 64, 61, 64, 37, 31, 65, 32, 35, 62, 66, 31, 38, 34, 34, 61, 65, 37, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 39, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 50, 54, 48, 101, 55, 54, 102, 53, 52, 101, 97, 48, 52, 98, 101, 100, 97, 100, 55, 49, 101, 50, 53, 98, 102, 49, 56, 52, 52, 97, 101, 55]
Successfully parsed tag: tag-260e76f54ea04bedad71e25bf1844ae7
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:52.986461Z[0m [32m INFO[0m ThreadId(11) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-9-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-35937-9-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-35937-9-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-9-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag009")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-260e76f54ea04bedad71e25bf1844ae7")] })), CallId(CallId("9-35937@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-35937-9-7:BYE:server)
[2m2025-06-09T03:42:52.986677Z[0m [32m INFO[0m ThreadId(11) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-35937-9-7:BYE:server)
[2m2025-06-09T03:42:52.986741Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog 74c92869-da9b-4a57-a130-64da8b44ae39
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(74c92869-da9b-4a57-a130-64da8b44ae39), reason: "BYE received" }
Processing TransitionTo(Completed) current state: Trying
Valid state transition: Trying -> Completed
State successfully changed to: Completed
[2m2025-06-09T03:42:52.986805Z[0m [32m INFO[0m ThreadId(05) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m593:[0m Call terminated for session sess_562cd264-60c3-4afc-94da-9eb7d001e2c9: 74c92869-da9b-4a57-a130-64da8b44ae39 - BYE received
Sent StateChanged event result: Success
=== PARSING SIP MESSAGE ===
Input length: 412 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-35937-10-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=35937SIPpTag0010\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-0006b5a794ca48f4b4c30e82647b42aa\r\nCall-ID: 10-35937@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 33, 35, 39, 33, 37, 2d, 31, 30, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 33, 35, 39, 33, 37, 53, 49, 50, 70, 54, 61, 67, 30, 30, 31, 30, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 30, 30, 30, 36, 62, 35, 61, 37, 39, 34, 63, 61, 34, 38, 66, 34, 62, 34, 63, 33, 30, 65, 38, 32, 36, 34, 37, 62, 34, 32, 61, 61, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 31, 30, 2d, 33, 35, 39, 33, 37, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 48, 48, 48, 54, 98, 53, 97, 55, 57, 52, 99, 97, 52, 56, 102, 52, 98, 52, 99, 51, 48, 101, 56, 50, 54, 52, 55, 98, 52, 50, 97, 97]
Successfully parsed tag: tag-0006b5a794ca48f4b4c30e82647b42aa
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-09T03:42:53.491566Z[0m [32m INFO[0m ThreadId(11) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-35937-10-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-35937-10-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-35937-10-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-35937-10-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("35937SIPpTag0010")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-0006b5a794ca48f4b4c30e82647b42aa")] })), CallId(CallId("10-35937@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-35937-10-7:BYE:server)
[2m2025-06-09T03:42:53.491907Z[0m [32m INFO[0m ThreadId(11) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-35937-10-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
Valid state transition: Trying -> Completed
[2m2025-06-09T03:42:53.492041Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog 6d73546e-8722-453b-89d7-7b24cbcb12ed
State successfully changed to: Completed
Sent StateChanged event result: Success
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(6d73546e-8722-453b-89d7-7b24cbcb12ed), reason: "BYE received" }
[2m2025-06-09T03:42:53.492222Z[0m [32m INFO[0m ThreadId(08) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m593:[0m Call terminated for session sess_149471e6-e42b-499f-9567-ae43ca403f43: 6d73546e-8722-453b-89d7-7b24cbcb12ed - BYE received
[2m2025-06-09T03:42:53.613262Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m231:[0m 📡 Received SIGTERM signal
[2m2025-06-09T03:42:53.613300Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m210:[0m 🛑 SIP Test Server shutting down
[2m2025-06-09T03:42:53.613314Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m250:[0m 📊 Final Statistics:
[2m2025-06-09T03:42:53.613321Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m251:[0m   ⏱️  Uptime: 13.84 seconds
[2m2025-06-09T03:42:53.613330Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m252:[0m   📞 Total calls: 10
[2m2025-06-09T03:42:53.613336Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m253:[0m   ✅ Successful calls: 0
[2m2025-06-09T03:42:53.613342Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m254:[0m   ❌ Failed calls: 0
[2m2025-06-09T03:42:53.613348Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m255:[0m   🔄 Active calls: 10
[2m2025-06-09T03:42:53.613355Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m256:[0m   📈 Success rate: 0.0%
[2m2025-06-09T03:42:53.613361Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m260:[0m   🚀 Average call rate: 0.72 calls/second
[2m2025-06-09T03:42:53.613368Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m298:[0m 👋 SIP Test Server shutdown complete
