warning: method `handle_auto_options` is never used
   --> crates/dialog-core/src/manager/unified.rs:563:14
    |
197 | impl UnifiedDialogManager {
    | ------------------------- method in this implementation
...
563 |     async fn handle_auto_options(&self, request: Request, source: SocketAddr) -> ApiResult<()> {
    |              ^^^^^^^^^^^^^^^^^^^
    |
    = note: `#[warn(dead_code)]` on by default

warning: method `extract_body_string` is never used
   --> crates/dialog-core/src/protocol/invite_handler.rs:177:8
    |
71  | impl DialogManager {
    | ------------------ method in this implementation
...
177 |     fn extract_body_string(&self, request: &Request) -> String {
    |        ^^^^^^^^^^^^^^^^^^^

warning: `rvoip-dialog-core` (lib) generated 2 warnings
warning: unused import: `StaticEvent`
  --> crates/infra-common/src/events/static_path.rs:14:60
   |
14 | use crate::events::types::{Event, EventResult, EventError, StaticEvent, EventFilter};
   |                                                            ^^^^^^^^^^^
   |
   = note: `#[warn(unused_imports)]` on by default

warning: unused imports: `EventError` and `StaticEvent`
  --> crates/infra-common/src/events/system.rs:16:48
   |
16 | use crate::events::types::{Event, EventResult, EventError, EventFilter, StaticEvent};
   |                                                ^^^^^^^^^^               ^^^^^^^^^^^

warning: unused imports: `EventSystemBuilder` and `ImplementationType`
  --> crates/infra-common/src/events/system.rs:21:30
   |
21 | use crate::events::builder::{ImplementationType, EventSystemBuilder};
   |                              ^^^^^^^^^^^^^^^^^^  ^^^^^^^^^^^^^^^^^^

warning: variable does not need to be mutable
  --> crates/infra-common/src/lifecycle/manager.rs:87:13
   |
87 |         let mut components = self.components.write().unwrap();
   |             ----^^^^^^^^^^
   |             |
   |             help: remove this `mut`
   |
   = note: `#[warn(unused_mut)]` on by default

warning: variable does not need to be mutable
   --> crates/infra-common/src/lifecycle/manager.rs:107:13
    |
107 |         let mut components = self.components.write().unwrap();
    |             ----^^^^^^^^^^
    |             |
    |             help: remove this `mut`

warning: variable does not need to be mutable
   --> crates/infra-common/src/lifecycle/manager.rs:127:13
    |
127 |         let mut components = self.components.write().unwrap();
    |             ----^^^^^^^^^^
    |             |
    |             help: remove this `mut`

warning: variable does not need to be mutable
   --> crates/infra-common/src/lifecycle/manager.rs:148:13
    |
148 |         let mut components = self.components.write().unwrap();
    |             ----^^^^^^^^^^
    |             |
    |             help: remove this `mut`

warning: use of deprecated method `config::Config::merge`: please use 'ConfigBuilder' instead
  --> crates/infra-common/src/config/loader.rs:63:20
   |
63 |             config.merge(File::from(base_path.clone()))
   |                    ^^^^^
   |
   = note: `#[warn(deprecated)]` on by default

warning: use of deprecated method `config::Config::merge`: please use 'ConfigBuilder' instead
  --> crates/infra-common/src/config/loader.rs:69:20
   |
69 |             config.merge(File::from(env_path))
   |                    ^^^^^

warning: use of deprecated method `config::Config::merge`: please use 'ConfigBuilder' instead
  --> crates/infra-common/src/config/loader.rs:75:16
   |
75 |         config.merge(Environment::with_prefix(&env_prefix).separator("__"))
   |                ^^^^^

warning: use of deprecated method `config::Config::merge`: please use 'ConfigBuilder' instead
  --> crates/infra-common/src/config/loader.rs:97:16
   |
97 |         config.merge(Environment::with_prefix(&env_prefix).separator("__"))
   |                ^^^^^

warning: use of deprecated method `config::Config::merge`: please use 'ConfigBuilder' instead
   --> crates/infra-common/src/config/loader.rs:115:20
    |
115 |             config.merge(File::from(p.clone()))
    |                    ^^^^^

warning: methods `type_name` and `clone_sender` are never used
  --> crates/infra-common/src/events/registry.rs:37:8
   |
35 | trait AnyBroadcastSender: Send + Sync + 'static {
   |       ------------------ methods in this trait
36 |     fn as_any(&self) -> &dyn Any;
37 |     fn type_name(&self) -> &str;
   |        ^^^^^^^^^
38 |     fn clone_sender(&self) -> Box<dyn AnyBroadcastSender>;
   |        ^^^^^^^^^^^^
   |
   = note: `#[warn(dead_code)]` on by default

warning: fields `id`, `event_type`, and `priority` are never read
  --> crates/infra-common/src/events/subscriber.rs:11:16
   |
10 | pub struct SubscriberHandle {
   |            ---------------- fields in this struct
11 |     pub(crate) id: u64,
   |                ^^
12 |     pub(crate) event_type: EventType,
   |                ^^^^^^^^^^
13 |     pub(crate) priority: EventPriority,
   |                ^^^^^^^^
   |
   = note: `SubscriberHandle` has derived impls for the traits `Clone` and `Debug`, but these are intentionally ignored during dead code analysis

warning: `infra-common` (lib) generated 14 warnings (run `cargo fix --lib -p infra-common` to apply 7 suggestions)
warning: unused import: `MediaControl`
  --> crates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs:12:69
   |
12 | use rvoip_session_core::{SessionCoordinator, SessionManagerBuilder, MediaControl};
   |                                                                     ^^^^^^^^^^^^
   |
   = note: `#[warn(unused_imports)]` on by default

warning: unused imports: `CallState` and `SessionId`
  --> crates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs:14:31
   |
14 |     CallHandler, CallSession, CallState, IncomingCall, CallDecision, SessionId,
   |                               ^^^^^^^^^                              ^^^^^^^^^

warning: unused import: `error`
  --> crates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs:22:21
   |
22 | use tracing::{info, error};
   |                     ^^^^^

warning: unused variable: `sdp_offer`
  --> crates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs:97:50
   |
97 |                 let sdp_answer = if let Some(ref sdp_offer) = call.sdp {
   |                                                  ^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_sdp_offer`
   |
   = note: `#[warn(unused_variables)]` on by default

warning: `sipp_tests` (bin "sip_test_server") generated 4 warnings (run `cargo fix --bin "sip_test_server"` to apply 3 suggestions)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.13s
     Running `/Users/jonathan/Documents/Work/Rudeless Ventures/rvoip/rvoip/target/debug/sip_test_server --port 5062 --mode auto-answer --log-level info`
[2m2025-06-17T22:53:00.174267Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m297:[0m 🧪 SIP Test Server starting...
[2m2025-06-17T22:53:00.174445Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m298:[0m 🔧 Configuration:
[2m2025-06-17T22:53:00.174501Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m299:[0m   📡 Port: 5062
[2m2025-06-17T22:53:00.174536Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m300:[0m   🎯 Mode: AutoAnswer
[2m2025-06-17T22:53:00.174570Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m301:[0m   📊 Metrics: true
[2m2025-06-17T22:53:00.174600Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m189:[0m 🚀 Starting SIP Test Server on port 5062
[2m2025-06-17T22:53:00.175076Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/api/unified.rs[0m[2m:[0m[2m825:[0m Creating UnifiedDialogApi with automatic transport setup in "Hybrid" mode
[2m2025-06-17T22:53:00.175732Z[0m [32m INFO[0m ThreadId(01) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m48:[0m SIP UDP transport bound to 0.0.0.0:5062
[2m2025-06-17T22:53:00.176852Z[0m [32m INFO[0m ThreadId(01) [2mcrates/transaction-core/src/transport/mod.rs[0m[2m:[0m[2m247:[0m Added UDP transport bound to 0.0.0.0:5062
[2m2025-06-17T22:53:00.177924Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/api/unified.rs[0m[2m:[0m[2m294:[0m Creating UnifiedDialogApi with global events in "Hybrid" mode
[2m2025-06-17T22:53:00.178731Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/unified.rs[0m[2m:[0m[2m252:[0m Creating UnifiedDialogManager with global events in "Hybrid" mode at 0.0.0.0:5062
[2m2025-06-17T22:53:00.178857Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/core.rs[0m[2m:[0m[2m100:[0m Creating new DialogManager with global transaction events and local address 0.0.0.0:5062
[2m2025-06-17T22:53:00.180407Z[0m [32m INFO[0m ThreadId(16) [2mcrates/dialog-core/src/manager/core.rs[0m[2m:[0m[2m128:[0m 🔄 Starting global transaction event processor for dialog-core
[2m2025-06-17T22:53:00.180871Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/src/manager/events.rs[0m[2m:[0m[2m162:[0m Session event processor started
🔗 SETUP: Setting up session coordination with dialog-core
✅ SETUP: Session coordination setup complete
[2m2025-06-17T22:53:00.180967Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m157:[0m SessionCoordinator initialized on port 5062
[2m2025-06-17T22:53:00.181003Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/api/unified.rs[0m[2m:[0m[2m336:[0m Starting UnifiedDialogApi
[2m2025-06-17T22:53:00.181036Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/unified.rs[0m[2m:[0m[2m294:[0m Starting UnifiedDialogManager in "Hybrid" mode
[2m2025-06-17T22:53:00.181057Z[0m [32m INFO[0m ThreadId(14) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m163:[0m Starting main coordinator event loop
🎬 SPAWN: Starting session coordination event loop
[2m2025-06-17T22:53:00.181069Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/core.rs[0m[2m:[0m[2m399:[0m DialogManager starting
📡 EVENT LOOP: Session coordination event loop started
[2m2025-06-17T22:53:00.181176Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/core.rs[0m[2m:[0m[2m407:[0m DialogManager started successfully
[2m2025-06-17T22:53:00.181231Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/unified.rs[0m[2m:[0m[2m310:[0m Hybrid mode active - from_uri: Some("sip:test@127.0.0.1:5062"), domain: None, auto_auth: false, auto_options: false
[2m2025-06-17T22:53:00.181288Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/unified.rs[0m[2m:[0m[2m315:[0m UnifiedDialogManager started successfully
[2m2025-06-17T22:53:00.181331Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/src/manager/cleanup.rs[0m[2m:[0m[2m54:[0m Cleanup manager started
[2m2025-06-17T22:53:00.181368Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m449:[0m SessionCoordinator started
[2m2025-06-17T22:53:00.181395Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m216:[0m 🚀 Starting SIP Test Server session coordinator...
[2m2025-06-17T22:53:00.181420Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/api/unified.rs[0m[2m:[0m[2m336:[0m Starting UnifiedDialogApi
[2m2025-06-17T22:53:00.181442Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/unified.rs[0m[2m:[0m[2m294:[0m Starting UnifiedDialogManager in "Hybrid" mode
[2m2025-06-17T22:53:00.181465Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/core.rs[0m[2m:[0m[2m399:[0m DialogManager starting
[2m2025-06-17T22:53:00.181486Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/core.rs[0m[2m:[0m[2m407:[0m DialogManager started successfully
[2m2025-06-17T22:53:00.181527Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/unified.rs[0m[2m:[0m[2m310:[0m Hybrid mode active - from_uri: Some("sip:test@127.0.0.1:5062"), domain: None, auto_auth: false, auto_options: false
[2m2025-06-17T22:53:00.181551Z[0m [32m INFO[0m ThreadId(01) [2mcrates/dialog-core/src/manager/unified.rs[0m[2m:[0m[2m315:[0m UnifiedDialogManager started successfully
[2m2025-06-17T22:53:00.181575Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m449:[0m SessionCoordinator started
[2m2025-06-17T22:53:00.181600Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m221:[0m ✅ SIP Test Server ready and listening on port 5062
[2m2025-06-17T22:53:00.181623Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m222:[0m 📋 Response mode: AutoAnswer
[2m2025-06-17T22:53:00.181645Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m223:[0m 🔄 Waiting for incoming calls from SIPp...
[2m2025-06-17T22:53:00.181666Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m224:[0m 📡 Real SIP server now active - SIPp can connect!
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-1-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag001\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 1-64430@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6000 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 31, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 31, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 31, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 30, 30, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:04.376490Z[0m [32m INFO[0m ThreadId(11) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-1-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
Transaction loop starting for Key(z9hG4bK-64430-1-0:INVITE:server)
Initial state: Proceeding
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-64430-1-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
[2m2025-06-17T22:53:04.377021Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog c41766b9-d079-4a05-8d04-e141c6cf7cac from INVITE request
🔍 INVITE HANDLER: Created early dialog c41766b9-d079-4a05-8d04-e141c6cf7cac
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-64430-1-0:INVITE:server) with dialog c41766b9-d079-4a05-8d04-e141c6cf7cac
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog c41766b9-d079-4a05-8d04-e141c6cf7cac
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog c41766b9-d079-4a05-8d04-e141c6cf7cac
[2m2025-06-17T22:53:04.377109Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog c41766b9-d079-4a05-8d04-e141c6cf7cac
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(c41766b9-d079-4a05-8d04-e141c6cf7cac), transaction_id: z9hG4bK-64430-1-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-1-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag001")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("1-64430@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6000 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-17T22:53:04.377359Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m149:[0m handle_incoming_call called for dialog c41766b9-d079-4a05-8d04-e141c6cf7cac
[2m2025-06-17T22:53:04.377391Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m155:[0m Incoming call from dialog c41766b9-d079-4a05-8d04-e141c6cf7cac: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-17T22:53:04.377452Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m163:[0m Created session sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997 for incoming call dialog c41766b9-d079-4a05-8d04-e141c6cf7cac
[2m2025-06-17T22:53:04.377517Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m188:[0m Calling handler.on_incoming_call for session sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997
[2m2025-06-17T22:53:04.377542Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m82:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-17T22:53:04.377558Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m83:[0m 📞 [SIPp-Test-Server] Call ID: sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997
[2m2025-06-17T22:53:04.377576Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m94:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-17T22:53:04.377589Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m98:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating simple answer
[2m2025-06-17T22:53:04.377605Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m112:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-17T22:53:04.377621Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m200:[0m Handler decision for session sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997: Accept(Some("v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"))
[2m2025-06-17T22:53:04.377682Z[0m [32m INFO[0m ThreadId(15) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call c41766b9-d079-4a05-8d04-e141c6cf7cac
[2m2025-06-17T22:53:04.377915Z[0m [32m INFO[0m ThreadId(15) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
🎯 COORDINATOR: Handling event: SessionCreated { session_id: SessionId("sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997"), from: "sip:from@127.0.0.1", to: "sip:to@local", call_state: Ringing }
[2m2025-06-17T22:53:04.378018Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m224:[0m Session sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997 created with state Ringing
[2m2025-06-17T22:53:04.378183Z[0m [32m INFO[0m ThreadId(15) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog c41766b9-d079-4a05-8d04-e141c6cf7cac local tag set to match response: tag-18c514e732bb4fc79e1ee6ca5aab8280
[2m2025-06-17T22:53:04.378212Z[0m [32m INFO[0m ThreadId(15) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog c41766b9-d079-4a05-8d04-e141c6cf7cac transitioned to Confirmed state
[2m2025-06-17T22:53:04.378243Z[0m [32m INFO[0m ThreadId(15) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog c41766b9-d079-4a05-8d04-e141c6cf7cac
[2m2025-06-17T22:53:04.378267Z[0m [32m INFO[0m ThreadId(15) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call c41766b9-d079-4a05-8d04-e141c6cf7cac
[2m2025-06-17T22:53:04.378330Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m224:[0m Successfully answered incoming call for session sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(c41766b9-d079-4a05-8d04-e141c6cf7cac), session_answer: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
[2m2025-06-17T22:53:04.378401Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m456:[0m Call answered for session sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997: c41766b9-d079-4a05-8d04-e141c6cf7cac (awaiting ACK per RFC 3261)
[2m2025-06-17T22:53:04.378441Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m470:[0m 📞 Call answered for session sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997 - keeping in Initiating state until media ready
[2m2025-06-17T22:53:04.378456Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m473:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
🎯 COORDINATOR: Handling event: SdpEvent { session_id: SessionId("sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997"), event_type: "remote_sdp_answer", sdp: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
Received command: CancelTimer100 for transaction Key(z9hG4bK-64430-1-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-64430-1-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-64430-1-0:INVITE:server). Final state: Terminated
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-1-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag001\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-18c514e732bb4fc79e1ee6ca5aab8280\r\nCall-ID: 1-64430@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 31, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 31, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 31, 38, 63, 35, 31, 34, 65, 37, 33, 32, 62, 62, 34, 66, 63, 37, 39, 65, 31, 65, 65, 36, 63, 61, 35, 61, 61, 62, 38, 32, 38, 30, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 31, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 49, 56, 99, 53, 49, 52, 101, 55, 51, 50, 98, 98, 52, 102, 99, 55, 57, 101, 49, 101, 101, 54, 99, 97, 53, 97, 97, 98, 56, 50, 56, 48]
Successfully parsed tag: tag-18c514e732bb4fc79e1ee6ca5aab8280
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"host": Object({"Address": String("127.0.0.1")}), "parameters": Array([]), "password": Null, "port": Number(5061.0), "scheme": String("Sip"), "user": String("sipp"), "headers": Object({}), "raw_uri": Null}), "display_name": String("SIPp Test"), "params": Array([Object({"Tag": String("64430SIPpTag001")})])})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag001")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag001")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag001")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("SIPp Test"), "params": Array([Object({"Tag": String("64430SIPpTag001")})]), "uri": Object({"password": Null, "raw_uri": Null, "headers": Object({}), "user": String("sipp"), "port": Number(5061.0), "scheme": String("Sip"), "parameters": Array([]), "host": Object({"Address": String("127.0.0.1")})})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag001")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag001")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag001")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "uri": Object({"scheme": String("Sip"), "user": String("test"), "headers": Object({}), "parameters": Array([]), "password": Null, "port": Number(5062.0), "host": Object({"Address": String("127.0.0.1")}), "raw_uri": Null}), "params": Array([])})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("tag-18c514e732bb4fc79e1ee6ca5aab8280")})]), "display_name": String("Test User"), "uri": Object({"port": Number(5062.0), "password": Null, "raw_uri": Null, "user": String("test"), "scheme": String("Sip"), "host": Object({"Address": String("127.0.0.1")}), "headers": Object({}), "parameters": Array([])})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-18c514e732bb4fc79e1ee6ca5aab8280")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-18c514e732bb4fc79e1ee6ca5aab8280")})
Final value for path 'headers.To.params[0].Tag': String("tag-18c514e732bb4fc79e1ee6ca5aab8280")
[2m2025-06-17T22:53:04.389456Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-64430-1-0:INVITE:server) in dialog c41766b9-d079-4a05-8d04-e141c6cf7cac - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(c41766b9-d079-4a05-8d04-e141c6cf7cac), transaction_id: z9hG4bK-64430-1-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-17T22:53:04.389747Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m565:[0m ✅ RFC 3261: ACK RECEIVED for session sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997 - creating media session (UAS side)
🎯 COORDINATOR: Handling event: MediaEvent { session_id: SessionId("sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997"), event: "rfc_compliant_media_creation_uas" }
[2m2025-06-17T22:53:04.389892Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m366:[0m Media creation event for sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997: rfc_compliant_media_creation_uas
🎯 COORDINATOR: Handling event: StateChanged { session_id: SessionId("sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997"), old_state: Ringing, new_state: Active }
[2m2025-06-17T22:53:04.390046Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m248:[0m Session sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997 state changed: Ringing -> Active
[2m2025-06-17T22:53:04.390116Z[0m [32m INFO[0m ThreadId(11) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m263:[0m Starting media session for dialog: media-sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997
[2m2025-06-17T22:53:04.390366Z[0m [32m INFO[0m ThreadId(11) [2mcrates/rtp-core/src/transport/allocator.rs[0m[2m:[0m[2m564:[0m Created global port allocator with range 16384-32767
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-2-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag002\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 2-64430@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6004 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 32, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 32, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 32, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 30, 34, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:04.880793Z[0m [32m INFO[0m ThreadId(15) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-2-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
Transaction loop starting for Key(z9hG4bK-64430-2-0:INVITE:server)
Initial state: Proceeding
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-64430-2-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
[2m2025-06-17T22:53:04.881226Z[0m [32m INFO[0m ThreadId(15) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog 7c2f949d-894f-40d0-9416-efdcc646e866 from INVITE request
🔍 INVITE HANDLER: Created early dialog 7c2f949d-894f-40d0-9416-efdcc646e866
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-64430-2-0:INVITE:server) with dialog 7c2f949d-894f-40d0-9416-efdcc646e866
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog 7c2f949d-894f-40d0-9416-efdcc646e866
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog 7c2f949d-894f-40d0-9416-efdcc646e866
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(7c2f949d-894f-40d0-9416-efdcc646e866), transaction_id: z9hG4bK-64430-2-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-2-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag002")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("2-64430@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6004 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-17T22:53:04.881894Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m149:[0m handle_incoming_call called for dialog 7c2f949d-894f-40d0-9416-efdcc646e866
[2m2025-06-17T22:53:04.881608Z[0m [32m INFO[0m ThreadId(15) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog 7c2f949d-894f-40d0-9416-efdcc646e866
[2m2025-06-17T22:53:04.882023Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m155:[0m Incoming call from dialog 7c2f949d-894f-40d0-9416-efdcc646e866: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-17T22:53:04.882201Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m163:[0m Created session sess_7e8b8e81-7db9-4984-a110-0c36a616f14e for incoming call dialog 7c2f949d-894f-40d0-9416-efdcc646e866
[2m2025-06-17T22:53:04.882297Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m188:[0m Calling handler.on_incoming_call for session sess_7e8b8e81-7db9-4984-a110-0c36a616f14e
[2m2025-06-17T22:53:04.882392Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m82:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-17T22:53:04.882452Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m83:[0m 📞 [SIPp-Test-Server] Call ID: sess_7e8b8e81-7db9-4984-a110-0c36a616f14e
[2m2025-06-17T22:53:04.882498Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m94:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-17T22:53:04.882540Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m98:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating simple answer
[2m2025-06-17T22:53:04.882598Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m112:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-17T22:53:04.882644Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m200:[0m Handler decision for session sess_7e8b8e81-7db9-4984-a110-0c36a616f14e: Accept(Some("v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"))
[2m2025-06-17T22:53:04.882795Z[0m [32m INFO[0m ThreadId(16) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call 7c2f949d-894f-40d0-9416-efdcc646e866
[2m2025-06-17T22:53:04.883185Z[0m [32m INFO[0m ThreadId(16) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-17T22:53:04.883494Z[0m [32m INFO[0m ThreadId(16) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog 7c2f949d-894f-40d0-9416-efdcc646e866 local tag set to match response: tag-cfb0be2323624ddd83a12259a00b9f43
[2m2025-06-17T22:53:04.883573Z[0m [32m INFO[0m ThreadId(16) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog 7c2f949d-894f-40d0-9416-efdcc646e866 transitioned to Confirmed state
[2m2025-06-17T22:53:04.883647Z[0m [32m INFO[0m ThreadId(16) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog 7c2f949d-894f-40d0-9416-efdcc646e866
[2m2025-06-17T22:53:04.883701Z[0m [32m INFO[0m ThreadId(16) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call 7c2f949d-894f-40d0-9416-efdcc646e866
[2m2025-06-17T22:53:04.883751Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m224:[0m Successfully answered incoming call for session sess_7e8b8e81-7db9-4984-a110-0c36a616f14e
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(7c2f949d-894f-40d0-9416-efdcc646e866), session_answer: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
[2m2025-06-17T22:53:04.883910Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m456:[0m Call answered for session sess_7e8b8e81-7db9-4984-a110-0c36a616f14e: 7c2f949d-894f-40d0-9416-efdcc646e866 (awaiting ACK per RFC 3261)
[2m2025-06-17T22:53:04.883963Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m470:[0m 📞 Call answered for session sess_7e8b8e81-7db9-4984-a110-0c36a616f14e - keeping in Initiating state until media ready
[2m2025-06-17T22:53:04.884001Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m473:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-64430-2-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-64430-2-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-2-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag002\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-cfb0be2323624ddd83a12259a00b9f43\r\nCall-ID: 2-64430@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
, 3a, 35, 30, 36, 32, 20, 53, 49, 50Sent StateChanged event result: Success
, 2f, 32, 2e, 30, 0dTransaction loop ending for Key(z9hG4bK-64430-2-0:INVITE:server). Final state: Terminated
, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 32, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 32, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 63, 66, 62, 30, 62, 65, 32, 33, 32, 33, 36, 32, 34, 64, 64, 64, 38, 33, 61, 31, 32, 32, 35, 39, 61, 30, 30, 62, 39, 66, 34, 33, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 32, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 99, 102, 98, 48, 98, 101, 50, 51, 50, 51, 54, 50, 52, 100, 100, 100, 56, 51, 97, 49, 50, 50, 53, 57, 97, 48, 48, 98, 57, 102, 52, 51]
Successfully parsed tag: tag-cfb0be2323624ddd83a12259a00b9f43
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("64430SIPpTag002")})]), "uri": Object({"host": Object({"Address": String("127.0.0.1")}), "headers": Object({}), "parameters": Array([]), "password": Null, "port": Number(5061.0), "raw_uri": Null, "scheme": String("Sip"), "user": String("sipp")}), "display_name": String("SIPp Test")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag002")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag002")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag002")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("SIPp Test"), "params": Array([Object({"Tag": String("64430SIPpTag002")})]), "uri": Object({"scheme": String("Sip"), "user": String("sipp"), "parameters": Array([]), "password": Null, "headers": Object({}), "raw_uri": Null, "host": Object({"Address": String("127.0.0.1")}), "port": Number(5061.0)})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag002")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag002")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag002")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "params": Array([]), "uri": Object({"host": Object({"Address": String("127.0.0.1")}), "scheme": String("Sip"), "password": Null, "user": String("test"), "parameters": Array([]), "headers": Object({}), "raw_uri": Null, "port": Number(5062.0)})})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "params": Array([Object({"Tag": String("tag-cfb0be2323624ddd83a12259a00b9f43")})]), "uri": Object({"password": Null, "port": Number(5062.0), "raw_uri": Null, "headers": Object({}), "parameters": Array([]), "scheme": String("Sip"), "host": Object({"Address": String("127.0.0.1")}), "user": String("test")})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-cfb0be2323624ddd83a12259a00b9f43")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-cfb0be2323624ddd83a12259a00b9f43")})
Final value for path 'headers.To.params[0].Tag': String("tag-cfb0be2323624ddd83a12259a00b9f43")
[2m2025-06-17T22:53:04.898441Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-64430-2-0:INVITE:server) in dialog 7c2f949d-894f-40d0-9416-efdcc646e866 - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(7c2f949d-894f-40d0-9416-efdcc646e866), transaction_id: z9hG4bK-64430-2-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-17T22:53:04.898718Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m565:[0m ✅ RFC 3261: ACK RECEIVED for session sess_7e8b8e81-7db9-4984-a110-0c36a616f14e - creating media session (UAS side)
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-3-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag003\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 3-64430@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6008 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 33, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 33, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 33, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 30, 38, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:05.374938Z[0m [32m INFO[0m ThreadId(16) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-3-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
Transaction loop starting for Key(z9hG4bK-64430-3-0:INVITE:server)
Initial state: Proceeding
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-64430-3-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
[2m2025-06-17T22:53:05.375281Z[0m [32m INFO[0m ThreadId(16) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog d1f5127e-1769-49b0-bae7-b1f22a4c0ea7 from INVITE request
🔍 INVITE HANDLER: Created early dialog d1f5127e-1769-49b0-bae7-b1f22a4c0ea7
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-64430-3-0:INVITE:server) with dialog d1f5127e-1769-49b0-bae7-b1f22a4c0ea7
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog d1f5127e-1769-49b0-bae7-b1f22a4c0ea7
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog d1f5127e-1769-49b0-bae7-b1f22a4c0ea7
[2m2025-06-17T22:53:05.375421Z[0m [32m INFO[0m ThreadId(16) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog d1f5127e-1769-49b0-bae7-b1f22a4c0ea7
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(d1f5127e-1769-49b0-bae7-b1f22a4c0ea7), transaction_id: z9hG4bK-64430-3-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-3-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag003")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("3-64430@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6008 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-17T22:53:05.375584Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m149:[0m handle_incoming_call called for dialog d1f5127e-1769-49b0-bae7-b1f22a4c0ea7
[2m2025-06-17T22:53:05.375605Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m155:[0m Incoming call from dialog d1f5127e-1769-49b0-bae7-b1f22a4c0ea7: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-17T22:53:05.375652Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m163:[0m Created session sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c for incoming call dialog d1f5127e-1769-49b0-bae7-b1f22a4c0ea7
[2m2025-06-17T22:53:05.375692Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m188:[0m Calling handler.on_incoming_call for session sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c
[2m2025-06-17T22:53:05.375713Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m82:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-17T22:53:05.375728Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m83:[0m 📞 [SIPp-Test-Server] Call ID: sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c
[2m2025-06-17T22:53:05.375745Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m94:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-17T22:53:05.375757Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m98:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating simple answer
[2m2025-06-17T22:53:05.375794Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m112:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-17T22:53:05.375810Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m200:[0m Handler decision for session sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c: Accept(Some("v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"))
[2m2025-06-17T22:53:05.375852Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call d1f5127e-1769-49b0-bae7-b1f22a4c0ea7
[2m2025-06-17T22:53:05.376075Z[0m [32m INFO[0m ThreadId(11) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-17T22:53:05.376297Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog d1f5127e-1769-49b0-bae7-b1f22a4c0ea7 local tag set to match response: tag-061664a20e7541b8a2fddcb3f76d4515
[2m2025-06-17T22:53:05.376324Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog d1f5127e-1769-49b0-bae7-b1f22a4c0ea7 transitioned to Confirmed state
[2m2025-06-17T22:53:05.376353Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog d1f5127e-1769-49b0-bae7-b1f22a4c0ea7
[2m2025-06-17T22:53:05.376378Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call d1f5127e-1769-49b0-bae7-b1f22a4c0ea7
[2m2025-06-17T22:53:05.376397Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m224:[0m Successfully answered incoming call for session sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(d1f5127e-1769-49b0-bae7-b1f22a4c0ea7), session_answer: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
[2m2025-06-17T22:53:05.376451Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m456:[0m Call answered for session sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c: d1f5127e-1769-49b0-bae7-b1f22a4c0ea7 (awaiting ACK per RFC 3261)
[2m2025-06-17T22:53:05.376471Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m470:[0m 📞 Call answered for session sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c - keeping in Initiating state until media ready
[2m2025-06-17T22:53:05.376484Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m473:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-64430-3-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-64430-3-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-64430-3-0:INVITE:server). Final state: Terminated
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-3-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag003\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-061664a20e7541b8a2fddcb3f76d4515\r\nCall-ID: 3-64430@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 33, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 33, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 30, 36, 31, 36, 36, 34, 61, 32, 30, 65, 37, 35, 34, 31, 62, 38, 61, 32, 66, 64, 64, 63, 62, 33, 66, 37, 36, 64, 34, 35, 31, 35, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 33, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 48, 54, 49, 54, 54, 52, 97, 50, 48, 101, 55, 53, 52, 49, 98, 56, 97, 50, 102, 100, 100, 99, 98, 51, 102, 55, 54, 100, 52, 53, 49, 53]
Successfully parsed tag: tag-061664a20e7541b8a2fddcb3f76d4515
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("SIPp Test"), "params": Array([Object({"Tag": String("64430SIPpTag003")})]), "uri": Object({"headers": Object({}), "host": Object({"Address": String("127.0.0.1")}), "scheme": String("Sip"), "password": Null, "raw_uri": Null, "port": Number(5061.0), "user": String("sipp"), "parameters": Array([])})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag003")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag003")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag003")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("SIPp Test"), "params": Array([Object({"Tag": String("64430SIPpTag003")})]), "uri": Object({"raw_uri": Null, "host": Object({"Address": String("127.0.0.1")}), "password": Null, "headers": Object({}), "port": Number(5061.0), "parameters": Array([]), "scheme": String("Sip"), "user": String("sipp")})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag003")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag003")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag003")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "params": Array([]), "uri": Object({"user": String("test"), "parameters": Array([]), "port": Number(5062.0), "scheme": String("Sip"), "headers": Object({}), "password": Null, "host": Object({"Address": String("127.0.0.1")}), "raw_uri": Null})})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "params": Array([Object({"Tag": String("tag-061664a20e7541b8a2fddcb3f76d4515")})]), "uri": Object({"user": String("test"), "port": Number(5062.0), "headers": Object({}), "parameters": Array([]), "scheme": String("Sip"), "host": Object({"Address": String("127.0.0.1")}), "raw_uri": Null, "password": Null})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-061664a20e7541b8a2fddcb3f76d4515")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-061664a20e7541b8a2fddcb3f76d4515")})
Final value for path 'headers.To.params[0].Tag': String("tag-061664a20e7541b8a2fddcb3f76d4515")
[2m2025-06-17T22:53:05.381428Z[0m [32m INFO[0m ThreadId(15) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-64430-3-0:INVITE:server) in dialog d1f5127e-1769-49b0-bae7-b1f22a4c0ea7 - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(d1f5127e-1769-49b0-bae7-b1f22a4c0ea7), transaction_id: z9hG4bK-64430-3-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-17T22:53:05.381558Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m565:[0m ✅ RFC 3261: ACK RECEIVED for session sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c - creating media session (UAS side)
[2m2025-06-17T22:53:05.395195Z[0m [32m INFO[0m ThreadId(11) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-17T22:53:05.395555Z[0m [32m INFO[0m ThreadId(11) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=6e20f1f7
[2m2025-06-17T22:53:05.395709Z[0m [32m INFO[0m ThreadId(11) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m339:[0m ✅ Created media session with REAL RTP session: media-sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997 (port: 19071)
[2m2025-06-17T22:53:05.395974Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m411:[0m ✅ Created media session: media-sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997 for SIP session: sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997 with real MediaSessionController + zero-copy enabled
[2m2025-06-17T22:53:05.396093Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m64:[0m Media session created and mapped for SIP session: sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997
[2m2025-06-17T22:53:05.396216Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m262:[0m Media info available: true
[2m2025-06-17T22:53:05.396284Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m264:[0m Local SDP length: None
[2m2025-06-17T22:53:05.396335Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m265:[0m Remote SDP length: None
[2m2025-06-17T22:53:05.396379Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m271:[0m Notifying handler about call sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997 establishment
[2m2025-06-17T22:53:05.396429Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/api/handlers.rs[0m[2m:[0m[2m231:[0m Call sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997 established
🎯 COORDINATOR: Handling event: SessionCreated { session_id: SessionId("sess_7e8b8e81-7db9-4984-a110-0c36a616f14e"), from: "sip:from@127.0.0.1", to: "sip:to@local", call_state: Ringing }
[2m2025-06-17T22:53:05.396546Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m224:[0m Session sess_7e8b8e81-7db9-4984-a110-0c36a616f14e created with state Ringing
🎯 COORDINATOR: Handling event: SdpEvent { session_id: SessionId("sess_7e8b8e81-7db9-4984-a110-0c36a616f14e"), event_type: "remote_sdp_answer", sdp: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
🎯 COORDINATOR: Handling event: MediaEvent { session_id: SessionId("sess_7e8b8e81-7db9-4984-a110-0c36a616f14e"), event: "rfc_compliant_media_creation_uas" }
[2m2025-06-17T22:53:05.396694Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m366:[0m Media creation event for sess_7e8b8e81-7db9-4984-a110-0c36a616f14e: rfc_compliant_media_creation_uas
🎯 COORDINATOR: Handling event: SessionCreated { session_id: SessionId("sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c"), from: "sip:from@127.0.0.1", to: "sip:to@local", call_state: Ringing }
[2m2025-06-17T22:53:05.396830Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m224:[0m Session sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c created with state Ringing
🎯 COORDINATOR: Handling event: SdpEvent { session_id: SessionId("sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c"), event_type: "remote_sdp_answer", sdp: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
🎯 COORDINATOR: Handling event: MediaEvent { session_id: SessionId("sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c"), event: "rfc_compliant_media_creation_uas" }
[2m2025-06-17T22:53:05.396940Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m366:[0m Media creation event for sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c: rfc_compliant_media_creation_uas
🎯 COORDINATOR: Handling event: StateChanged { session_id: SessionId("sess_7e8b8e81-7db9-4984-a110-0c36a616f14e"), old_state: Ringing, new_state: Active }
[2m2025-06-17T22:53:05.397042Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m248:[0m Session sess_7e8b8e81-7db9-4984-a110-0c36a616f14e state changed: Ringing -> Active
[2m2025-06-17T22:53:05.397131Z[0m [32m INFO[0m ThreadId(11) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m263:[0m Starting media session for dialog: media-sess_7e8b8e81-7db9-4984-a110-0c36a616f14e
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-4-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag004\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 4-64430@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6012 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 34, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 34, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 34, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 31, 32, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:05.875973Z[0m [32m INFO[0m ThreadId(11) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-4-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
Transaction loop starting for Key(z9hG4bK-64430-4-0:INVITE:server)
Initial state: Proceeding
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-64430-4-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
[2m2025-06-17T22:53:05.876184Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog 5154a912-5896-45b1-958f-95d411f1055c from INVITE request
🔍 INVITE HANDLER: Created early dialog 5154a912-5896-45b1-958f-95d411f1055c
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-64430-4-0:INVITE:server) with dialog 5154a912-5896-45b1-958f-95d411f1055c
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog 5154a912-5896-45b1-958f-95d411f1055c
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog 5154a912-5896-45b1-958f-95d411f1055c
[2m2025-06-17T22:53:05.876260Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog 5154a912-5896-45b1-958f-95d411f1055c
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(5154a912-5896-45b1-958f-95d411f1055c), transaction_id: z9hG4bK-64430-4-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-4-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag004")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("4-64430@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6012 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-17T22:53:05.876403Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m149:[0m handle_incoming_call called for dialog 5154a912-5896-45b1-958f-95d411f1055c
[2m2025-06-17T22:53:05.876433Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m155:[0m Incoming call from dialog 5154a912-5896-45b1-958f-95d411f1055c: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-17T22:53:05.876477Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m163:[0m Created session sess_236959a9-6556-4597-b29c-f9af4d56b505 for incoming call dialog 5154a912-5896-45b1-958f-95d411f1055c
[2m2025-06-17T22:53:05.876509Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m188:[0m Calling handler.on_incoming_call for session sess_236959a9-6556-4597-b29c-f9af4d56b505
[2m2025-06-17T22:53:05.876557Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m82:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-17T22:53:05.876574Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m83:[0m 📞 [SIPp-Test-Server] Call ID: sess_236959a9-6556-4597-b29c-f9af4d56b505
[2m2025-06-17T22:53:05.876609Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m94:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-17T22:53:05.876624Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m98:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating simple answer
[2m2025-06-17T22:53:05.876640Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m112:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-17T22:53:05.876655Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m200:[0m Handler decision for session sess_236959a9-6556-4597-b29c-f9af4d56b505: Accept(Some("v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"))
[2m2025-06-17T22:53:05.876710Z[0m [32m INFO[0m ThreadId(13) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call 5154a912-5896-45b1-958f-95d411f1055c
[2m2025-06-17T22:53:05.876903Z[0m [32m INFO[0m ThreadId(13) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-17T22:53:05.877096Z[0m [32m INFO[0m ThreadId(13) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog 5154a912-5896-45b1-958f-95d411f1055c local tag set to match response: tag-94087e7922ca41cf9e61082f15ee0ba0
[2m2025-06-17T22:53:05.877118Z[0m [32m INFO[0m ThreadId(13) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog 5154a912-5896-45b1-958f-95d411f1055c transitioned to Confirmed state
[2m2025-06-17T22:53:05.877147Z[0m [32m INFO[0m ThreadId(13) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog 5154a912-5896-45b1-958f-95d411f1055c
[2m2025-06-17T22:53:05.877171Z[0m [32m INFO[0m ThreadId(13) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call 5154a912-5896-45b1-958f-95d411f1055c
[2m2025-06-17T22:53:05.877189Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m224:[0m Successfully answered incoming call for session sess_236959a9-6556-4597-b29c-f9af4d56b505
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(5154a912-5896-45b1-958f-95d411f1055c), session_answer: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
[2m2025-06-17T22:53:05.877240Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m456:[0m Call answered for session sess_236959a9-6556-4597-b29c-f9af4d56b505: 5154a912-5896-45b1-958f-95d411f1055c (awaiting ACK per RFC 3261)
[2m2025-06-17T22:53:05.877260Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m470:[0m 📞 Call answered for session sess_236959a9-6556-4597-b29c-f9af4d56b505 - keeping in Initiating state until media ready
[2m2025-06-17T22:53:05.877273Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m473:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-64430-4-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-64430-4-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-64430-4-0:INVITE:server). Final state: Terminated
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-4-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag004\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-94087e7922ca41cf9e61082f15ee0ba0\r\nCall-ID: 4-64430@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 34, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 34, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 39, 34, 30, 38, 37, 65, 37, 39, 32, 32, 63, 61, 34, 31, 63, 66, 39, 65, 36, 31, 30, 38, 32, 66, 31, 35, 65, 65, 30, 62, 61, 30, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 34, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 57, 52, 48, 56, 55, 101, 55, 57, 50, 50, 99, 97, 52, 49, 99, 102, 57, 101, 54, 49, 48, 56, 50, 102, 49, 53, 101, 101, 48, 98, 97, 48]
Successfully parsed tag: tag-94087e7922ca41cf9e61082f15ee0ba0
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("64430SIPpTag004")})]), "display_name": String("SIPp Test"), "uri": Object({"parameters": Array([]), "host": Object({"Address": String("127.0.0.1")}), "port": Number(5061.0), "raw_uri": Null, "headers": Object({}), "user": String("sipp"), "scheme": String("Sip"), "password": Null})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag004")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag004")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag004")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("SIPp Test"), "uri": Object({"user": String("sipp"), "raw_uri": Null, "host": Object({"Address": String("127.0.0.1")}), "scheme": String("Sip"), "headers": Object({}), "password": Null, "parameters": Array([]), "port": Number(5061.0)}), "params": Array([Object({"Tag": String("64430SIPpTag004")})])})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag004")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag004")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag004")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"port": Number(5062.0), "host": Object({"Address": String("127.0.0.1")}), "headers": Object({}), "scheme": String("Sip"), "password": Null, "raw_uri": Null, "parameters": Array([]), "user": String("test")}), "display_name": String("Test User"), "params": Array([])})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"host": Object({"Address": String("127.0.0.1")}), "headers": Object({}), "port": Number(5062.0), "parameters": Array([]), "password": Null, "user": String("test"), "scheme": String("Sip"), "raw_uri": Null}), "display_name": String("Test User"), "params": Array([Object({"Tag": String("tag-94087e7922ca41cf9e61082f15ee0ba0")})])})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-94087e7922ca41cf9e61082f15ee0ba0")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-94087e7922ca41cf9e61082f15ee0ba0")})
Final value for path 'headers.To.params[0].Tag': String("tag-94087e7922ca41cf9e61082f15ee0ba0")
[2m2025-06-17T22:53:05.882681Z[0m [32m INFO[0m ThreadId(13) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-64430-4-0:INVITE:server) in dialog 5154a912-5896-45b1-958f-95d411f1055c - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(5154a912-5896-45b1-958f-95d411f1055c), transaction_id: z9hG4bK-64430-4-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-17T22:53:05.882818Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m565:[0m ✅ RFC 3261: ACK RECEIVED for session sess_236959a9-6556-4597-b29c-f9af4d56b505 - creating media session (UAS side)
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-5-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag005\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 5-64430@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6016 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 35, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 35, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 35, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 31, 36, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:06.379273Z[0m [32m INFO[0m ThreadId(13) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-5-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
Transaction loop starting for Key(z9hG4bK-64430-5-0:INVITE:server)
Initial state: Proceeding
[2m2025-06-17T22:53:06.379606Z[0m [32m INFO[0m ThreadId(13) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog 061e6342-a647-464d-9e0c-0cc890546cb3 from INVITE request
🔍 INVITE HANDLER: Created early dialog 061e6342-a647-464d-9e0c-0cc890546cb3
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-64430-5-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-64430-5-0:INVITE:server) with dialog 061e6342-a647-464d-9e0c-0cc890546cb3
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog 061e6342-a647-464d-9e0c-0cc890546cb3
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog 061e6342-a647-464d-9e0c-0cc890546cb3
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(061e6342-a647-464d-9e0c-0cc890546cb3), transaction_id: z9hG4bK-64430-5-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-5-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag005")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("5-64430@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6016 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-17T22:53:06.379877Z[0m [32m INFO[0m ThreadId(13) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog 061e6342-a647-464d-9e0c-0cc890546cb3
[2m2025-06-17T22:53:06.380147Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m149:[0m handle_incoming_call called for dialog 061e6342-a647-464d-9e0c-0cc890546cb3
[2m2025-06-17T22:53:06.380251Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m155:[0m Incoming call from dialog 061e6342-a647-464d-9e0c-0cc890546cb3: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-17T22:53:06.380338Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m163:[0m Created session sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1 for incoming call dialog 061e6342-a647-464d-9e0c-0cc890546cb3
[2m2025-06-17T22:53:06.380399Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m188:[0m Calling handler.on_incoming_call for session sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1
[2m2025-06-17T22:53:06.380434Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m82:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-17T22:53:06.380462Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m83:[0m 📞 [SIPp-Test-Server] Call ID: sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1
[2m2025-06-17T22:53:06.380491Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m94:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-17T22:53:06.380519Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m98:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating simple answer
[2m2025-06-17T22:53:06.380548Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m112:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-17T22:53:06.380572Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m200:[0m Handler decision for session sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1: Accept(Some("v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"))
[2m2025-06-17T22:53:06.380648Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call 061e6342-a647-464d-9e0c-0cc890546cb3
[2m2025-06-17T22:53:06.380926Z[0m [32m INFO[0m ThreadId(12) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-17T22:53:06.381195Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog 061e6342-a647-464d-9e0c-0cc890546cb3 local tag set to match response: tag-4ece14b27861411c8b7bf9f413257317
[2m2025-06-17T22:53:06.381240Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog 061e6342-a647-464d-9e0c-0cc890546cb3 transitioned to Confirmed state
[2m2025-06-17T22:53:06.381302Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog 061e6342-a647-464d-9e0c-0cc890546cb3
[2m2025-06-17T22:53:06.381354Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call 061e6342-a647-464d-9e0c-0cc890546cb3
[2m2025-06-17T22:53:06.381385Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m224:[0m Successfully answered incoming call for session sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(061e6342-a647-464d-9e0c-0cc890546cb3), session_answer: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
[2m2025-06-17T22:53:06.381477Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m456:[0m Call answered for session sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1: 061e6342-a647-464d-9e0c-0cc890546cb3 (awaiting ACK per RFC 3261)
[2m2025-06-17T22:53:06.381517Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m470:[0m 📞 Call answered for session sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1 - keeping in Initiating state until media ready
[2m2025-06-17T22:53:06.381550Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m473:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-64430-5-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-64430-5-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-64430-5-0:INVITE:server). Final state: Terminated
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-5-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag005\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-4ece14b27861411c8b7bf9f413257317\r\nCall-ID: 5-64430@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 35, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 35, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 34, 65, 63, 65, 31, 34, 62, 32, 37, 38, 36, 31, 34, 31, 31, 63, 38, 62, 37, 62, 66, 39, 66, 34, 31, 33, 32, 35, 37, 33, 31, 37, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 35, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 52, 101, 99, 101, 49, 52, 98, 50, 55, 56, 54, 49, 52, 49, 49, 99, 56, 98, 55, 98, 102, 57, 102, 52, 49, 51, 50, 53, 55, 51, 49, 55]
Successfully parsed tag: tag-4ece14b27861411c8b7bf9f413257317
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("SIPp Test"), "params": Array([Object({"Tag": String("64430SIPpTag005")})]), "uri": Object({"parameters": Array([]), "raw_uri": Null, "scheme": String("Sip"), "host": Object({"Address": String("127.0.0.1")}), "port": Number(5061.0), "password": Null, "user": String("sipp"), "headers": Object({})})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag005")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag005")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag005")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("64430SIPpTag005")})]), "uri": Object({"host": Object({"Address": String("127.0.0.1")}), "raw_uri": Null, "user": String("sipp"), "parameters": Array([]), "headers": Object({}), "port": Number(5061.0), "scheme": String("Sip"), "password": Null}), "display_name": String("SIPp Test")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag005")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag005")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag005")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([]), "display_name": String("Test User"), "uri": Object({"password": Null, "host": Object({"Address": String("127.0.0.1")}), "parameters": Array([]), "raw_uri": Null, "scheme": String("Sip"), "user": String("test"), "headers": Object({}), "port": Number(5062.0)})})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "params": Array([Object({"Tag": String("tag-4ece14b27861411c8b7bf9f413257317")})]), "uri": Object({"scheme": String("Sip"), "parameters": Array([]), "user": String("test"), "headers": Object({}), "port": Number(5062.0), "password": Null, "host": Object({"Address": String("127.0.0.1")}), "raw_uri": Null})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-4ece14b27861411c8b7bf9f413257317")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-4ece14b27861411c8b7bf9f413257317")})
Final value for path 'headers.To.params[0].Tag': String("tag-4ece14b27861411c8b7bf9f413257317")
[2m2025-06-17T22:53:06.390302Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-64430-5-0:INVITE:server) in dialog 061e6342-a647-464d-9e0c-0cc890546cb3 - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(061e6342-a647-464d-9e0c-0cc890546cb3), transaction_id: z9hG4bK-64430-5-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-17T22:53:06.390531Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m565:[0m ✅ RFC 3261: ACK RECEIVED for session sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1 - creating media session (UAS side)
[2m2025-06-17T22:53:06.400864Z[0m [32m INFO[0m ThreadId(12) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-17T22:53:06.401370Z[0m [32m INFO[0m ThreadId(12) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=5e95acba
[2m2025-06-17T22:53:06.401575Z[0m [32m INFO[0m ThreadId(12) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m339:[0m ✅ Created media session with REAL RTP session: media-sess_7e8b8e81-7db9-4984-a110-0c36a616f14e (port: 18238)
[2m2025-06-17T22:53:06.401701Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m411:[0m ✅ Created media session: media-sess_7e8b8e81-7db9-4984-a110-0c36a616f14e for SIP session: sess_7e8b8e81-7db9-4984-a110-0c36a616f14e with real MediaSessionController + zero-copy enabled
[2m2025-06-17T22:53:06.401792Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m64:[0m Media session created and mapped for SIP session: sess_7e8b8e81-7db9-4984-a110-0c36a616f14e
[2m2025-06-17T22:53:06.401879Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m262:[0m Media info available: true
[2m2025-06-17T22:53:06.401921Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m264:[0m Local SDP length: None
[2m2025-06-17T22:53:06.401951Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m265:[0m Remote SDP length: None
[2m2025-06-17T22:53:06.402219Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m271:[0m Notifying handler about call sess_7e8b8e81-7db9-4984-a110-0c36a616f14e establishment
[2m2025-06-17T22:53:06.402286Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/api/handlers.rs[0m[2m:[0m[2m231:[0m Call sess_7e8b8e81-7db9-4984-a110-0c36a616f14e established
🎯 COORDINATOR: Handling event: StateChanged { session_id: SessionId("sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c"), old_state: Ringing, new_state: Active }
[2m2025-06-17T22:53:06.402398Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m248:[0m Session sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c state changed: Ringing -> Active
[2m2025-06-17T22:53:06.402456Z[0m [32m INFO[0m ThreadId(12) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m263:[0m Starting media session for dialog: media-sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-6-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag006\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 6-64430@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6020 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 36, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 36, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 36, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 32, 30, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:06.875179Z[0m [32m INFO[0m ThreadId(12) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-6-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
[2m2025-06-17T22:53:06.875722Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog 1b7866eb-4dbd-445c-a849-b945864ade51 from INVITE request
🔍 INVITE HANDLER: Created early dialog 1b7866eb-4dbd-445c-a849-b945864ade51
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-64430-6-0:INVITE:server) with dialog 1b7866eb-4dbd-445c-a849-b945864ade51
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog 1b7866eb-4dbd-445c-a849-b945864ade51
Transaction loop starting for Key(z9hG4bK-64430-6-0:INVITE:server)
Initial state: Proceeding
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-64430-6-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog 1b7866eb-4dbd-445c-a849-b945864ade51
[2m2025-06-17T22:53:06.876677Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog 1b7866eb-4dbd-445c-a849-b945864ade51
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(1b7866eb-4dbd-445c-a849-b945864ade51), transaction_id: z9hG4bK-64430-6-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-6-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag006")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("6-64430@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6020 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-17T22:53:06.878441Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m149:[0m handle_incoming_call called for dialog 1b7866eb-4dbd-445c-a849-b945864ade51
[2m2025-06-17T22:53:06.878496Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m155:[0m Incoming call from dialog 1b7866eb-4dbd-445c-a849-b945864ade51: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-17T22:53:06.878555Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m163:[0m Created session sess_da2394aa-895b-4421-9950-42e222b144ba for incoming call dialog 1b7866eb-4dbd-445c-a849-b945864ade51
[2m2025-06-17T22:53:06.878602Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m188:[0m Calling handler.on_incoming_call for session sess_da2394aa-895b-4421-9950-42e222b144ba
[2m2025-06-17T22:53:06.878625Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m82:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-17T22:53:06.878640Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m83:[0m 📞 [SIPp-Test-Server] Call ID: sess_da2394aa-895b-4421-9950-42e222b144ba
[2m2025-06-17T22:53:06.878658Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m94:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-17T22:53:06.878671Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m98:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating simple answer
[2m2025-06-17T22:53:06.878686Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m112:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-17T22:53:06.878702Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m200:[0m Handler decision for session sess_da2394aa-895b-4421-9950-42e222b144ba: Accept(Some("v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"))
[2m2025-06-17T22:53:06.878744Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call 1b7866eb-4dbd-445c-a849-b945864ade51
[2m2025-06-17T22:53:06.878957Z[0m [32m INFO[0m ThreadId(12) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-17T22:53:06.879409Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog 1b7866eb-4dbd-445c-a849-b945864ade51 local tag set to match response: tag-773ad194bbfd40ca9661a1ae261c7479
[2m2025-06-17T22:53:06.880663Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog 1b7866eb-4dbd-445c-a849-b945864ade51 transitioned to Confirmed state
[2m2025-06-17T22:53:06.880731Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog 1b7866eb-4dbd-445c-a849-b945864ade51
[2m2025-06-17T22:53:06.880784Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call 1b7866eb-4dbd-445c-a849-b945864ade51
[2m2025-06-17T22:53:06.880812Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m224:[0m Successfully answered incoming call for session sess_da2394aa-895b-4421-9950-42e222b144ba
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(1b7866eb-4dbd-445c-a849-b945864ade51), session_answer: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
[2m2025-06-17T22:53:06.880883Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m456:[0m Call answered for session sess_da2394aa-895b-4421-9950-42e222b144ba: 1b7866eb-4dbd-445c-a849-b945864ade51 (awaiting ACK per RFC 3261)
[2m2025-06-17T22:53:06.880910Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m470:[0m 📞 Call answered for session sess_da2394aa-895b-4421-9950-42e222b144ba - keeping in Initiating state until media ready
=== PARSING SIP MESSAGE ===
[2m2025-06-17T22:53:06.880923Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m473:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Input length: 409 bytes
Input as string: Received command: CancelTimer100 for transaction Key(z9hG4bK-64430-6-0:INVITE:server)
"ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-6-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag006\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-773ad194bbfd40ca9661a1ae261c7479\r\nCall-ID: 6-64430@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-64430-6-0:INVITE:server)
70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 36, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 36, 0dProcessing TransitionTo(Terminated) current state: Proceeding
, 0a, 54, 6f, 3a, 20Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
, 54, 65, 73, 74, 20, 55, 73Sent StateChanged event result: Success
, 65, 72, Transaction loop ending for Key(z9hG4bK-64430-6-0:INVITE:server). Final state: Terminated
20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 37, 37, 33, 61, 64, 31, 39, 34, 62, 62, 66, 64, 34, 30, 63, 61, 39, 36, 36, 31, 61, 31, 61, 65, 32, 36, 31, 63, 37, 34, 37, 39, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 36, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 55, 55, 51, 97, 100, 49, 57, 52, 98, 98, 102, 100, 52, 48, 99, 97, 57, 54, 54, 49, 97, 49, 97, 101, 50, 54, 49, 99, 55, 52, 55, 57]
Successfully parsed tag: tag-773ad194bbfd40ca9661a1ae261c7479
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("SIPp Test"), "uri": Object({"headers": Object({}), "raw_uri": Null, "host": Object({"Address": String("127.0.0.1")}), "scheme": String("Sip"), "parameters": Array([]), "password": Null, "user": String("sipp"), "port": Number(5061.0)}), "params": Array([Object({"Tag": String("64430SIPpTag006")})])})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag006")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag006")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag006")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("64430SIPpTag006")})]), "uri": Object({"password": Null, "port": Number(5061.0), "headers": Object({}), "host": Object({"Address": String("127.0.0.1")}), "scheme": String("Sip"), "raw_uri": Null, "parameters": Array([]), "user": String("sipp")}), "display_name": String("SIPp Test")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag006")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag006")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag006")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "uri": Object({"parameters": Array([]), "scheme": String("Sip"), "raw_uri": Null, "user": String("test"), "headers": Object({}), "password": Null, "host": Object({"Address": String("127.0.0.1")}), "port": Number(5062.0)}), "params": Array([])})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"scheme": String("Sip"), "host": Object({"Address": String("127.0.0.1")}), "port": Number(5062.0), "parameters": Array([]), "password": Null, "user": String("test"), "raw_uri": Null, "headers": Object({})}), "display_name": String("Test User"), "params": Array([Object({"Tag": String("tag-773ad194bbfd40ca9661a1ae261c7479")})])})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-773ad194bbfd40ca9661a1ae261c7479")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-773ad194bbfd40ca9661a1ae261c7479")})
Final value for path 'headers.To.params[0].Tag': String("tag-773ad194bbfd40ca9661a1ae261c7479")
[2m2025-06-17T22:53:06.886612Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-64430-6-0:INVITE:server) in dialog 1b7866eb-4dbd-445c-a849-b945864ade51 - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(1b7866eb-4dbd-445c-a849-b945864ade51), transaction_id: z9hG4bK-64430-6-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-17T22:53:06.886851Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m565:[0m ✅ RFC 3261: ACK RECEIVED for session sess_da2394aa-895b-4421-9950-42e222b144ba - creating media session (UAS side)
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-7-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag007\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 7-64430@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6024 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 37, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 37, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 37, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 32, 34, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:07.381144Z[0m [32m INFO[0m ThreadId(12) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-7-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
Transaction loop starting for Key(z9hG4bK-64430-7-0:INVITE:server)
Initial state: Proceeding
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-64430-7-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
[2m2025-06-17T22:53:07.382587Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog aebb7079-4a6c-48df-86cf-7edbd1c358b2 from INVITE request
🔍 INVITE HANDLER: Created early dialog aebb7079-4a6c-48df-86cf-7edbd1c358b2
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-64430-7-0:INVITE:server) with dialog aebb7079-4a6c-48df-86cf-7edbd1c358b2
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog aebb7079-4a6c-48df-86cf-7edbd1c358b2
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog aebb7079-4a6c-48df-86cf-7edbd1c358b2
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(aebb7079-4a6c-48df-86cf-7edbd1c358b2), transaction_id: z9hG4bK-64430-7-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-7-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag007")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("7-64430@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6024 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-17T22:53:07.383468Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m149:[0m handle_incoming_call called for dialog aebb7079-4a6c-48df-86cf-7edbd1c358b2
[2m2025-06-17T22:53:07.383176Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog aebb7079-4a6c-48df-86cf-7edbd1c358b2
[2m2025-06-17T22:53:07.383553Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m155:[0m Incoming call from dialog aebb7079-4a6c-48df-86cf-7edbd1c358b2: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-17T22:53:07.383731Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m163:[0m Created session sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e for incoming call dialog aebb7079-4a6c-48df-86cf-7edbd1c358b2
[2m2025-06-17T22:53:07.383808Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m188:[0m Calling handler.on_incoming_call for session sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e
[2m2025-06-17T22:53:07.383862Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m82:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-17T22:53:07.383897Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m83:[0m 📞 [SIPp-Test-Server] Call ID: sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e
[2m2025-06-17T22:53:07.383936Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m94:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-17T22:53:07.383969Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m98:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating simple answer
[2m2025-06-17T22:53:07.384008Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m112:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-17T22:53:07.384050Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m200:[0m Handler decision for session sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e: Accept(Some("v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"))
[2m2025-06-17T22:53:07.384124Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call aebb7079-4a6c-48df-86cf-7edbd1c358b2
[2m2025-06-17T22:53:07.384435Z[0m [32m INFO[0m ThreadId(11) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-17T22:53:07.384832Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog aebb7079-4a6c-48df-86cf-7edbd1c358b2 local tag set to match response: tag-bc30462a2d57448faf19a752753626e9
[2m2025-06-17T22:53:07.384920Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog aebb7079-4a6c-48df-86cf-7edbd1c358b2 transitioned to Confirmed state
[2m2025-06-17T22:53:07.384987Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog aebb7079-4a6c-48df-86cf-7edbd1c358b2
[2m2025-06-17T22:53:07.385047Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call aebb7079-4a6c-48df-86cf-7edbd1c358b2
[2m2025-06-17T22:53:07.385097Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m224:[0m Successfully answered incoming call for session sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(aebb7079-4a6c-48df-86cf-7edbd1c358b2), session_answer: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
[2m2025-06-17T22:53:07.385237Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m456:[0m Call answered for session sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e: aebb7079-4a6c-48df-86cf-7edbd1c358b2 (awaiting ACK per RFC 3261)
[2m2025-06-17T22:53:07.385329Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m470:[0m 📞 Call answered for session sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e - keeping in Initiating state until media ready
[2m2025-06-17T22:53:07.385503Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m473:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-64430-7-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-64430-7-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-64430-7-0:INVITE:server). Final state: Terminated
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-7-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag007\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-bc30462a2d57448faf19a752753626e9\r\nCall-ID: 7-64430@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 37, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 37, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 62, 63, 33, 30, 34, 36, 32, 61, 32, 64, 35, 37, 34, 34, 38, 66, 61, 66, 31, 39, 61, 37, 35, 32, 37, 35, 33, 36, 32, 36, 65, 39, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 37, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 98, 99, 51, 48, 52, 54, 50, 97, 50, 100, 53, 55, 52, 52, 56, 102, 97, 102, 49, 57, 97, 55, 53, 50, 55, 53, 51, 54, 50, 54, 101, 57]
Successfully parsed tag: tag-bc30462a2d57448faf19a752753626e9
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"host": Object({"Address": String("127.0.0.1")}), "raw_uri": Null, "parameters": Array([]), "user": String("sipp"), "headers": Object({}), "password": Null, "port": Number(5061.0), "scheme": String("Sip")}), "params": Array([Object({"Tag": String("64430SIPpTag007")})]), "display_name": String("SIPp Test")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag007")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag007")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag007")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("64430SIPpTag007")})]), "uri": Object({"parameters": Array([]), "scheme": String("Sip"), "port": Number(5061.0), "host": Object({"Address": String("127.0.0.1")}), "headers": Object({}), "raw_uri": Null, "password": Null, "user": String("sipp")}), "display_name": String("SIPp Test")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag007")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag007")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag007")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"port": Number(5062.0), "raw_uri": Null, "parameters": Array([]), "password": Null, "scheme": String("Sip"), "user": String("test"), "host": Object({"Address": String("127.0.0.1")}), "headers": Object({})}), "display_name": String("Test User"), "params": Array([])})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
[2m2025-06-17T22:53:07.406268Z[0m [32m INFO[0m ThreadId(12) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-17T22:53:07.406489Z[0m [32m INFO[0m ThreadId(12) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=946abc99
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
[2m2025-06-17T22:53:07.406614Z[0m [32m INFO[0m ThreadId(12) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m339:[0m ✅ Created media session with REAL RTP session: media-sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c (port: 19245)
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "params": Array([Object({"Tag": String("tag-bc30462a2d57448faf19a752753626e9")})]), "uri": Object({"raw_uri": Null, "user": String("test"), "port": Number(5062.0), "host": Object({"Address": String("127.0.0.1")}), "password": Null, "headers": Object({}), "parameters": Array([]), "scheme": String("Sip")})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-bc30462a2d57448faf19a752753626e9")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-bc30462a2d57448faf19a752753626e9")})
Final value for path 'headers.To.params[0].Tag': String("tag-bc30462a2d57448faf19a752753626e9")
[2m2025-06-17T22:53:07.406746Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m411:[0m ✅ Created media session: media-sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c for SIP session: sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c with real MediaSessionController + zero-copy enabled
[2m2025-06-17T22:53:07.406931Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m64:[0m Media session created and mapped for SIP session: sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c
[2m2025-06-17T22:53:07.406952Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-64430-7-0:INVITE:server) in dialog aebb7079-4a6c-48df-86cf-7edbd1c358b2 - time to start media (UAS side)
[2m2025-06-17T22:53:07.407041Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m262:[0m Media info available: true
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(aebb7079-4a6c-48df-86cf-7edbd1c358b2), transaction_id: z9hG4bK-64430-7-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-17T22:53:07.407157Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m264:[0m Local SDP length: None
[2m2025-06-17T22:53:07.407277Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m565:[0m ✅ RFC 3261: ACK RECEIVED for session sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e - creating media session (UAS side)
[2m2025-06-17T22:53:07.407334Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m265:[0m Remote SDP length: None
[2m2025-06-17T22:53:07.407492Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m271:[0m Notifying handler about call sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c establishment
[2m2025-06-17T22:53:07.407538Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/api/handlers.rs[0m[2m:[0m[2m231:[0m Call sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c established
🎯 COORDINATOR: Handling event: SessionCreated { session_id: SessionId("sess_236959a9-6556-4597-b29c-f9af4d56b505"), from: "sip:from@127.0.0.1", to: "sip:to@local", call_state: Ringing }
[2m2025-06-17T22:53:07.407633Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m224:[0m Session sess_236959a9-6556-4597-b29c-f9af4d56b505 created with state Ringing
🎯 COORDINATOR: Handling event: SdpEvent { session_id: SessionId("sess_236959a9-6556-4597-b29c-f9af4d56b505"), event_type: "remote_sdp_answer", sdp: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
🎯 COORDINATOR: Handling event: MediaEvent { session_id: SessionId("sess_236959a9-6556-4597-b29c-f9af4d56b505"), event: "rfc_compliant_media_creation_uas" }
[2m2025-06-17T22:53:07.407773Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m366:[0m Media creation event for sess_236959a9-6556-4597-b29c-f9af4d56b505: rfc_compliant_media_creation_uas
🎯 COORDINATOR: Handling event: SessionCreated { session_id: SessionId("sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1"), from: "sip:from@127.0.0.1", to: "sip:to@local", call_state: Ringing }
[2m2025-06-17T22:53:07.407908Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m224:[0m Session sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1 created with state Ringing
🎯 COORDINATOR: Handling event: SdpEvent { session_id: SessionId("sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1"), event_type: "remote_sdp_answer", sdp: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
🎯 COORDINATOR: Handling event: MediaEvent { session_id: SessionId("sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1"), event: "rfc_compliant_media_creation_uas" }
[2m2025-06-17T22:53:07.408049Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m366:[0m Media creation event for sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1: rfc_compliant_media_creation_uas
🎯 COORDINATOR: Handling event: SessionCreated { session_id: SessionId("sess_da2394aa-895b-4421-9950-42e222b144ba"), from: "sip:from@127.0.0.1", to: "sip:to@local", call_state: Ringing }
[2m2025-06-17T22:53:07.408176Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m224:[0m Session sess_da2394aa-895b-4421-9950-42e222b144ba created with state Ringing
🎯 COORDINATOR: Handling event: SdpEvent { session_id: SessionId("sess_da2394aa-895b-4421-9950-42e222b144ba"), event_type: "remote_sdp_answer", sdp: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
🎯 COORDINATOR: Handling event: MediaEvent { session_id: SessionId("sess_da2394aa-895b-4421-9950-42e222b144ba"), event: "rfc_compliant_media_creation_uas" }
[2m2025-06-17T22:53:07.408314Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m366:[0m Media creation event for sess_da2394aa-895b-4421-9950-42e222b144ba: rfc_compliant_media_creation_uas
🎯 COORDINATOR: Handling event: SessionCreated { session_id: SessionId("sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e"), from: "sip:from@127.0.0.1", to: "sip:to@local", call_state: Ringing }
[2m2025-06-17T22:53:07.408492Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m224:[0m Session sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e created with state Ringing
🎯 COORDINATOR: Handling event: SdpEvent { session_id: SessionId("sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e"), event_type: "remote_sdp_answer", sdp: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
🎯 COORDINATOR: Handling event: MediaEvent { session_id: SessionId("sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e"), event: "rfc_compliant_media_creation_uas" }
[2m2025-06-17T22:53:07.408631Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m366:[0m Media creation event for sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e: rfc_compliant_media_creation_uas
🎯 COORDINATOR: Handling event: StateChanged { session_id: SessionId("sess_236959a9-6556-4597-b29c-f9af4d56b505"), old_state: Ringing, new_state: Active }
[2m2025-06-17T22:53:07.408755Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m248:[0m Session sess_236959a9-6556-4597-b29c-f9af4d56b505 state changed: Ringing -> Active
[2m2025-06-17T22:53:07.408827Z[0m [32m INFO[0m ThreadId(12) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m263:[0m Starting media session for dialog: media-sess_236959a9-6556-4597-b29c-f9af4d56b505
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-8-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag008\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 8-64430@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6028 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 38, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 38, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 38, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 32, 38, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:07.877236Z[0m [32m INFO[0m ThreadId(16) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-8-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
Transaction loop starting for Key(z9hG4bK-64430-8-0:INVITE:server)
Initial state: Proceeding
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-64430-8-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
[2m2025-06-17T22:53:07.877583Z[0m [32m INFO[0m ThreadId(16) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog 446ab149-9219-4a2b-befa-064f3671eda0 from INVITE request
🔍 INVITE HANDLER: Created early dialog 446ab149-9219-4a2b-befa-064f3671eda0
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-64430-8-0:INVITE:server) with dialog 446ab149-9219-4a2b-befa-064f3671eda0
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog 446ab149-9219-4a2b-befa-064f3671eda0
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog 446ab149-9219-4a2b-befa-064f3671eda0
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(446ab149-9219-4a2b-befa-064f3671eda0), transaction_id: z9hG4bK-64430-8-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-8-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag008")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("8-64430@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6028 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-17T22:53:07.877897Z[0m [32m INFO[0m ThreadId(16) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog 446ab149-9219-4a2b-befa-064f3671eda0
[2m2025-06-17T22:53:07.878157Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m149:[0m handle_incoming_call called for dialog 446ab149-9219-4a2b-befa-064f3671eda0
[2m2025-06-17T22:53:07.878298Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m155:[0m Incoming call from dialog 446ab149-9219-4a2b-befa-064f3671eda0: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-17T22:53:07.878424Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m163:[0m Created session sess_df07f161-5e7c-4868-bff1-43fe78257f34 for incoming call dialog 446ab149-9219-4a2b-befa-064f3671eda0
[2m2025-06-17T22:53:07.878494Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m188:[0m Calling handler.on_incoming_call for session sess_df07f161-5e7c-4868-bff1-43fe78257f34
[2m2025-06-17T22:53:07.878555Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m82:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-17T22:53:07.878593Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m83:[0m 📞 [SIPp-Test-Server] Call ID: sess_df07f161-5e7c-4868-bff1-43fe78257f34
[2m2025-06-17T22:53:07.878648Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m94:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-17T22:53:07.878692Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m98:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating simple answer
[2m2025-06-17T22:53:07.878729Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m112:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-17T22:53:07.878770Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m200:[0m Handler decision for session sess_df07f161-5e7c-4868-bff1-43fe78257f34: Accept(Some("v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"))
[2m2025-06-17T22:53:07.878915Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call 446ab149-9219-4a2b-befa-064f3671eda0
[2m2025-06-17T22:53:07.879220Z[0m [32m INFO[0m ThreadId(12) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-17T22:53:07.879459Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog 446ab149-9219-4a2b-befa-064f3671eda0 local tag set to match response: tag-86a57b4b7d39414e9ec6d9919fa0ef6b
[2m2025-06-17T22:53:07.879510Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog 446ab149-9219-4a2b-befa-064f3671eda0 transitioned to Confirmed state
[2m2025-06-17T22:53:07.879568Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog 446ab149-9219-4a2b-befa-064f3671eda0
[2m2025-06-17T22:53:07.879612Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call 446ab149-9219-4a2b-befa-064f3671eda0
[2m2025-06-17T22:53:07.879650Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m224:[0m Successfully answered incoming call for session sess_df07f161-5e7c-4868-bff1-43fe78257f34
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(446ab149-9219-4a2b-befa-064f3671eda0), session_answer: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
[2m2025-06-17T22:53:07.879750Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m456:[0m Call answered for session sess_df07f161-5e7c-4868-bff1-43fe78257f34: 446ab149-9219-4a2b-befa-064f3671eda0 (awaiting ACK per RFC 3261)
[2m2025-06-17T22:53:07.879795Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m470:[0m 📞 Call answered for session sess_df07f161-5e7c-4868-bff1-43fe78257f34 - keeping in Initiating state until media ready
[2m2025-06-17T22:53:07.879836Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m473:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-64430-8-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-64430-8-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-64430-8-0:INVITE:server). Final state: Terminated
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-8-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag008\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-86a57b4b7d39414e9ec6d9919fa0ef6b\r\nCall-ID: 8-64430@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 38, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 38, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 38, 36, 61, 35, 37, 62, 34, 62, 37, 64, 33, 39, 34, 31, 34, 65, 39, 65, 63, 36, 64, 39, 39, 31, 39, 66, 61, 30, 65, 66, 36, 62, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 38, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 56, 54, 97, 53, 55, 98, 52, 98, 55, 100, 51, 57, 52, 49, 52, 101, 57, 101, 99, 54, 100, 57, 57, 49, 57, 102, 97, 48, 101, 102, 54, 98]
Successfully parsed tag: tag-86a57b4b7d39414e9ec6d9919fa0ef6b
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("64430SIPpTag008")})]), "display_name": String("SIPp Test"), "uri": Object({"raw_uri": Null, "host": Object({"Address": String("127.0.0.1")}), "password": Null, "user": String("sipp"), "scheme": String("Sip"), "parameters": Array([]), "headers": Object({}), "port": Number(5061.0)})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag008")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag008")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag008")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"raw_uri": Null, "headers": Object({}), "scheme": String("Sip"), "host": Object({"Address": String("127.0.0.1")}), "user": String("sipp"), "parameters": Array([]), "password": Null, "port": Number(5061.0)}), "display_name": String("SIPp Test"), "params": Array([Object({"Tag": String("64430SIPpTag008")})])})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag008")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag008")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag008")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([]), "display_name": String("Test User"), "uri": Object({"user": String("test"), "host": Object({"Address": String("127.0.0.1")}), "port": Number(5062.0), "password": Null, "raw_uri": Null, "headers": Object({}), "parameters": Array([]), "scheme": String("Sip")})})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "params": Array([Object({"Tag": String("tag-86a57b4b7d39414e9ec6d9919fa0ef6b")})]), "uri": Object({"scheme": String("Sip"), "user": String("test"), "headers": Object({}), "raw_uri": Null, "port": Number(5062.0), "host": Object({"Address": String("127.0.0.1")}), "parameters": Array([]), "password": Null})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-86a57b4b7d39414e9ec6d9919fa0ef6b")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-86a57b4b7d39414e9ec6d9919fa0ef6b")})
Final value for path 'headers.To.params[0].Tag': String("tag-86a57b4b7d39414e9ec6d9919fa0ef6b")
[2m2025-06-17T22:53:07.890547Z[0m [32m INFO[0m ThreadId(15) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-64430-8-0:INVITE:server) in dialog 446ab149-9219-4a2b-befa-064f3671eda0 - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(446ab149-9219-4a2b-befa-064f3671eda0), transaction_id: z9hG4bK-64430-8-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-17T22:53:07.890753Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m565:[0m ✅ RFC 3261: ACK RECEIVED for session sess_df07f161-5e7c-4868-bff1-43fe78257f34 - creating media session (UAS side)
=== PARSING SIP MESSAGE ===
Input length: 590 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-9-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag009\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 9-64430@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6032 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 39, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 39, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 39, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 33, 32, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:08.371199Z[0m [32m INFO[0m ThreadId(11) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-9-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
Transaction loop starting for Key(z9hG4bK-64430-9-0:INVITE:server)
Initial state: Proceeding
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-64430-9-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
[2m2025-06-17T22:53:08.371594Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog 5edd632a-5a60-42ea-9e79-1138a32f9b29 from INVITE request
🔍 INVITE HANDLER: Created early dialog 5edd632a-5a60-42ea-9e79-1138a32f9b29
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-64430-9-0:INVITE:server) with dialog 5edd632a-5a60-42ea-9e79-1138a32f9b29
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog 5edd632a-5a60-42ea-9e79-1138a32f9b29
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog 5edd632a-5a60-42ea-9e79-1138a32f9b29
[2m2025-06-17T22:53:08.371699Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog 5edd632a-5a60-42ea-9e79-1138a32f9b29
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(5edd632a-5a60-42ea-9e79-1138a32f9b29), transaction_id: z9hG4bK-64430-9-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-9-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag009")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("9-64430@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6032 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-17T22:53:08.371829Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m149:[0m handle_incoming_call called for dialog 5edd632a-5a60-42ea-9e79-1138a32f9b29
[2m2025-06-17T22:53:08.371850Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m155:[0m Incoming call from dialog 5edd632a-5a60-42ea-9e79-1138a32f9b29: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-17T22:53:08.371895Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m163:[0m Created session sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c for incoming call dialog 5edd632a-5a60-42ea-9e79-1138a32f9b29
[2m2025-06-17T22:53:08.371938Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m188:[0m Calling handler.on_incoming_call for session sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c
[2m2025-06-17T22:53:08.371961Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m82:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-17T22:53:08.371976Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m83:[0m 📞 [SIPp-Test-Server] Call ID: sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c
[2m2025-06-17T22:53:08.371994Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m94:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-17T22:53:08.372006Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m98:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating simple answer
[2m2025-06-17T22:53:08.372021Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m112:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-17T22:53:08.372036Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m200:[0m Handler decision for session sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c: Accept(Some("v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"))
[2m2025-06-17T22:53:08.372077Z[0m [32m INFO[0m ThreadId(13) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call 5edd632a-5a60-42ea-9e79-1138a32f9b29
[2m2025-06-17T22:53:08.372306Z[0m [32m INFO[0m ThreadId(13) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-17T22:53:08.372478Z[0m [32m INFO[0m ThreadId(13) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog 5edd632a-5a60-42ea-9e79-1138a32f9b29 local tag set to match response: tag-f99e8b285ff44b53b399657467c61cda
[2m2025-06-17T22:53:08.372499Z[0m [32m INFO[0m ThreadId(13) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog 5edd632a-5a60-42ea-9e79-1138a32f9b29 transitioned to Confirmed state
[2m2025-06-17T22:53:08.372529Z[0m [32m INFO[0m ThreadId(13) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog 5edd632a-5a60-42ea-9e79-1138a32f9b29
[2m2025-06-17T22:53:08.372553Z[0m [32m INFO[0m ThreadId(13) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call 5edd632a-5a60-42ea-9e79-1138a32f9b29
[2m2025-06-17T22:53:08.372572Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m224:[0m Successfully answered incoming call for session sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(5edd632a-5a60-42ea-9e79-1138a32f9b29), session_answer: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
[2m2025-06-17T22:53:08.372624Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m456:[0m Call answered for session sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c: 5edd632a-5a60-42ea-9e79-1138a32f9b29 (awaiting ACK per RFC 3261)
[2m2025-06-17T22:53:08.372649Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m470:[0m 📞 Call answered for session sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c - keeping in Initiating state until media ready
[2m2025-06-17T22:53:08.372662Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m473:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-64430-9-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-64430-9-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-64430-9-0:INVITE:server). Final state: Terminated
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-9-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag009\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-f99e8b285ff44b53b399657467c61cda\r\nCall-ID: 9-64430@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 39, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 39, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 66, 39, 39, 65, 38, 62, 32, 38, 35, 66, 66, 34, 34, 62, 35, 33, 62, 33, 39, 39, 36, 35, 37, 34, 36, 37, 63, 36, 31, 63, 64, 61, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 39, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 102, 57, 57, 101, 56, 98, 50, 56, 53, 102, 102, 52, 52, 98, 53, 51, 98, 51, 57, 57, 54, 53, 55, 52, 54, 55, 99, 54, 49, 99, 100, 97]
Successfully parsed tag: tag-f99e8b285ff44b53b399657467c61cda
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("64430SIPpTag009")})]), "display_name": String("SIPp Test"), "uri": Object({"scheme": String("Sip"), "parameters": Array([]), "headers": Object({}), "port": Number(5061.0), "host": Object({"Address": String("127.0.0.1")}), "raw_uri": Null, "password": Null, "user": String("sipp")})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag009")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag009")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag009")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("SIPp Test"), "params": Array([Object({"Tag": String("64430SIPpTag009")})]), "uri": Object({"port": Number(5061.0), "raw_uri": Null, "user": String("sipp"), "password": Null, "host": Object({"Address": String("127.0.0.1")}), "scheme": String("Sip"), "parameters": Array([]), "headers": Object({})})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag009")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag009")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag009")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("Test User"), "params": Array([]), "uri": Object({"raw_uri": Null, "user": String("test"), "port": Number(5062.0), "scheme": String("Sip"), "parameters": Array([]), "password": Null, "headers": Object({}), "host": Object({"Address": String("127.0.0.1")})})})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"params": Array([Object({"Tag": String("tag-f99e8b285ff44b53b399657467c61cda")})]), "uri": Object({"user": String("test"), "raw_uri": Null, "scheme": String("Sip"), "headers": Object({}), "host": Object({"Address": String("127.0.0.1")}), "password": Null, "parameters": Array([]), "port": Number(5062.0)}), "display_name": String("Test User")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-f99e8b285ff44b53b399657467c61cda")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-f99e8b285ff44b53b399657467c61cda")})
Final value for path 'headers.To.params[0].Tag': String("tag-f99e8b285ff44b53b399657467c61cda")
[2m2025-06-17T22:53:08.377549Z[0m [32m INFO[0m ThreadId(15) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-64430-9-0:INVITE:server) in dialog 5edd632a-5a60-42ea-9e79-1138a32f9b29 - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(5edd632a-5a60-42ea-9e79-1138a32f9b29), transaction_id: z9hG4bK-64430-9-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-17T22:53:08.377677Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m565:[0m ✅ RFC 3261: ACK RECEIVED for session sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c - creating media session (UAS side)
[2m2025-06-17T22:53:08.413641Z[0m [32m INFO[0m ThreadId(16) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-17T22:53:08.413889Z[0m [32m INFO[0m ThreadId(16) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=48e4dcea
[2m2025-06-17T22:53:08.414046Z[0m [32m INFO[0m ThreadId(16) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m339:[0m ✅ Created media session with REAL RTP session: media-sess_236959a9-6556-4597-b29c-f9af4d56b505 (port: 19009)
[2m2025-06-17T22:53:08.414206Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m411:[0m ✅ Created media session: media-sess_236959a9-6556-4597-b29c-f9af4d56b505 for SIP session: sess_236959a9-6556-4597-b29c-f9af4d56b505 with real MediaSessionController + zero-copy enabled
[2m2025-06-17T22:53:08.414298Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m64:[0m Media session created and mapped for SIP session: sess_236959a9-6556-4597-b29c-f9af4d56b505
[2m2025-06-17T22:53:08.414388Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m262:[0m Media info available: true
[2m2025-06-17T22:53:08.414456Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m264:[0m Local SDP length: None
[2m2025-06-17T22:53:08.414500Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m265:[0m Remote SDP length: None
[2m2025-06-17T22:53:08.414543Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m271:[0m Notifying handler about call sess_236959a9-6556-4597-b29c-f9af4d56b505 establishment
[2m2025-06-17T22:53:08.414590Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/api/handlers.rs[0m[2m:[0m[2m231:[0m Call sess_236959a9-6556-4597-b29c-f9af4d56b505 established
🎯 COORDINATOR: Handling event: StateChanged { session_id: SessionId("sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1"), old_state: Ringing, new_state: Active }
[2m2025-06-17T22:53:08.414695Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m248:[0m Session sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1 state changed: Ringing -> Active
[2m2025-06-17T22:53:08.414764Z[0m [32m INFO[0m ThreadId(16) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m263:[0m Starting media session for dialog: media-sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1
=== PARSING SIP MESSAGE ===
Input length: 593 bytes
Input as string: "INVITE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-10-0\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag0010\r\nTo: Test User <sip:test@127.0.0.1:5062>\r\nCall-ID: 10-64430@127.0.0.1\r\nCSeq: 1 INVITE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Type: application/sdp\r\nContent-Length:   181\r\n\r\nv=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6036 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"
Input as hex: [49, 4e, 56, 49, 54, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 31, 30, 2d, 30, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 31, 30, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 31, 30, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 49, 4e, 56, 49, 54, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 54, 79, 70, 65, 3a, 20, 61, 70, 70, 6c, 69, 63, 61, 74, 69, 6f, 6e, 2f, 73, 64, 70, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 20, 20, 31, 38, 31, 0d, 0a, 0d, 0a, 76, 3d, 30, 0d, 0a, 6f, 3d, 75, 73, 65, 72, 31, 20, 35, 33, 36, 35, 35, 37, 36, 35, 20, 32, 33, 35, 33, 36, 38, 37, 36, 33, 37, 20, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 73, 3d, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 53, 65, 73, 73, 69, 6f, 6e, 0d, 0a, 63, 3d, 49, 4e, 20, 49, 50, 34, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 74, 3d, 30, 20, 30, 0d, 0a, 6d, 3d, 61, 75, 64, 69, 6f, 20, 36, 30, 33, 36, 20, 52, 54, 50, 2f, 41, 56, 50, 20, 30, 20, 38, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 30, 20, 50, 43, 4d, 55, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 72, 74, 70, 6d, 61, 70, 3a, 38, 20, 50, 43, 4d, 41, 2f, 38, 30, 30, 30, 0d, 0a, 61, 3d, 73, 65, 6e, 64, 72, 65, 63, 76, 0d, 0a]
===========================
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:08.872790Z[0m [32m INFO[0m ThreadId(15) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m1958:[0m Created new ServerInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-10-0:INVITE:server) [3mmethod[0m[2m=[0mINVITE
Transaction loop starting for Key(z9hG4bK-64430-10-0:INVITE:server)
Initial state: Proceeding
🎯 FOUND UNASSOCIATED INVITE: Processing new incoming INVITE from 127.0.0.1:5061
🔍 INVITE HANDLER: Processing initial INVITE request from 127.0.0.1:5061
Received command: TransitionTo(Proceeding) for transaction Key(z9hG4bK-64430-10-0:INVITE:server)
Processing TransitionTo(Proceeding) current state: Proceeding
Already in requested state, no transition needed: Proceeding
[2m2025-06-17T22:53:08.873050Z[0m [32m INFO[0m ThreadId(15) [2mcrates/dialog-core/src/manager/dialog_operations.rs[0m[2m:[0m[2m435:[0m Created early dialog 095523c4-7bdd-42ff-9c7d-f068f8f4bbe9 from INVITE request
🔍 INVITE HANDLER: Created early dialog 095523c4-7bdd-42ff-9c7d-f068f8f4bbe9
🔍 INVITE HANDLER: Associated transaction Key(z9hG4bK-64430-10-0:INVITE:server) with dialog 095523c4-7bdd-42ff-9c7d-f068f8f4bbe9
🔍 INVITE HANDLER: About to send SessionCoordinationEvent::IncomingCall for dialog 095523c4-7bdd-42ff-9c7d-f068f8f4bbe9
🔍 INVITE HANDLER: Successfully sent SessionCoordinationEvent::IncomingCall for dialog 095523c4-7bdd-42ff-9c7d-f068f8f4bbe9
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: IncomingCall { dialog_id: DialogId(095523c4-7bdd-42ff-9c7d-f068f8f4bbe9), transaction_id: z9hG4bK-64430-10-0:INVITE:server, request: Request { method: Invite, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-10-0")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag0010")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [] })), CallId(CallId("10-64430@127.0.0.1")), CSeq(CSeq { seq: 1, method: Invite }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentType(ContentType(ContentTypeValue { m_type: "application", m_subtype: "sdp", parameters: {} })), ContentLength(ContentLength(181))], body: b"v=0\r\no=user1 53655765 2353687637 IN IP4 127.0.0.1\r\ns=SIPp Test Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 6036 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }, source: 127.0.0.1:5061 }
[2m2025-06-17T22:53:08.873136Z[0m [32m INFO[0m ThreadId(15) [2mcrates/dialog-core/src/protocol/invite_handler.rs[0m[2m:[0m[2m101:[0m Initial INVITE processed, created dialog 095523c4-7bdd-42ff-9c7d-f068f8f4bbe9
[2m2025-06-17T22:53:08.873265Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m149:[0m handle_incoming_call called for dialog 095523c4-7bdd-42ff-9c7d-f068f8f4bbe9
[2m2025-06-17T22:53:08.873288Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m155:[0m Incoming call from dialog 095523c4-7bdd-42ff-9c7d-f068f8f4bbe9: sip:from@127.0.0.1 -> sip:to@local
[2m2025-06-17T22:53:08.873332Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m163:[0m Created session sess_bc0c004d-850c-45f8-8f54-43afbc1a2657 for incoming call dialog 095523c4-7bdd-42ff-9c7d-f068f8f4bbe9
[2m2025-06-17T22:53:08.873377Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m188:[0m Calling handler.on_incoming_call for session sess_bc0c004d-850c-45f8-8f54-43afbc1a2657
[2m2025-06-17T22:53:08.873403Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m82:[0m 📞 [SIPp-Test-Server] Incoming call from sip:from@127.0.0.1 to sip:to@local
[2m2025-06-17T22:53:08.873418Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m83:[0m 📞 [SIPp-Test-Server] Call ID: sess_bc0c004d-850c-45f8-8f54-43afbc1a2657
[2m2025-06-17T22:53:08.873438Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m94:[0m ✅ [SIPp-Test-Server] Auto-answering call
[2m2025-06-17T22:53:08.873454Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m98:[0m 📞 [SIPp-Test-Server] Received SDP offer, generating simple answer
[2m2025-06-17T22:53:08.873472Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m112:[0m 📞 [SIPp-Test-Server] Generated SDP answer
[2m2025-06-17T22:53:08.873491Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m200:[0m Handler decision for session sess_bc0c004d-850c-45f8-8f54-43afbc1a2657: Accept(Some("v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n"))
[2m2025-06-17T22:53:08.873550Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m537:[0m Answering call 095523c4-7bdd-42ff-9c7d-f068f8f4bbe9
[2m2025-06-17T22:53:08.873820Z[0m [32m INFO[0m ThreadId(12) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-17T22:53:08.874168Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m628:[0m Dialog 095523c4-7bdd-42ff-9c7d-f068f8f4bbe9 local tag set to match response: tag-f6081a22fe7f4ea0a8e45bade9759d7e
[2m2025-06-17T22:53:08.874293Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m640:[0m Dialog 095523c4-7bdd-42ff-9c7d-f068f8f4bbe9 transitioned to Confirmed state
[2m2025-06-17T22:53:08.874367Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m647:[0m Updated dialog lookup for confirmed dialog 095523c4-7bdd-42ff-9c7d-f068f8f4bbe9
[2m2025-06-17T22:53:08.874407Z[0m [32m INFO[0m ThreadId(12) [2mcrates/dialog-core/src/api/common.rs[0m[2m:[0m[2m661:[0m Successfully answered call 095523c4-7bdd-42ff-9c7d-f068f8f4bbe9
[2m2025-06-17T22:53:08.874480Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m224:[0m Successfully answered incoming call for session sess_bc0c004d-850c-45f8-8f54-43afbc1a2657
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallAnswered { dialog_id: DialogId(095523c4-7bdd-42ff-9c7d-f068f8f4bbe9), session_answer: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
[2m2025-06-17T22:53:08.874558Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m456:[0m Call answered for session sess_bc0c004d-850c-45f8-8f54-43afbc1a2657: 095523c4-7bdd-42ff-9c7d-f068f8f4bbe9 (awaiting ACK per RFC 3261)
[2m2025-06-17T22:53:08.874585Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m470:[0m 📞 Call answered for session sess_bc0c004d-850c-45f8-8f54-43afbc1a2657 - keeping in Initiating state until media ready
[2m2025-06-17T22:53:08.874599Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m473:[0m 🚫 RFC 3261: NOT creating media session yet - waiting for ACK
Received command: CancelTimer100 for transaction Key(z9hG4bK-64430-10-0:INVITE:server)
Received command: TransitionTo(Terminated) for transaction Key(z9hG4bK-64430-10-0:INVITE:server)
Processing TransitionTo(Terminated) current state: Proceeding
Valid state transition: Proceeding -> Terminated
State successfully changed to: Terminated
Sent StateChanged event result: Success
Transaction loop ending for Key(z9hG4bK-64430-10-0:INVITE:server). Final state: Terminated
=== PARSING SIP MESSAGE ===
Input length: 412 bytes
Input as string: "ACK sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-10-4\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag0010\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-f6081a22fe7f4ea0a8e45bade9759d7e\r\nCall-ID: 10-64430@127.0.0.1\r\nCSeq: 1 ACK\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [41, 43, 4b, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 31, 30, 2d, 34, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 31, 30, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 66, 36, 30, 38, 31, 61, 32, 32, 66, 65, 37, 66, 34, 65, 61, 30, 61, 38, 65, 34, 35, 62, 61, 64, 65, 39, 37, 35, 39, 64, 37, 65, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 31, 30, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 31, 20, 41, 43, 4b, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 102, 54, 48, 56, 49, 97, 50, 50, 102, 101, 55, 102, 52, 101, 97, 48, 97, 56, 101, 52, 53, 98, 97, 100, 101, 57, 55, 53, 57, 100, 55, 101]
Successfully parsed tag: tag-f6081a22fe7f4ea0a8e45bade9759d7e
=== PARSE SUCCESS ===
Successfully parsed message
=====================
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("SIPp Test"), "params": Array([Object({"Tag": String("64430SIPpTag0010")})]), "uri": Object({"host": Object({"Address": String("127.0.0.1")}), "raw_uri": Null, "headers": Object({}), "password": Null, "scheme": String("Sip"), "port": Number(5061.0), "parameters": Array([]), "user": String("sipp")})})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag0010")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag0010")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag0010")
Parsed path: [Field("headers"), Field("From"), Field("params"), Index(0), Field("Tag")] from 'headers.From.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"display_name": String("SIPp Test"), "uri": Object({"user": String("sipp"), "parameters": Array([]), "scheme": String("Sip"), "host": Object({"Address": String("127.0.0.1")}), "headers": Object({}), "raw_uri": Null, "port": Number(5061.0), "password": Null}), "params": Array([Object({"Tag": String("64430SIPpTag0010")})])})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("64430SIPpTag0010")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("64430SIPpTag0010")})
Final value for path 'headers.From.params[0].Tag': String("64430SIPpTag0010")
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"scheme": String("Sip"), "parameters": Array([]), "host": Object({"Address": String("127.0.0.1")}), "port": Number(5062.0), "user": String("test"), "raw_uri": Null, "password": Null, "headers": Object({})}), "display_name": String("Test User"), "params": Array([])})
Processing segment Index(0) at index 3, current value: Array([])
Index 0 out of bounds for array of length 0
Parsed path: [Field("headers"), Field("To"), Field("params"), Index(0), Field("Tag")] from 'headers.To.params[0].Tag'
Processing segment Field("params") at index 2, current value: Object({"uri": Object({"parameters": Array([]), "port": Number(5062.0), "host": Object({"Address": String("127.0.0.1")}), "user": String("test"), "raw_uri": Null, "headers": Object({}), "scheme": String("Sip"), "password": Null}), "params": Array([Object({"Tag": String("tag-f6081a22fe7f4ea0a8e45bade9759d7e")})]), "display_name": String("Test User")})
Processing segment Index(0) at index 3, current value: Array([Object({"Tag": String("tag-f6081a22fe7f4ea0a8e45bade9759d7e")})])
Processing segment Field("Tag") at index 4, current value: Object({"Tag": String("tag-f6081a22fe7f4ea0a8e45bade9759d7e")})
Final value for path 'headers.To.params[0].Tag': String("tag-f6081a22fe7f4ea0a8e45bade9759d7e")
[2m2025-06-17T22:53:08.879329Z[0m [32m INFO[0m ThreadId(16) [2mcrates/dialog-core/src/manager/transaction_integration.rs[0m[2m:[0m[2m758:[0m ✅ RFC 3261: ACK received for transaction Key(z9hG4bK-64430-10-0:INVITE:server) in dialog 095523c4-7bdd-42ff-9c7d-f068f8f4bbe9 - time to start media (UAS side)
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: AckReceived { dialog_id: DialogId(095523c4-7bdd-42ff-9c7d-f068f8f4bbe9), transaction_id: z9hG4bK-64430-10-0:INVITE:server, negotiated_sdp: None }
[2m2025-06-17T22:53:08.879435Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m565:[0m ✅ RFC 3261: ACK RECEIVED for session sess_bc0c004d-850c-45f8-8f54-43afbc1a2657 - creating media session (UAS side)
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-1-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag001\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-18c514e732bb4fc79e1ee6ca5aab8280\r\nCall-ID: 1-64430@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 31, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 31, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 31, 38, 63, 35, 31, 34, 65, 37, 33, 32, 62, 62, 34, 66, 63, 37, 39, 65, 31, 65, 65, 36, 63, 61, 35, 61, 61, 62, 38, 32, 38, 30, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 31, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 49, 56, 99, 53, 49, 52, 101, 55, 51, 50, 98, 98, 52, 102, 99, 55, 57, 101, 49, 101, 101, 54, 99, 97, 53, 97, 97, 98, 56, 50, 56, 48]
Successfully parsed tag: tag-18c514e732bb4fc79e1ee6ca5aab8280
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:09.390750Z[0m [32m INFO[0m ThreadId(15) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-1-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-64430-1-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-64430-1-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-1-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag001")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-18c514e732bb4fc79e1ee6ca5aab8280")] })), CallId(CallId("1-64430@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-64430-1-7:BYE:server)
[2m2025-06-17T22:53:09.391549Z[0m [32m INFO[0m ThreadId(15) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-64430-1-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
Valid state transition: Trying -> Completed
State successfully changed to: Completed
[2m2025-06-17T22:53:09.391990Z[0m [32m INFO[0m ThreadId(15) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog c41766b9-d079-4a05-8d04-e141c6cf7cac
Sent StateChanged event result: Success
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(c41766b9-d079-4a05-8d04-e141c6cf7cac), reason: "BYE received" }
[2m2025-06-17T22:53:09.392468Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m639:[0m handle_call_terminated called for dialog c41766b9-d079-4a05-8d04-e141c6cf7cac: BYE received
[2m2025-06-17T22:53:09.392551Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m642:[0m Call terminated for session sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997: c41766b9-d079-4a05-8d04-e141c6cf7cac - BYE received
[2m2025-06-17T22:53:09.419850Z[0m [32m INFO[0m ThreadId(15) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-17T22:53:09.420015Z[0m [32m INFO[0m ThreadId(15) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=2586c4ef
[2m2025-06-17T22:53:09.420086Z[0m [32m INFO[0m ThreadId(15) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m339:[0m ✅ Created media session with REAL RTP session: media-sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1 (port: 20482)
[2m2025-06-17T22:53:09.420153Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m411:[0m ✅ Created media session: media-sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1 for SIP session: sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1 with real MediaSessionController + zero-copy enabled
[2m2025-06-17T22:53:09.420181Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m64:[0m Media session created and mapped for SIP session: sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1
[2m2025-06-17T22:53:09.420225Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m262:[0m Media info available: true
[2m2025-06-17T22:53:09.420245Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m264:[0m Local SDP length: None
[2m2025-06-17T22:53:09.420259Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m265:[0m Remote SDP length: None
[2m2025-06-17T22:53:09.420272Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m271:[0m Notifying handler about call sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1 establishment
[2m2025-06-17T22:53:09.420289Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/api/handlers.rs[0m[2m:[0m[2m231:[0m Call sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1 established
🎯 COORDINATOR: Handling event: StateChanged { session_id: SessionId("sess_da2394aa-895b-4421-9950-42e222b144ba"), old_state: Ringing, new_state: Active }
[2m2025-06-17T22:53:09.420343Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m248:[0m Session sess_da2394aa-895b-4421-9950-42e222b144ba state changed: Ringing -> Active
[2m2025-06-17T22:53:09.420375Z[0m [32m INFO[0m ThreadId(15) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m263:[0m Starting media session for dialog: media-sess_da2394aa-895b-4421-9950-42e222b144ba
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-2-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag002\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-cfb0be2323624ddd83a12259a00b9f43\r\nCall-ID: 2-64430@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 32, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 32, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 63, 66, 62, 30, 62, 65, 32, 33, 32, 33, 36, 32, 34, 64, 64, 64, 38, 33, 61, 31, 32, 32, 35, 39, 61, 30, 30, 62, 39, 66, 34, 33, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 32, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 99, 102, 98, 48, 98, 101, 50, 51, 50, 51, 54, 50, 52, 100, 100, 100, 56, 51, 97, 49, 50, 50, 53, 57, 97, 48, 48, 98, 57, 102, 52, 51]
Successfully parsed tag: tag-cfb0be2323624ddd83a12259a00b9f43
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:09.895274Z[0m [32m INFO[0m ThreadId(10) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-2-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-64430-2-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-64430-2-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-2-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag002")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-cfb0be2323624ddd83a12259a00b9f43")] })), CallId(CallId("2-64430@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-64430-2-7:BYE:server)
[2m2025-06-17T22:53:09.895798Z[0m [32m INFO[0m ThreadId(10) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-64430-2-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
Valid state transition: Trying -> Completed
State successfully changed to: Completed
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(7c2f949d-894f-40d0-9416-efdcc646e866), reason: "BYE received" }
[2m2025-06-17T22:53:09.896110Z[0m [32m INFO[0m ThreadId(10) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog 7c2f949d-894f-40d0-9416-efdcc646e866
Sent StateChanged event result: Success
[2m2025-06-17T22:53:09.896387Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m639:[0m handle_call_terminated called for dialog 7c2f949d-894f-40d0-9416-efdcc646e866: BYE received
[2m2025-06-17T22:53:09.896593Z[0m [32m INFO[0m ThreadId(12) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m642:[0m Call terminated for session sess_7e8b8e81-7db9-4984-a110-0c36a616f14e: 7c2f949d-894f-40d0-9416-efdcc646e866 - BYE received
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-3-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag003\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-061664a20e7541b8a2fddcb3f76d4515\r\nCall-ID: 3-64430@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 33, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 33, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 30, 36, 31, 36, 36, 34, 61, 32, 30, 65, 37, 35, 34, 31, 62, 38, 61, 32, 66, 64, 64, 63, 62, 33, 66, 37, 36, 64, 34, 35, 31, 35, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 33, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 48, 54, 49, 54, 54, 52, 97, 50, 48, 101, 55, 53, 52, 49, 98, 56, 97, 50, 102, 100, 100, 99, 98, 51, 102, 55, 54, 100, 52, 53, 49, 53]
Successfully parsed tag: tag-061664a20e7541b8a2fddcb3f76d4515
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:10.387688Z[0m [32m INFO[0m ThreadId(15) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-3-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-64430-3-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-64430-3-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-3-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag003")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-061664a20e7541b8a2fddcb3f76d4515")] })), CallId(CallId("3-64430@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-64430-3-7:BYE:server)
[2m2025-06-17T22:53:10.388211Z[0m [32m INFO[0m ThreadId(15) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-17T22:53:10.388560Z[0m [32m INFO[0m ThreadId(15) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog d1f5127e-1769-49b0-bae7-b1f22a4c0ea7
📨 EVENT LOOP: Received session coordination event in background task
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-64430-3-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
Valid state transition: Trying -> Completed
State successfully changed to: Completed
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(d1f5127e-1769-49b0-bae7-b1f22a4c0ea7), reason: "BYE received" }
[2m2025-06-17T22:53:10.388885Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m639:[0m handle_call_terminated called for dialog d1f5127e-1769-49b0-bae7-b1f22a4c0ea7: BYE received
Sent StateChanged event result: Success
[2m2025-06-17T22:53:10.388937Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m642:[0m Call terminated for session sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c: d1f5127e-1769-49b0-bae7-b1f22a4c0ea7 - BYE received
[2m2025-06-17T22:53:10.427662Z[0m [32m INFO[0m ThreadId(16) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-17T22:53:10.427959Z[0m [32m INFO[0m ThreadId(16) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=f10f3893
[2m2025-06-17T22:53:10.428101Z[0m [32m INFO[0m ThreadId(16) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m339:[0m ✅ Created media session with REAL RTP session: media-sess_da2394aa-895b-4421-9950-42e222b144ba (port: 18258)
[2m2025-06-17T22:53:10.428239Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m411:[0m ✅ Created media session: media-sess_da2394aa-895b-4421-9950-42e222b144ba for SIP session: sess_da2394aa-895b-4421-9950-42e222b144ba with real MediaSessionController + zero-copy enabled
[2m2025-06-17T22:53:10.428329Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m64:[0m Media session created and mapped for SIP session: sess_da2394aa-895b-4421-9950-42e222b144ba
[2m2025-06-17T22:53:10.428437Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m262:[0m Media info available: true
[2m2025-06-17T22:53:10.428502Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m264:[0m Local SDP length: None
[2m2025-06-17T22:53:10.428551Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m265:[0m Remote SDP length: None
[2m2025-06-17T22:53:10.428599Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m271:[0m Notifying handler about call sess_da2394aa-895b-4421-9950-42e222b144ba establishment
[2m2025-06-17T22:53:10.428646Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/api/handlers.rs[0m[2m:[0m[2m231:[0m Call sess_da2394aa-895b-4421-9950-42e222b144ba established
🎯 COORDINATOR: Handling event: StateChanged { session_id: SessionId("sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e"), old_state: Ringing, new_state: Active }
[2m2025-06-17T22:53:10.428763Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m248:[0m Session sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e state changed: Ringing -> Active
[2m2025-06-17T22:53:10.428839Z[0m [32m INFO[0m ThreadId(16) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m263:[0m Starting media session for dialog: media-sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-4-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag004\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-94087e7922ca41cf9e61082f15ee0ba0\r\nCall-ID: 4-64430@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 34, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 34, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 39, 34, 30, 38, 37, 65, 37, 39, 32, 32, 63, 61, 34, 31, 63, 66, 39, 65, 36, 31, 30, 38, 32, 66, 31, 35, 65, 65, 30, 62, 61, 30, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 34, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 57, 52, 48, 56, 55, 101, 55, 57, 50, 50, 99, 97, 52, 49, 99, 102, 57, 101, 54, 49, 48, 56, 50, 102, 49, 53, 101, 101, 48, 98, 97, 48]
Successfully parsed tag: tag-94087e7922ca41cf9e61082f15ee0ba0
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:10.893108Z[0m [32m INFO[0m ThreadId(16) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-4-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-64430-4-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-64430-4-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-4-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag004")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-94087e7922ca41cf9e61082f15ee0ba0")] })), CallId(CallId("4-64430@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-64430-4-7:BYE:server)
[2m2025-06-17T22:53:10.893769Z[0m [32m INFO[0m ThreadId(16) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-17T22:53:10.894069Z[0m [32m INFO[0m ThreadId(16) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog 5154a912-5896-45b1-958f-95d411f1055c
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-64430-4-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
📨 EVENT LOOP: Received session coordination event in background task
Valid state transition: Trying -> Completed
State successfully changed to: Completed
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(5154a912-5896-45b1-958f-95d411f1055c), reason: "BYE received" }
Sent StateChanged event result: Success
[2m2025-06-17T22:53:10.894561Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m639:[0m handle_call_terminated called for dialog 5154a912-5896-45b1-958f-95d411f1055c: BYE received
[2m2025-06-17T22:53:10.894652Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m642:[0m Call terminated for session sess_236959a9-6556-4597-b29c-f9af4d56b505: 5154a912-5896-45b1-958f-95d411f1055c - BYE received
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-5-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag005\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-4ece14b27861411c8b7bf9f413257317\r\nCall-ID: 5-64430@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 35, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 35, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 34, 65, 63, 65, 31, 34, 62, 32, 37, 38, 36, 31, 34, 31, 31, 63, 38, 62, 37, 62, 66, 39, 66, 34, 31, 33, 32, 35, 37, 33, 31, 37, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 35, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 52, 101, 99, 101, 49, 52, 98, 50, 55, 56, 54, 49, 52, 49, 49, 99, 56, 98, 55, 98, 102, 57, 102, 52, 49, 51, 50, 53, 55, 51, 49, 55]
Successfully parsed tag: tag-4ece14b27861411c8b7bf9f413257317
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:11.391583Z[0m [32m INFO[0m ThreadId(09) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-5-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-64430-5-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-64430-5-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-5-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag005")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-4ece14b27861411c8b7bf9f413257317")] })), CallId(CallId("5-64430@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-64430-5-7:BYE:server)
[2m2025-06-17T22:53:11.392129Z[0m [32m INFO[0m ThreadId(09) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
[2m2025-06-17T22:53:11.392595Z[0m [32m INFO[0m ThreadId(09) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog 061e6342-a647-464d-9e0c-0cc890546cb3
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(061e6342-a647-464d-9e0c-0cc890546cb3), reason: "BYE received" }
[2m2025-06-17T22:53:11.392836Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m639:[0m handle_call_terminated called for dialog 061e6342-a647-464d-9e0c-0cc890546cb3: BYE received
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-64430-5-7:BYE:server)
[2m2025-06-17T22:53:11.392906Z[0m [32m INFO[0m ThreadId(09) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m642:[0m Call terminated for session sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1: 061e6342-a647-464d-9e0c-0cc890546cb3 - BYE received
Processing TransitionTo(Completed) current state: Trying
Valid state transition: Trying -> Completed
State successfully changed to: Completed
Sent StateChanged event result: Success
[2m2025-06-17T22:53:11.431939Z[0m [32m INFO[0m ThreadId(16) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-17T22:53:11.432193Z[0m [32m INFO[0m ThreadId(16) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=0c44dd7c
[2m2025-06-17T22:53:11.432330Z[0m [32m INFO[0m ThreadId(16) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m339:[0m ✅ Created media session with REAL RTP session: media-sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e (port: 23345)
[2m2025-06-17T22:53:11.432459Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m411:[0m ✅ Created media session: media-sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e for SIP session: sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e with real MediaSessionController + zero-copy enabled
[2m2025-06-17T22:53:11.432548Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m64:[0m Media session created and mapped for SIP session: sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e
[2m2025-06-17T22:53:11.432650Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m262:[0m Media info available: true
[2m2025-06-17T22:53:11.432722Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m264:[0m Local SDP length: None
[2m2025-06-17T22:53:11.432772Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m265:[0m Remote SDP length: None
[2m2025-06-17T22:53:11.432818Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m271:[0m Notifying handler about call sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e establishment
[2m2025-06-17T22:53:11.432868Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/api/handlers.rs[0m[2m:[0m[2m231:[0m Call sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e established
🎯 COORDINATOR: Handling event: SessionCreated { session_id: SessionId("sess_df07f161-5e7c-4868-bff1-43fe78257f34"), from: "sip:from@127.0.0.1", to: "sip:to@local", call_state: Ringing }
[2m2025-06-17T22:53:11.432999Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m224:[0m Session sess_df07f161-5e7c-4868-bff1-43fe78257f34 created with state Ringing
🎯 COORDINATOR: Handling event: SdpEvent { session_id: SessionId("sess_df07f161-5e7c-4868-bff1-43fe78257f34"), event_type: "remote_sdp_answer", sdp: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
🎯 COORDINATOR: Handling event: MediaEvent { session_id: SessionId("sess_df07f161-5e7c-4868-bff1-43fe78257f34"), event: "rfc_compliant_media_creation_uas" }
[2m2025-06-17T22:53:11.433188Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m366:[0m Media creation event for sess_df07f161-5e7c-4868-bff1-43fe78257f34: rfc_compliant_media_creation_uas
🎯 COORDINATOR: Handling event: SessionCreated { session_id: SessionId("sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c"), from: "sip:from@127.0.0.1", to: "sip:to@local", call_state: Ringing }
[2m2025-06-17T22:53:11.433335Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m224:[0m Session sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c created with state Ringing
🎯 COORDINATOR: Handling event: SdpEvent { session_id: SessionId("sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c"), event_type: "remote_sdp_answer", sdp: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
🎯 COORDINATOR: Handling event: MediaEvent { session_id: SessionId("sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c"), event: "rfc_compliant_media_creation_uas" }
[2m2025-06-17T22:53:11.433504Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m366:[0m Media creation event for sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c: rfc_compliant_media_creation_uas
🎯 COORDINATOR: Handling event: SessionCreated { session_id: SessionId("sess_bc0c004d-850c-45f8-8f54-43afbc1a2657"), from: "sip:from@127.0.0.1", to: "sip:to@local", call_state: Ringing }
[2m2025-06-17T22:53:11.433637Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m224:[0m Session sess_bc0c004d-850c-45f8-8f54-43afbc1a2657 created with state Ringing
🎯 COORDINATOR: Handling event: SdpEvent { session_id: SessionId("sess_bc0c004d-850c-45f8-8f54-43afbc1a2657"), event_type: "remote_sdp_answer", sdp: "v=0\r\no=rust 0 0 IN IP4 127.0.0.1\r\ns=Rust Session\r\nc=IN IP4 127.0.0.1\r\nt=0 0\r\nm=audio 10001 RTP/AVP 0 8\r\na=rtpmap:0 PCMU/8000\r\na=rtpmap:8 PCMA/8000\r\na=sendrecv\r\n" }
🎯 COORDINATOR: Handling event: MediaEvent { session_id: SessionId("sess_bc0c004d-850c-45f8-8f54-43afbc1a2657"), event: "rfc_compliant_media_creation_uas" }
[2m2025-06-17T22:53:11.433790Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m366:[0m Media creation event for sess_bc0c004d-850c-45f8-8f54-43afbc1a2657: rfc_compliant_media_creation_uas
🎯 COORDINATOR: Handling event: SessionTerminated { session_id: SessionId("sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997"), reason: "BYE received" }
🎯 COORDINATOR: Matched SessionTerminated event for sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997 - BYE received
🔴 COORDINATOR: handle_session_terminated called for session sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997 with reason: BYE received
[2m2025-06-17T22:53:11.434050Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m308:[0m Session sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997 terminated: BYE received
[2m2025-06-17T22:53:11.434123Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m92:[0m Media session terminated for SIP session: sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997
🔔 COORDINATOR: Handler exists, checking for session sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997
✅ COORDINATOR: Found session sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997, calling handler.on_call_ended
[2m2025-06-17T22:53:11.434264Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m340:[0m Notifying handler about session sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997 termination
[2m2025-06-17T22:53:11.434324Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m166:[0m 📴 [SIPp-Test-Server] Call sess_09f3d436-9e69-4192-bf5a-54ed5e8ea997 ended: BYE received
🎯 COORDINATOR: Handling event: SessionTerminated { session_id: SessionId("sess_7e8b8e81-7db9-4984-a110-0c36a616f14e"), reason: "BYE received" }
🎯 COORDINATOR: Matched SessionTerminated event for sess_7e8b8e81-7db9-4984-a110-0c36a616f14e - BYE received
🔴 COORDINATOR: handle_session_terminated called for session sess_7e8b8e81-7db9-4984-a110-0c36a616f14e with reason: BYE received
[2m2025-06-17T22:53:11.434471Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m308:[0m Session sess_7e8b8e81-7db9-4984-a110-0c36a616f14e terminated: BYE received
[2m2025-06-17T22:53:11.434520Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m92:[0m Media session terminated for SIP session: sess_7e8b8e81-7db9-4984-a110-0c36a616f14e
🔔 COORDINATOR: Handler exists, checking for session sess_7e8b8e81-7db9-4984-a110-0c36a616f14e
✅ COORDINATOR: Found session sess_7e8b8e81-7db9-4984-a110-0c36a616f14e, calling handler.on_call_ended
[2m2025-06-17T22:53:11.434647Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m340:[0m Notifying handler about session sess_7e8b8e81-7db9-4984-a110-0c36a616f14e termination
[2m2025-06-17T22:53:11.434732Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m166:[0m 📴 [SIPp-Test-Server] Call sess_7e8b8e81-7db9-4984-a110-0c36a616f14e ended: BYE received
🎯 COORDINATOR: Handling event: SessionTerminated { session_id: SessionId("sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c"), reason: "BYE received" }
🎯 COORDINATOR: Matched SessionTerminated event for sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c - BYE received
🔴 COORDINATOR: handle_session_terminated called for session sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c with reason: BYE received
[2m2025-06-17T22:53:11.434860Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m308:[0m Session sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c terminated: BYE received
[2m2025-06-17T22:53:11.434899Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m92:[0m Media session terminated for SIP session: sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c
🔔 COORDINATOR: Handler exists, checking for session sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c
✅ COORDINATOR: Found session sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c, calling handler.on_call_ended
[2m2025-06-17T22:53:11.435058Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m340:[0m Notifying handler about session sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c termination
[2m2025-06-17T22:53:11.435099Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m166:[0m 📴 [SIPp-Test-Server] Call sess_f99658b2-1cfa-45ef-81fc-65a5e6e6223c ended: BYE received
🎯 COORDINATOR: Handling event: SessionTerminated { session_id: SessionId("sess_236959a9-6556-4597-b29c-f9af4d56b505"), reason: "BYE received" }
🎯 COORDINATOR: Matched SessionTerminated event for sess_236959a9-6556-4597-b29c-f9af4d56b505 - BYE received
🔴 COORDINATOR: handle_session_terminated called for session sess_236959a9-6556-4597-b29c-f9af4d56b505 with reason: BYE received
[2m2025-06-17T22:53:11.435241Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m308:[0m Session sess_236959a9-6556-4597-b29c-f9af4d56b505 terminated: BYE received
[2m2025-06-17T22:53:11.435277Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m92:[0m Media session terminated for SIP session: sess_236959a9-6556-4597-b29c-f9af4d56b505
🔔 COORDINATOR: Handler exists, checking for session sess_236959a9-6556-4597-b29c-f9af4d56b505
✅ COORDINATOR: Found session sess_236959a9-6556-4597-b29c-f9af4d56b505, calling handler.on_call_ended
[2m2025-06-17T22:53:11.435387Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m340:[0m Notifying handler about session sess_236959a9-6556-4597-b29c-f9af4d56b505 termination
[2m2025-06-17T22:53:11.435552Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m166:[0m 📴 [SIPp-Test-Server] Call sess_236959a9-6556-4597-b29c-f9af4d56b505 ended: BYE received
🎯 COORDINATOR: Handling event: SessionTerminated { session_id: SessionId("sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1"), reason: "BYE received" }
🎯 COORDINATOR: Matched SessionTerminated event for sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1 - BYE received
🔴 COORDINATOR: handle_session_terminated called for session sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1 with reason: BYE received
[2m2025-06-17T22:53:11.435655Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m308:[0m Session sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1 terminated: BYE received
[2m2025-06-17T22:53:11.435747Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m92:[0m Media session terminated for SIP session: sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1
🔔 COORDINATOR: Handler exists, checking for session sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1
✅ COORDINATOR: Found session sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1, calling handler.on_call_ended
[2m2025-06-17T22:53:11.435833Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m340:[0m Notifying handler about session sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1 termination
[2m2025-06-17T22:53:11.435867Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m166:[0m 📴 [SIPp-Test-Server] Call sess_b4b7f44d-fbf5-4420-bd5f-a1aa57a728c1 ended: BYE received
🎯 COORDINATOR: Handling event: StateChanged { session_id: SessionId("sess_df07f161-5e7c-4868-bff1-43fe78257f34"), old_state: Ringing, new_state: Active }
[2m2025-06-17T22:53:11.435927Z[0m [32m INFO[0m ThreadId(16) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m248:[0m Session sess_df07f161-5e7c-4868-bff1-43fe78257f34 state changed: Ringing -> Active
[2m2025-06-17T22:53:11.435985Z[0m [32m INFO[0m ThreadId(16) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m263:[0m Starting media session for dialog: media-sess_df07f161-5e7c-4868-bff1-43fe78257f34
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-6-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag006\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-773ad194bbfd40ca9661a1ae261c7479\r\nCall-ID: 6-64430@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 36, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 36, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 37, 37, 33, 61, 64, 31, 39, 34, 62, 62, 66, 64, 34, 30, 63, 61, 39, 36, 36, 31, 61, 31, 61, 65, 32, 36, 31, 63, 37, 34, 37, 39, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 36, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 55, 55, 51, 97, 100, 49, 57, 52, 98, 98, 102, 100, 52, 48, 99, 97, 57, 54, 54, 49, 97, 49, 97, 101, 50, 54, 49, 99, 55, 52, 55, 57]
Successfully parsed tag: tag-773ad194bbfd40ca9661a1ae261c7479
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:11.887084Z[0m [32m INFO[0m ThreadId(13) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-6-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-64430-6-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-64430-6-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-6-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag006")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-773ad194bbfd40ca9661a1ae261c7479")] })), CallId(CallId("6-64430@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-64430-6-7:BYE:server)
[2m2025-06-17T22:53:11.887418Z[0m [32m INFO[0m ThreadId(13) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-64430-6-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
Valid state transition: Trying -> Completed
State successfully changed to: Completed
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(1b7866eb-4dbd-445c-a849-b945864ade51), reason: "BYE received" }
Sent StateChanged event result: Success
[2m2025-06-17T22:53:11.887700Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m639:[0m handle_call_terminated called for dialog 1b7866eb-4dbd-445c-a849-b945864ade51: BYE received
[2m2025-06-17T22:53:11.887625Z[0m [32m INFO[0m ThreadId(13) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog 1b7866eb-4dbd-445c-a849-b945864ade51
[2m2025-06-17T22:53:11.887735Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m642:[0m Call terminated for session sess_da2394aa-895b-4421-9950-42e222b144ba: 1b7866eb-4dbd-445c-a849-b945864ade51 - BYE received
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-7-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag007\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-bc30462a2d57448faf19a752753626e9\r\nCall-ID: 7-64430@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 37, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 37, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 62, 63, 33, 30, 34, 36, 32, 61, 32, 64, 35, 37, 34, 34, 38, 66, 61, 66, 31, 39, 61, 37, 35, 32, 37, 35, 33, 36, 32, 36, 65, 39, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 37, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 98, 99, 51, 48, 52, 54, 50, 97, 50, 100, 53, 55, 52, 52, 56, 102, 97, 102, 49, 57, 97, 55, 53, 50, 55, 53, 51, 54, 50, 54, 101, 57]
Successfully parsed tag: tag-bc30462a2d57448faf19a752753626e9
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:12.393824Z[0m [32m INFO[0m ThreadId(15) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-7-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-64430-7-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-64430-7-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-7-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag007")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-bc30462a2d57448faf19a752753626e9")] })), CallId(CallId("7-64430@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-64430-7-7:BYE:server)
[2m2025-06-17T22:53:12.394259Z[0m [32m INFO[0m ThreadId(15) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-64430-7-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
[2m2025-06-17T22:53:12.394585Z[0m [32m INFO[0m ThreadId(15) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog aebb7079-4a6c-48df-86cf-7edbd1c358b2
Valid state transition: Trying -> Completed
State successfully changed to: Completed
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(aebb7079-4a6c-48df-86cf-7edbd1c358b2), reason: "BYE received" }
Sent StateChanged event result: Success
[2m2025-06-17T22:53:12.394890Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m639:[0m handle_call_terminated called for dialog aebb7079-4a6c-48df-86cf-7edbd1c358b2: BYE received
[2m2025-06-17T22:53:12.394991Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m642:[0m Call terminated for session sess_af8f4983-ca09-47e0-941b-d6a5fb1a371e: aebb7079-4a6c-48df-86cf-7edbd1c358b2 - BYE received
[2m2025-06-17T22:53:12.439152Z[0m [32m INFO[0m ThreadId(13) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-17T22:53:12.439315Z[0m [32m INFO[0m ThreadId(13) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=2d07c090
[2m2025-06-17T22:53:12.439410Z[0m [32m INFO[0m ThreadId(13) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m339:[0m ✅ Created media session with REAL RTP session: media-sess_df07f161-5e7c-4868-bff1-43fe78257f34 (port: 22641)
[2m2025-06-17T22:53:12.439487Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m411:[0m ✅ Created media session: media-sess_df07f161-5e7c-4868-bff1-43fe78257f34 for SIP session: sess_df07f161-5e7c-4868-bff1-43fe78257f34 with real MediaSessionController + zero-copy enabled
[2m2025-06-17T22:53:12.439514Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m64:[0m Media session created and mapped for SIP session: sess_df07f161-5e7c-4868-bff1-43fe78257f34
[2m2025-06-17T22:53:12.439555Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m262:[0m Media info available: true
[2m2025-06-17T22:53:12.439572Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m264:[0m Local SDP length: None
[2m2025-06-17T22:53:12.439586Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m265:[0m Remote SDP length: None
[2m2025-06-17T22:53:12.439597Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m271:[0m Notifying handler about call sess_df07f161-5e7c-4868-bff1-43fe78257f34 establishment
[2m2025-06-17T22:53:12.439613Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/api/handlers.rs[0m[2m:[0m[2m231:[0m Call sess_df07f161-5e7c-4868-bff1-43fe78257f34 established
🎯 COORDINATOR: Handling event: StateChanged { session_id: SessionId("sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c"), old_state: Ringing, new_state: Active }
[2m2025-06-17T22:53:12.439663Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m248:[0m Session sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c state changed: Ringing -> Active
[2m2025-06-17T22:53:12.439692Z[0m [32m INFO[0m ThreadId(13) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m263:[0m Starting media session for dialog: media-sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-8-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag008\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-86a57b4b7d39414e9ec6d9919fa0ef6b\r\nCall-ID: 8-64430@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 38, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 38, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 38, 36, 61, 35, 37, 62, 34, 62, 37, 64, 33, 39, 34, 31, 34, 65, 39, 65, 63, 36, 64, 39, 39, 31, 39, 66, 61, 30, 65, 66, 36, 62, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 38, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 56, 54, 97, 53, 55, 98, 52, 98, 55, 100, 51, 57, 52, 49, 52, 101, 57, 101, 99, 54, 100, 57, 57, 49, 57, 102, 97, 48, 101, 102, 54, 98]
Successfully parsed tag: tag-86a57b4b7d39414e9ec6d9919fa0ef6b
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:12.885186Z[0m [32m INFO[0m ThreadId(11) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-8-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-64430-8-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-64430-8-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-8-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag008")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-86a57b4b7d39414e9ec6d9919fa0ef6b")] })), CallId(CallId("8-64430@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-64430-8-7:BYE:server)
[2m2025-06-17T22:53:12.885558Z[0m [32m INFO[0m ThreadId(11) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-64430-8-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
📨 EVENT LOOP: Received session coordination event in background task
[2m2025-06-17T22:53:12.885753Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog 446ab149-9219-4a2b-befa-064f3671eda0
Valid state transition: Trying -> Completed
State successfully changed to: Completed
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(446ab149-9219-4a2b-befa-064f3671eda0), reason: "BYE received" }
Sent StateChanged event result: Success
[2m2025-06-17T22:53:12.885832Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m639:[0m handle_call_terminated called for dialog 446ab149-9219-4a2b-befa-064f3671eda0: BYE received
[2m2025-06-17T22:53:12.885865Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m642:[0m Call terminated for session sess_df07f161-5e7c-4868-bff1-43fe78257f34: 446ab149-9219-4a2b-befa-064f3671eda0 - BYE received
=== PARSING SIP MESSAGE ===
Input length: 409 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-9-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag009\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-f99e8b285ff44b53b399657467c61cda\r\nCall-ID: 9-64430@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 39, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 39, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 66, 39, 39, 65, 38, 62, 32, 38, 35, 66, 66, 34, 34, 62, 35, 33, 62, 33, 39, 39, 36, 35, 37, 34, 36, 37, 63, 36, 31, 63, 64, 61, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 39, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 102, 57, 57, 101, 56, 98, 50, 56, 53, 102, 102, 52, 52, 98, 53, 51, 98, 51, 57, 57, 54, 53, 55, 52, 54, 55, 99, 54, 49, 99, 100, 97]
Successfully parsed tag: tag-f99e8b285ff44b53b399657467c61cda
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:13.384986Z[0m [32m INFO[0m ThreadId(11) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-9-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-64430-9-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-64430-9-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-9-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag009")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-f99e8b285ff44b53b399657467c61cda")] })), CallId(CallId("9-64430@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-64430-9-7:BYE:server)
[2m2025-06-17T22:53:13.385581Z[0m [32m INFO[0m ThreadId(11) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-64430-9-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
Valid state transition: Trying -> Completed
State successfully changed to: Completed
[2m2025-06-17T22:53:13.385863Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog 5edd632a-5a60-42ea-9e79-1138a32f9b29
📨 EVENT LOOP: Received session coordination event in background task
Sent StateChanged event result: Success
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(5edd632a-5a60-42ea-9e79-1138a32f9b29), reason: "BYE received" }
[2m2025-06-17T22:53:13.386008Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m639:[0m handle_call_terminated called for dialog 5edd632a-5a60-42ea-9e79-1138a32f9b29: BYE received
[2m2025-06-17T22:53:13.386052Z[0m [32m INFO[0m ThreadId(13) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m642:[0m Call terminated for session sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c: 5edd632a-5a60-42ea-9e79-1138a32f9b29 - BYE received
[2m2025-06-17T22:53:13.443123Z[0m [32m INFO[0m ThreadId(11) [2mcrates/rtp-core/src/transport/udp.rs[0m[2m:[0m[2m394:[0m Started UDP transport receiver tasks
[2m2025-06-17T22:53:13.443413Z[0m [32m INFO[0m ThreadId(11) [2mcrates/rtp-core/src/session/mod.rs[0m[2m:[0m[2m751:[0m Started RTP session with SSRC=33c78a01
[2m2025-06-17T22:53:13.443629Z[0m [32m INFO[0m ThreadId(11) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m339:[0m ✅ Created media session with REAL RTP session: media-sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c (port: 27559)
[2m2025-06-17T22:53:13.443852Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/media/manager.rs[0m[2m:[0m[2m411:[0m ✅ Created media session: media-sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c for SIP session: sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c with real MediaSessionController + zero-copy enabled
[2m2025-06-17T22:53:13.443936Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/media/coordinator.rs[0m[2m:[0m[2m64:[0m Media session created and mapped for SIP session: sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c
[2m2025-06-17T22:53:13.444027Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m262:[0m Media info available: true
[2m2025-06-17T22:53:13.444070Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m264:[0m Local SDP length: None
[2m2025-06-17T22:53:13.444106Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m265:[0m Remote SDP length: None
[2m2025-06-17T22:53:13.444139Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m271:[0m Notifying handler about call sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c establishment
[2m2025-06-17T22:53:13.444176Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/api/handlers.rs[0m[2m:[0m[2m231:[0m Call sess_1dafc1f6-e2ee-40aa-8555-2fe80654817c established
🎯 COORDINATOR: Handling event: StateChanged { session_id: SessionId("sess_bc0c004d-850c-45f8-8f54-43afbc1a2657"), old_state: Ringing, new_state: Active }
[2m2025-06-17T22:53:13.444266Z[0m [32m INFO[0m ThreadId(11) [2mcrates/session-core/src/coordinator/mod.rs[0m[2m:[0m[2m248:[0m Session sess_bc0c004d-850c-45f8-8f54-43afbc1a2657 state changed: Ringing -> Active
[2m2025-06-17T22:53:13.444326Z[0m [32m INFO[0m ThreadId(11) [2mcrates/media-core/src/relay/controller/mod.rs[0m[2m:[0m[2m263:[0m Starting media session for dialog: media-sess_bc0c004d-850c-45f8-8f54-43afbc1a2657
=== PARSING SIP MESSAGE ===
Input length: 412 bytes
Input as string: "BYE sip:test@127.0.0.1:5062 SIP/2.0\r\nVia: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-64430-10-7\r\nFrom: SIPp Test <sip:sipp@127.0.0.1:5061>;tag=64430SIPpTag0010\r\nTo: Test User <sip:test@127.0.0.1:5062>;tag=tag-f6081a22fe7f4ea0a8e45bade9759d7e\r\nCall-ID: 10-64430@127.0.0.1\r\nCSeq: 2 BYE\r\nContact: sip:sipp@127.0.0.1:5061\r\nMax-Forwards: 70\r\nSubject: SIPp Basic Call Test\r\nUser-Agent: SIPp/3.6.1\r\nContent-Length: 0\r\n\r\n"
Input as hex: [42, 59, 45, 20, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 20, 53, 49, 50, 2f, 32, 2e, 30, 0d, 0a, 56, 69, 61, 3a, 20, 53, 49, 50, 2f, 32, 2e, 30, 2f, 55, 44, 50, 20, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3b, 62, 72, 61, 6e, 63, 68, 3d, 7a, 39, 68, 47, 34, 62, 4b, 2d, 36, 34, 34, 33, 30, 2d, 31, 30, 2d, 37, 0d, 0a, 46, 72, 6f, 6d, 3a, 20, 53, 49, 50, 70, 20, 54, 65, 73, 74, 20, 3c, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 3e, 3b, 74, 61, 67, 3d, 36, 34, 34, 33, 30, 53, 49, 50, 70, 54, 61, 67, 30, 30, 31, 30, 0d, 0a, 54, 6f, 3a, 20, 54, 65, 73, 74, 20, 55, 73, 65, 72, 20, 3c, 73, 69, 70, 3a, 74, 65, 73, 74, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 32, 3e, 3b, 74, 61, 67, 3d, 74, 61, 67, 2d, 66, 36, 30, 38, 31, 61, 32, 32, 66, 65, 37, 66, 34, 65, 61, 30, 61, 38, 65, 34, 35, 62, 61, 64, 65, 39, 37, 35, 39, 64, 37, 65, 0d, 0a, 43, 61, 6c, 6c, 2d, 49, 44, 3a, 20, 31, 30, 2d, 36, 34, 34, 33, 30, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 0d, 0a, 43, 53, 65, 71, 3a, 20, 32, 20, 42, 59, 45, 0d, 0a, 43, 6f, 6e, 74, 61, 63, 74, 3a, 20, 73, 69, 70, 3a, 73, 69, 70, 70, 40, 31, 32, 37, 2e, 30, 2e, 30, 2e, 31, 3a, 35, 30, 36, 31, 0d, 0a, 4d, 61, 78, 2d, 46, 6f, 72, 77, 61, 72, 64, 73, 3a, 20, 37, 30, 0d, 0a, 53, 75, 62, 6a, 65, 63, 74, 3a, 20, 53, 49, 50, 70, 20, 42, 61, 73, 69, 63, 20, 43, 61, 6c, 6c, 20, 54, 65, 73, 74, 0d, 0a, 55, 73, 65, 72, 2d, 41, 67, 65, 6e, 74, 3a, 20, 53, 49, 50, 70, 2f, 33, 2e, 36, 2e, 31, 0d, 0a, 43, 6f, 6e, 74, 65, 6e, 74, 2d, 4c, 65, 6e, 67, 74, 68, 3a, 20, 30, 0d, 0a, 0d, 0a]
===========================
Attempting to parse tag from: [116, 97, 103, 61, 116, 97, 103, 45, 102, 54, 48, 56, 49, 97, 50, 50, 102, 101, 55, 102, 52, 101, 97, 48, 97, 56, 101, 52, 53, 98, 97, 100, 101, 57, 55, 53, 57, 100, 55, 101]
Successfully parsed tag: tag-f6081a22fe7f4ea0a8e45bade9759d7e
=== PARSE SUCCESS ===
Successfully parsed message
=====================
[2m2025-06-17T22:53:13.884148Z[0m [32m INFO[0m ThreadId(11) [2mcrates/transaction-core/src/manager/mod.rs[0m[2m:[0m[2m2038:[0m Created new ServerNonInviteTransaction [3mid[0m[2m=[0mKey(z9hG4bK-64430-10-7:BYE:server) [3mmethod[0m[2m=[0mBYE
Transaction loop starting for Key(z9hG4bK-64430-10-7:BYE:server)
Initial state: Trying
Received command: TransitionTo(Trying) for transaction Key(z9hG4bK-64430-10-7:BYE:server)
Processing TransitionTo(Trying) current state: Trying
Already in requested state, no transition needed: Trying
[2m2025-06-17T22:53:13.884616Z[0m [32m INFO[0m ThreadId(11) [2mcrates/sip-transport/src/transport/udp/mod.rs[0m[2m:[0m[2m162:[0m Sending response message to 127.0.0.1:5061
Received command: ProcessMessage(Request(Request { method: Bye, uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, version: Version { major: 2, minor: 0 }, headers: [Via(Via([ViaHeader { sent_protocol: SentProtocol { name: "SIP", version: "2.0", transport: "UDP" }, sent_by_host: Address(127.0.0.1), sent_by_port: Some(5061), params: [Branch("z9hG4bK-64430-10-7")] }])), From(From(Address { display_name: Some("SIPp Test"), uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [Tag("64430SIPpTag0010")] })), To(To(Address { display_name: Some("Test User"), uri: Uri { scheme: Sip, user: Some("test"), password: None, host: Address(127.0.0.1), port: Some(5062), parameters: [], headers: {}, raw_uri: None }, params: [Tag("tag-f6081a22fe7f4ea0a8e45bade9759d7e")] })), CallId(CallId("10-64430@127.0.0.1")), CSeq(CSeq { seq: 2, method: Bye }), Contact(Contact([Params([ContactParamInfo { address: Address { display_name: None, uri: Uri { scheme: Sip, user: Some("sipp"), password: None, host: Address(127.0.0.1), port: Some(5061), parameters: [], headers: {}, raw_uri: None }, params: [] } }])])), MaxForwards(MaxForwards(70)), Subject(Subject("SIPp Basic Call Test")), UserAgent(["SIPp/3.6.1"]), ContentLength(ContentLength(0))], body: b"" })) for transaction Key(z9hG4bK-64430-10-7:BYE:server)
Received command: TransitionTo(Completed) for transaction Key(z9hG4bK-64430-10-7:BYE:server)
Processing TransitionTo(Completed) current state: Trying
📨 EVENT LOOP: Received session coordination event in background task
🎪 SESSION COORDINATION: Received event: CallTerminated { dialog_id: DialogId(095523c4-7bdd-42ff-9c7d-f068f8f4bbe9), reason: "BYE received" }
[2m2025-06-17T22:53:13.884892Z[0m [32m INFO[0m ThreadId(11) [2mcrates/dialog-core/src/protocol/bye_handler.rs[0m[2m:[0m[2m106:[0m BYE processed for dialog 095523c4-7bdd-42ff-9c7d-f068f8f4bbe9
Valid state transition: Trying -> Completed
State successfully changed to: Completed
Sent StateChanged event result: Success
[2m2025-06-17T22:53:13.885024Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m639:[0m handle_call_terminated called for dialog 095523c4-7bdd-42ff-9c7d-f068f8f4bbe9: BYE received
[2m2025-06-17T22:53:13.885269Z[0m [32m INFO[0m ThreadId(15) [2mcrates/session-core/src/dialog/coordinator.rs[0m[2m:[0m[2m642:[0m Call terminated for session sess_bc0c004d-850c-45f8-8f54-43afbc1a2657: 095523c4-7bdd-42ff-9c7d-f068f8f4bbe9 - BYE received
[2m2025-06-17T22:53:13.953153Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m250:[0m 📡 Received SIGTERM signal
[2m2025-06-17T22:53:13.953191Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m229:[0m 🛑 SIP Test Server shutting down
[2m2025-06-17T22:53:13.953204Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m269:[0m 📊 Final Statistics:
[2m2025-06-17T22:53:13.953212Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m270:[0m   ⏱️  Uptime: 13.77 seconds
[2m2025-06-17T22:53:13.953221Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m271:[0m   📞 Total calls: 10
[2m2025-06-17T22:53:13.953226Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m272:[0m   ✅ Successful calls: 5
[2m2025-06-17T22:53:13.953232Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m273:[0m   ❌ Failed calls: 0
[2m2025-06-17T22:53:13.953237Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m274:[0m   🔄 Active calls: 5
[2m2025-06-17T22:53:13.953243Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m275:[0m   📈 Success rate: 50.0%
[2m2025-06-17T22:53:13.953250Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m279:[0m   🚀 Average call rate: 0.73 calls/second
[2m2025-06-17T22:53:13.953256Z[0m [32m INFO[0m ThreadId(01) [2mcrates/session-core/examples/sipp_tests/src/bin/sip_test_server.rs[0m[2m:[0m[2m317:[0m 👋 SIP Test Server shutdown complete
